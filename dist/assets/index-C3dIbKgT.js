(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();let z=[],q=null,ze=null,Kt=0,Qt=!1,Kn=()=>{},Qn=()=>{},Jt=null,en=null,tn=()=>{};function no(e){Kn=e}function ro(e){Qn=e}function oo(e){tn=e}function so(){return Jt}function ao(){return en}function co(e,n){const t=r=>r!=null&&String(r)!=="NaN"&&String(r).trim()!==""?String(r).trim():null;Jt=t(e),n!==void 0&&(en=t(n)),tn()}function Ve(){Kn([...z],q)}function se(){return[...z]}function ae(){return q}function io(){return ze}function Jn(){return Kt}function nn(){return Qt}function Ge(e){Qt=e,Ve()}function rn(e){Kt=Math.max(0,e),Qn()}function lo(e){const n=Array.from(e).filter(t=>t.type.startsWith("audio/"));for(const t of n)z.push({id:crypto.randomUUID(),file:t,name:t.name,loop:!1,maxLoopSeconds:null,duration:null,bpm:null,key:null});Ve()}function $e(e){q=e>=0&&e<z.length?e:null,ze=q!==null?Date.now():null,Kt=0,Qt=q===null,q===null&&(Jt=null,en=null,tn()),Ve()}function uo(e){ze=e}function er(){if(q===null||q>=z.length)return{action:"stop"};const e=z[q],n=ze!==null?(Date.now()-ze)/1e3:0;if(e.loop&&e.maxLoopSeconds!=null&&e.maxLoopSeconds>0){if(n>=e.maxLoopSeconds){const r=q+1;return r<z.length?{action:"next",index:r}:{action:"stop"}}return{action:"loop"}}if(e.loop&&(e.maxLoopSeconds==null||e.maxLoopSeconds<=0))return{action:"loop"};const t=q+1;return t<z.length?{action:"next",index:t}:{action:"stop"}}function ho(e,n){if(e<0||e>=z.length||n<0||n>=z.length)return;const[t]=z.splice(e,1);z.splice(n,0,t),q===e?q=n:q!==null&&(e<q&&n>=q?q--:e>q&&n<=q&&q++),Ve()}function Le(e,n){const t=z.findIndex(r=>r.id===e);t!==-1&&(n.loop!==void 0&&(z[t].loop=n.loop),n.maxLoopSeconds!==void 0&&(z[t].maxLoopSeconds=n.maxLoopSeconds),n.duration!==void 0&&(z[t].duration=n.duration),n.bpm!==void 0&&(z[t].bpm=n.bpm),n.key!==void 0&&(z[t].key=n.key),Ve())}function tr(e){if(!e.length)return;const n=[...z],t=new Set,r=[];for(const s of e){const l=n.findIndex(a=>a.name===s.name&&!t.has(a.id));if(l>=0){const a={...n[l],loop:s.loop,maxLoopSeconds:s.maxLoopSeconds};t.add(n[l].id),r.push(a)}}for(const s of n)t.has(s.id)||r.push(s);const o=q!==null&&q<n.length?n[q].id:null;z=r,q=o!==null?z.findIndex(s=>s.id===o):null,q===-1&&(q=null),Ve()}function ue(e){if(e==null||Number.isNaN(e)||e<0)return"0:00";const n=Math.floor(e/60),t=Math.floor(e%60);return`${n}:${String(t).padStart(2,"0")}`}function nr(e){const n=e.trim();if(!n)return null;const t=n.split(":");if(t.length!==2)return null;const r=parseInt(t[0],10),o=parseInt(t[1],10);return Number.isNaN(r)||Number.isNaN(o)||r<0||o<0||o>=60?null:r*60+o}function ke(e){return e.maxLoopSeconds!=null&&e.maxLoopSeconds>0?e.maxLoopSeconds:e.duration??0}function on(e){const n=[];let t=0;for(let r=0;r<e.length;r++)n.push(t),t+=ke(e[r]);return n}function fo(e){const n=e.trim();if(!n)return null;const t=n.split("	");if(t.length>=3){const r=t.slice(0,-2).join("	").trim(),o=t[t.length-2]==="1",s=t[t.length-1].trim(),l=s?nr(s):null;return{name:r,loop:o,maxLoopSeconds:l}}return t.length===2?{name:t[0].trim(),loop:t[1]==="1",maxLoopSeconds:null}:t.length===1?{name:t[0].trim(),loop:!1,maxLoopSeconds:null}:null}function po(e){return e.map(n=>`${n.name}	${n.loop?1:0}	${n.maxLoopSeconds!=null?ue(n.maxLoopSeconds):""}`).join(`
`)}function rr(e){const n=e.split(/\r?\n/),t=[];for(const r of n){const o=fo(r);o&&o.name&&t.push(o)}return t}function mo(e){const n=[],t=[];for(const r of e)r.type.startsWith("audio/")?n.push(r):(r.name.toLowerCase().endsWith(".txt")||r.type==="text/plain")&&t.push(r);return{audioFiles:n,txtFiles:t}}function go(e,n){const t=new FileReader;t.onload=()=>{const r=typeof t.result=="string"?t.result:"",o=rr(r);o.length&&tr(o)},t.onerror=n,t.readAsText(e,"UTF-8")}function Tn(e){const{audioFiles:n,txtFiles:t}=mo(Array.from(e));n.length&&lo(n);const r=t[0];r&&go(r,()=>{})}function yo(e){const n=document.createElement("span");n.textContent="オーディオファイル・リストtxtをドラッグ＆ドロップ または クリックして選択",n.className="dropzone-label",e.appendChild(n);const t=document.createElement("input");t.type="file",t.accept="audio/*,.txt,text/plain",t.multiple=!0,t.style.display="none",e.appendChild(t),e.addEventListener("click",()=>t.click()),e.addEventListener("dragover",r=>{r.preventDefault(),r.stopPropagation(),e.classList.add("dragover")}),e.addEventListener("dragleave",r=>{r.preventDefault(),r.stopPropagation(),e.classList.remove("dragover")}),e.addEventListener("drop",r=>{var s;r.preventDefault(),r.stopPropagation(),e.classList.remove("dragover");const o=(s=r.dataTransfer)==null?void 0:s.files;o!=null&&o.length&&Tn(Array.from(o))}),t.addEventListener("change",()=>{const r=t.files;r!=null&&r.length&&Tn(Array.from(r)),t.value=""})}const vo=e=>(n,t)=>(e.set(n,t),t),In=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,or=536870912,En=or*2,No=(e,n)=>t=>{const r=n.get(t);let o=r===void 0?t.size:r<En?r+1:0;if(!t.has(o))return e(t,o);if(t.size<or){for(;t.has(o);)o=Math.floor(Math.random()*En);return e(t,o)}if(t.size>In)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(o);)o=Math.floor(Math.random()*In);return e(t,o)},sr=new WeakMap,wo=vo(sr),Co=No(wo,sr),_o=(e,n,t,r)=>o=>{const s=n(o);return l=>{const a=e(l);l.addEventListener("message",({data:d})=>{const{id:h}=d;if(h!==null&&a.has(h)){const{reject:p,resolve:f}=a.get(h);a.delete(h),d.error===void 0?f(d.result):p(new Error(d.error.message))}}),r(l)&&l.start();const i=(d,h=null,p=[])=>new Promise((f,m)=>{const v=t(a);a.set(v,{reject:m,resolve:f}),h===null?l.postMessage({id:v,method:d},p):l.postMessage({id:v,method:d,params:h},p)}),c=(d,h,p=[])=>{l.postMessage({id:null,method:d,params:h},p)};let u={};for(const[d,h]of Object.entries(s))u={...u,[d]:h({call:i,notify:c})};return{...u}}},bo=e=>n=>{if(e.has(n))return e.get(n);const t=new Map;return e.set(n,t),t},To=e=>n=>({...n,connect:({call:t})=>async()=>{const{port1:r,port2:o}=new MessageChannel,s=await t("connect",{port:r},[r]);return e.set(o,s),o},disconnect:({call:t})=>async r=>{const o=e.get(r);if(o===void 0)throw new Error("The given port is not connected.");await t("disconnect",{portId:o})},isSupported:({call:t})=>()=>t("isSupported")}),Io=e=>typeof e.start=="function",Eo=_o(bo(new WeakMap),To(new WeakMap),Co,Io),Sn=(e,n,t)=>({endTime:n,insertTime:t,type:"exponentialRampToValue",value:e}),Mn=(e,n,t)=>({endTime:n,insertTime:t,type:"linearRampToValue",value:e}),Vt=(e,n)=>({startTime:n,type:"setValue",value:e}),ar=(e,n,t)=>({duration:t,startTime:n,type:"setValueCurve",values:e}),cr=(e,n,{startTime:t,target:r,timeConstant:o})=>r+(n-r)*Math.exp((t-e)/o),De=e=>e.type==="exponentialRampToValue",ft=e=>e.type==="linearRampToValue",Ne=e=>De(e)||ft(e),sn=e=>e.type==="setValue",pe=e=>e.type==="setValueCurve",pt=(e,n,t,r)=>{const o=e[n];return o===void 0?r:Ne(o)||sn(o)?o.value:pe(o)?o.values[o.values.length-1]:cr(t,pt(e,n-1,o.startTime,r),o)},Rn=(e,n,t,r,o)=>t===void 0?[r.insertTime,o]:Ne(t)?[t.endTime,t.value]:sn(t)?[t.startTime,t.value]:pe(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,pt(e,n-1,t.startTime,o)],qt=e=>e.type==="cancelAndHold",Ut=e=>e.type==="cancelScheduledValues",ve=e=>qt(e)||Ut(e)?e.cancelTime:De(e)||ft(e)?e.endTime:e.startTime,An=(e,n,t,{endTime:r,value:o})=>t===o?o:0<t&&0<o||t<0&&o<0?t*(o/t)**((e-n)/(r-n)):0,On=(e,n,t,{endTime:r,value:o})=>t+(e-n)/(r-n)*(o-t),So=(e,n)=>{const t=Math.floor(n),r=Math.ceil(n);return t===r?e[t]:(1-(n-t))*e[t]+(1-(r-n))*e[r]},Mo=(e,{duration:n,startTime:t,values:r})=>{const o=(e-t)/n*(r.length-1);return So(r,o)},ct=e=>e.type==="setTarget";class Ro{constructor(n){this._automationEvents=[],this._currenTime=0,this._defaultValue=n}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(n){const t=ve(n);if(qt(n)||Ut(n)){const r=this._automationEvents.findIndex(s=>Ut(n)&&pe(s)?s.startTime+s.duration>=t:ve(s)>=t),o=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),qt(n)){const s=this._automationEvents[this._automationEvents.length-1];if(o!==void 0&&Ne(o)){if(s!==void 0&&ct(s))throw new Error("The internal list is malformed.");const l=s===void 0?o.insertTime:pe(s)?s.startTime+s.duration:ve(s),a=s===void 0?this._defaultValue:pe(s)?s.values[s.values.length-1]:s.value,i=De(o)?An(t,l,a,o):On(t,l,a,o),c=De(o)?Sn(i,t,this._currenTime):Mn(i,t,this._currenTime);this._automationEvents.push(c)}if(s!==void 0&&ct(s)&&this._automationEvents.push(Vt(this.getValue(t),t)),s!==void 0&&pe(s)&&s.startTime+s.duration>t){const l=t-s.startTime,a=(s.values.length-1)/s.duration,i=Math.max(2,1+Math.ceil(l*a)),c=l/(i-1)*a,u=s.values.slice(0,i);if(c<1)for(let d=1;d<i;d+=1){const h=c*d%1;u[d]=s.values[d-1]*(1-h)+s.values[d]*h}this._automationEvents[this._automationEvents.length-1]=ar(u,s.startTime,l)}}}else{const r=this._automationEvents.findIndex(l=>ve(l)>t),o=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(o!==void 0&&pe(o)&&ve(o)+o.duration>t)return!1;const s=De(n)?Sn(n.value,n.endTime,this._currenTime):ft(n)?Mn(n.value,t,this._currenTime):n;if(r===-1)this._automationEvents.push(s);else{if(pe(n)&&t+n.duration>ve(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(n){const t=this._automationEvents.findIndex(r=>ve(r)>n);if(t>1){const r=this._automationEvents.slice(t-1),o=r[0];ct(o)&&r.unshift(Vt(pt(this._automationEvents,t-2,o.startTime,this._defaultValue),o.startTime)),this._automationEvents=r}}getValue(n){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(l=>ve(l)>n),r=this._automationEvents[t],o=(t===-1?this._automationEvents.length:t)-1,s=this._automationEvents[o];if(s!==void 0&&ct(s)&&(r===void 0||!Ne(r)||r.insertTime>n))return cr(n,pt(this._automationEvents,o-1,s.startTime,this._defaultValue),s);if(s!==void 0&&sn(s)&&(r===void 0||!Ne(r)))return s.value;if(s!==void 0&&pe(s)&&(r===void 0||!Ne(r)||s.startTime+s.duration>n))return n<s.startTime+s.duration?Mo(n,s):s.values[s.values.length-1];if(s!==void 0&&Ne(s)&&(r===void 0||!Ne(r)))return s.value;if(r!==void 0&&De(r)){const[l,a]=Rn(this._automationEvents,o,s,r,this._defaultValue);return An(n,l,a,r)}if(r!==void 0&&ft(r)){const[l,a]=Rn(this._automationEvents,o,s,r,this._defaultValue);return On(n,l,a,r)}return this._defaultValue}}const Ao=e=>({cancelTime:e,type:"cancelAndHold"}),Oo=e=>({cancelTime:e,type:"cancelScheduledValues"}),Fo=(e,n)=>({endTime:n,type:"exponentialRampToValue",value:e}),Do=(e,n)=>({endTime:n,type:"linearRampToValue",value:e}),ko=(e,n,t)=>({startTime:n,target:e,timeConstant:t,type:"setTarget"}),Po=()=>new DOMException("","AbortError"),Lo=e=>(n,t,[r,o,s],l)=>{e(n[o],[t,r,s],a=>a[0]===t&&a[1]===r,l)},Bo=e=>(n,t,r)=>{const o=[];for(let s=0;s<r.numberOfInputs;s+=1)o.push(new Set);e.set(n,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Wo=e=>(n,t)=>{e.set(n,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Be=new WeakSet,ir=new WeakMap,lr=new WeakMap,ur=new WeakMap,dr=new WeakMap,hr=new WeakMap,fr=new WeakMap,xt=new WeakMap,Fn=new WeakMap,pr={construct(){return pr}},Vo=e=>{try{const n=new Proxy(e,pr);new n}catch{return!1}return!0},Dn=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,kn=(e,n)=>{const t=[];let r=e.replace(/^[\s]+/,""),o=r.match(Dn);for(;o!==null;){const s=o[1].slice(1,-1),l=o[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,n).toString());t.push(l),r=r.slice(o[0].length).replace(/^[\s]+/,""),o=r.match(Dn)}return[t.join(";"),r]},Pn=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Ln=e=>{if(!Vo(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},qo=(e,n,t,r,o,s,l,a,i,c,u,d,h)=>{let p=0;return(f,m,v={credentials:"omit"})=>{const N=u.get(f);if(N!==void 0&&N.has(m))return Promise.resolve();const E=c.get(f);if(E!==void 0){const g=E.get(m);if(g!==void 0)return g}const T=s(f),S=T.audioWorklet===void 0?o(m).then(([g,C])=>{const[_,y]=kn(g,C),M=`${_};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${y}
})})(window,'_AWGS')`;return t(M)}).then(()=>{const g=h._AWGS.pop();if(g===void 0)throw new SyntaxError;r(T.currentTime,T.sampleRate,()=>g(class{},void 0,(C,_)=>{if(C.trim()==="")throw n();const y=Fn.get(T);if(y!==void 0){if(y.has(C))throw n();Ln(_),Pn(_.parameterDescriptors),y.set(C,_)}else Ln(_),Pn(_.parameterDescriptors),Fn.set(T,new Map([[C,_]]))},T.sampleRate,void 0,void 0))}):Promise.all([o(m),Promise.resolve(e(d,d))]).then(([[g,C],_])=>{const y=p+1;p=y;const[M,w]=kn(g,C),R=`${M};((AudioWorkletProcessor,registerProcessor)=>{${w}
})(${_?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${_?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${_?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${y}',class extends AudioWorkletProcessor{process(){return !1}})`,k=new Blob([R],{type:"application/javascript; charset=utf-8"}),O=URL.createObjectURL(k);return T.audioWorklet.addModule(O,v).then(()=>{if(a(T))return T;const D=l(T);return D.audioWorklet.addModule(O,v).then(()=>D)}).then(D=>{if(i===null)throw new SyntaxError;try{new i(D,`__sac${y}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(O))});return E===void 0?c.set(f,new Map([[m,S]])):E.set(m,S),S.then(()=>{const g=u.get(f);g===void 0?u.set(f,new Set([m])):g.add(m)}).finally(()=>{const g=c.get(f);g!==void 0&&g.delete(m)}),S}},Ce=(e,n)=>{const t=e.get(n);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},_t=(e,n)=>{const t=Array.from(e).filter(n);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return e.delete(r),r},mr=(e,n,t,r)=>{const o=Ce(e,n),s=_t(o,l=>l[0]===t&&l[1]===r);return o.size===0&&e.delete(n),s},Qe=e=>Ce(fr,e),We=e=>{if(Be.has(e))throw new Error("The AudioNode is already stored.");Be.add(e),Qe(e).forEach(n=>n(!0))},gr=e=>"port"in e,Je=e=>{if(!Be.has(e))throw new Error("The AudioNode is not stored.");Be.delete(e),Qe(e).forEach(n=>n(!1))},jt=(e,n)=>{!gr(e)&&n.every(t=>t.size===0)&&Je(e)},Uo=(e,n,t,r,o,s,l,a,i,c,u,d,h)=>{const p=new WeakMap;return(f,m,v,N,E)=>{const{activeInputs:T,passiveInputs:S}=s(m),{outputs:g}=s(f),C=a(f),_=y=>{const M=i(m),w=i(f);if(y){const I=mr(S,f,v,N);e(T,f,I,!1),!E&&!d(f)&&t(w,M,v,N),h(m)&&We(m)}else{const I=r(T,f,v,N);n(S,N,I,!1),!E&&!d(f)&&o(w,M,v,N);const b=l(m);if(b===0)u(m)&&jt(m,T);else{const A=p.get(m);A!==void 0&&clearTimeout(A),p.set(m,setTimeout(()=>{u(m)&&jt(m,T)},b*1e3))}}};return c(g,[m,v,N],y=>y[0]===m&&y[1]===v&&y[2]===N,!0)?(C.add(_),u(f)?e(T,f,[v,N,_],!0):n(S,N,[f,v,_],!0),!0):!1}},xo=e=>(n,t,[r,o,s],l)=>{const a=n.get(r);a===void 0?n.set(r,new Set([[o,t,s]])):e(a,[o,t,s],i=>i[0]===o&&i[1]===t,l)},jo=e=>(n,t)=>{const r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(n.destination);const o=()=>{t.removeEventListener("ended",o),t.disconnect(r),r.disconnect()};t.addEventListener("ended",o)},Xo={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Zo=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=o(a),u={...Xo,...i},d=r(c,u),h=s(c)?n():null;super(a,!1,d,h),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const i=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=i,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const i=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=i,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Q=(e,n)=>e.context===n,zo=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=e(l,c)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},mt=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Se=()=>new DOMException("","IndexSizeError"),an=e=>{e.getChannelData=(n=>t=>{try{return n.call(e,t)}catch(r){throw r.code===12?Se():r}})(e.getChannelData)},Go={numberOfChannels:1},$o=(e,n,t,r,o,s,l,a)=>{let i=null;return class yr{constructor(u){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:h,sampleRate:p}={...Go,...u};i===null&&(i=new o(1,1,44100));const f=r!==null&&n(s,s)?new r({length:d,numberOfChannels:h,sampleRate:p}):i.createBuffer(h,d,p);if(f.numberOfChannels===0)throw t();return typeof f.copyFromChannel!="function"?(l(f),an(f)):n(mt,()=>mt(f))||a(f),e.add(f),f}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===yr.prototype||e.has(u)}}},ne=-34028234663852886e22,J=-ne,me=e=>Be.has(e),Yo={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Ho=(e,n,t,r,o,s,l,a)=>class extends e{constructor(c,u){const d=s(c),h={...Yo,...u},p=o(d,h),f=l(d),m=f?n():null;super(c,!1,p,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=t(this,f,p.playbackRate,J,ne)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?c:d}get playbackRate(){return this._playbackRate}start(c=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(c,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[c,u]:[c,u,d]),this.context.state!=="closed"){We(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),me(this)&&Je(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},Ko=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null;const i=async(c,u)=>{let d=t(c);const h=Q(d,u);if(!h){const p={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=n(u,p),l!==null&&d.start(...l),a!==null&&d.stop(a)}return s.set(u,d),h?await e(u,c.playbackRate,d.playbackRate):await r(u,c.playbackRate,d.playbackRate),await o(c,u,d),d};return{set start(c){l=c},set stop(c){a=c},render(c,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):i(c,u)}}},Qo=e=>"playbackRate"in e,Jo=e=>"frequency"in e&&"gain"in e,es=e=>"offset"in e,ts=e=>!("frequency"in e)&&"gain"in e,ns=e=>"detune"in e&&"frequency"in e&&!("gain"in e),rs=e=>"pan"in e,re=e=>Ce(ir,e),et=e=>Ce(ur,e),Xt=(e,n)=>{const{activeInputs:t}=re(e);t.forEach(o=>o.forEach(([s])=>{n.includes(e)||Xt(s,[...n,e])}));const r=Qo(e)?[e.playbackRate]:gr(e)?Array.from(e.parameters.values()):Jo(e)?[e.Q,e.detune,e.frequency,e.gain]:es(e)?[e.offset]:ts(e)?[e.gain]:ns(e)?[e.detune,e.frequency]:rs(e)?[e.pan]:[];for(const o of r){const s=et(o);s!==void 0&&s.activeInputs.forEach(([l])=>Xt(l,n))}me(e)&&Je(e)},os=e=>{Xt(e.destination,[])},ss=(e,n,t,r,o,s,l,a)=>class extends e{constructor(c,u){const d=s(c),h=l(d),p=o(d,u,h),f=h?n(a):null;super(c,!1,p,f),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},as=e=>{const n=new WeakMap,t=async(r,o)=>{const s=o.destination;return n.set(o,s),await e(r,o,s),s};return{render(r,o){const s=n.get(o);return s!==void 0?Promise.resolve(s):t(r,o)}}},cs=(e,n,t,r,o,s,l,a)=>(i,c)=>{const u=c.listener,d=()=>{const g=new Float32Array(1),C=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),_=l(c);let y=!1,M=[0,0,-1,0,1,0],w=[0,0,0];const I=()=>{if(y)return;y=!0;const k=r(c,256,9,0);k.onaudioprocess=({inputBuffer:O})=>{const D=[s(O,g,0),s(O,g,1),s(O,g,2),s(O,g,3),s(O,g,4),s(O,g,5)];D.some((P,L)=>P!==M[L])&&(u.setOrientation(...D),M=D);const V=[s(O,g,6),s(O,g,7),s(O,g,8)];V.some((P,L)=>P!==w[L])&&(u.setPosition(...V),w=V)},C.connect(k)},b=k=>O=>{O!==M[k]&&(M[k]=O,u.setOrientation(...M))},A=k=>O=>{O!==w[k]&&(w[k]=O,u.setPosition(...w))},R=(k,O,D)=>{const V=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:O});V.connect(C,0,k),V.start(),Object.defineProperty(V.offset,"defaultValue",{get(){return O}});const P=e({context:i},_,V.offset,J,ne);return a(P,"value",L=>()=>L.call(P),L=>B=>{try{L.call(P,B)}catch(x){if(x.code!==9)throw x}I(),_&&D(B)}),P.cancelAndHoldAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.cancelAndHoldAtTime),P.cancelScheduledValues=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.cancelScheduledValues),P.exponentialRampToValueAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.exponentialRampToValueAtTime),P.linearRampToValueAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.linearRampToValueAtTime),P.setTargetAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.setTargetAtTime),P.setValueAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.setValueAtTime),P.setValueCurveAtTime=(L=>_?()=>{throw o()}:(...B)=>{const x=L.apply(P,B);return I(),x})(P.setValueCurveAtTime),P};return{forwardX:R(0,0,b(0)),forwardY:R(1,0,b(1)),forwardZ:R(2,-1,b(2)),positionX:R(6,0,A(0)),positionY:R(7,0,A(1)),positionZ:R(8,0,A(2)),upX:R(3,0,b(3)),upY:R(4,1,b(4)),upZ:R(5,0,b(5))}},{forwardX:h,forwardY:p,forwardZ:f,positionX:m,positionY:v,positionZ:N,upX:E,upY:T,upZ:S}=u.forwardX===void 0?d():u;return{get forwardX(){return h},get forwardY(){return p},get forwardZ(){return f},get positionX(){return m},get positionY(){return v},get positionZ(){return N},get upX(){return E},get upY(){return T},get upZ(){return S}}},gt=e=>"context"in e,tt=e=>gt(e[0]),Me=(e,n,t,r)=>{for(const o of e)if(t(o)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(n),!0},Bn=(e,n,[t,r],o)=>{Me(e,[n,t,r],s=>s[0]===n&&s[1]===t,o)},Wn=(e,[n,t,r],o)=>{const s=e.get(n);s===void 0?e.set(n,new Set([[t,r]])):Me(s,[t,r],l=>l[0]===t,o)},qe=e=>"inputs"in e,yt=(e,n,t,r)=>{if(qe(n)){const o=n.inputs[r];return e.connect(o,t,0),[o,t,0]}return e.connect(n,t,r),[n,t,r]},vr=(e,n,t)=>{for(const r of e)if(r[0]===n&&r[1]===t)return e.delete(r),r;return null},is=(e,n,t)=>_t(e,r=>r[0]===n&&r[1]===t),Nr=(e,n)=>{if(!Qe(e).delete(n))throw new Error("Missing the expected event listener.")},wr=(e,n,t)=>{const r=Ce(e,n),o=_t(r,s=>s[0]===t);return r.size===0&&e.delete(n),o},vt=(e,n,t,r)=>{qe(n)?e.disconnect(n.inputs[r],t,0):e.disconnect(n,t,r)},j=e=>Ce(lr,e),Ye=e=>Ce(dr,e),Ee=e=>xt.has(e),dt=e=>!Be.has(e),Vn=(e,n)=>new Promise(t=>{if(n!==null)t(!0);else{const r=e.createScriptProcessor(256,1,1),o=e.createGain(),s=e.createBuffer(1,2,44100),l=s.getChannelData(0);l[0]=1,l[1]=1;const a=e.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(e.destination),a.connect(o),a.disconnect(o),r.onaudioprocess=i=>{const c=i.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?t(!0):t(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(e.destination)},a.start()}}),Dt=(e,n)=>{const t=new Map;for(const r of e)for(const o of r){const s=t.get(o);t.set(o,s===void 0?1:s+1)}t.forEach((r,o)=>n(o,r))},qn=e=>"context"in e,ls=e=>{const n=new Map;e.connect=(t=>(r,o=0,s=0)=>{const l=qn(r)?t(r,o,s):t(r,o),a=n.get(r);return a===void 0?n.set(r,[{input:s,output:o}]):a.every(i=>i.input!==s||i.output!==o)&&a.push({input:s,output:o}),l})(e.connect.bind(e)),e.disconnect=(t=>(r,o,s)=>{if(t.apply(e),r===void 0)n.clear();else if(typeof r=="number")for(const[l,a]of n){const i=a.filter(c=>c.output!==r);i.length===0?n.delete(l):n.set(l,i)}else if(n.has(r))if(o===void 0)n.delete(r);else{const l=n.get(r);if(l!==void 0){const a=l.filter(i=>i.output!==o&&(i.input!==s||s===void 0));a.length===0?n.delete(r):n.set(r,a)}}for(const[l,a]of n)a.forEach(i=>{qn(l)?e.connect(l,i.output,i.input):e.connect(l,i.output)})})(e.disconnect)},us=(e,n,t,r)=>{const{activeInputs:o,passiveInputs:s}=et(n),{outputs:l}=re(e),a=Qe(e),i=c=>{const u=j(e),d=Ye(n);if(c){const h=wr(s,e,t);Bn(o,e,h,!1),!r&&!Ee(e)&&u.connect(d,t)}else{const h=is(o,e,t);Wn(s,h,!1),!r&&!Ee(e)&&u.disconnect(d,t)}};return Me(l,[n,t],c=>c[0]===n&&c[1]===t,!0)?(a.add(i),me(e)?Bn(o,e,[t,i],!0):Wn(s,[e,t,i],!0),!0):!1},ds=(e,n,t,r)=>{const{activeInputs:o,passiveInputs:s}=re(n),l=vr(o[r],e,t);return l===null?[mr(s,e,t,r)[2],!1]:[l[2],!0]},hs=(e,n,t)=>{const{activeInputs:r,passiveInputs:o}=et(n),s=vr(r,e,t);return s===null?[wr(o,e,t)[1],!1]:[s[2],!0]},cn=(e,n,t,r,o)=>{const[s,l]=ds(e,t,r,o);if(s!==null&&(Nr(e,s),l&&!n&&!Ee(e)&&vt(j(e),j(t),r,o)),me(t)){const{activeInputs:a}=re(t);jt(t,a)}},ln=(e,n,t,r)=>{const[o,s]=hs(e,t,r);o!==null&&(Nr(e,o),s&&!n&&!Ee(e)&&j(e).disconnect(Ye(t),r))},fs=(e,n)=>{const t=re(e),r=[];for(const o of t.outputs)tt(o)?cn(e,n,...o):ln(e,n,...o),r.push(o[0]);return t.outputs.clear(),r},ps=(e,n,t)=>{const r=re(e),o=[];for(const s of r.outputs)s[1]===t&&(tt(s)?cn(e,n,...s):ln(e,n,...s),o.push(s[0]),r.outputs.delete(s));return o},ms=(e,n,t,r,o)=>{const s=re(e);return Array.from(s.outputs).filter(l=>l[0]===t&&(r===void 0||l[1]===r)&&(o===void 0||l[2]===o)).map(l=>(tt(l)?cn(e,n,...l):ln(e,n,...l),s.outputs.delete(l),l[0]))},gs=(e,n,t,r,o,s,l,a,i,c,u,d,h,p,f,m)=>class extends c{constructor(N,E,T,S){super(T),this._context=N,this._nativeAudioNode=T;const g=u(N);d(g)&&t(Vn,()=>Vn(g,m))!==!0&&ls(T),lr.set(this,T),fr.set(this,new Set),N.state!=="closed"&&E&&We(this),e(this,S,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(N){this._nativeAudioNode.channelCount=N}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(N){this._nativeAudioNode.channelCountMode=N}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(N){this._nativeAudioNode.channelInterpretation=N}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(N,E=0,T=0){if(E<0||E>=this._nativeAudioNode.numberOfOutputs)throw o();const S=u(this._context),g=f(S);if(h(N)||p(N))throw s();if(gt(N)){const y=j(N);try{const w=yt(this._nativeAudioNode,y,E,T),I=dt(this);(g||I)&&this._nativeAudioNode.disconnect(...w),this.context.state!=="closed"&&!I&&dt(N)&&We(N)}catch(w){throw w.code===12?s():w}if(n(this,N,E,T,g)){const w=i([this],N);Dt(w,r(g))}return N}const C=Ye(N);if(C.name==="playbackRate"&&C.maxValue===1024)throw l();try{this._nativeAudioNode.connect(C,E),(g||dt(this))&&this._nativeAudioNode.disconnect(C,E)}catch(y){throw y.code===12?s():y}if(us(this,N,E,g)){const y=i([this],N);Dt(y,r(g))}}disconnect(N,E,T){let S;const g=u(this._context),C=f(g);if(N===void 0)S=fs(this,C);else if(typeof N=="number"){if(N<0||N>=this.numberOfOutputs)throw o();S=ps(this,C,N)}else{if(E!==void 0&&(E<0||E>=this.numberOfOutputs)||gt(N)&&T!==void 0&&(T<0||T>=N.numberOfInputs))throw o();if(S=ms(this,C,N,E,T),S.length===0)throw s()}for(const _ of S){const y=i([this],_);Dt(y,a)}}},ys=(e,n,t,r,o,s,l,a,i,c,u,d,h)=>(p,f,m,v=null,N=null)=>{const E=m.value,T=new Ro(E),S=f?r(T):null,g={get defaultValue(){return E},get maxValue(){return v===null?m.maxValue:v},get minValue(){return N===null?m.minValue:N},get value(){return m.value},set value(C){m.value=C,g.setValueAtTime(C,p.context.currentTime)},cancelAndHoldAtTime(C){if(typeof m.cancelAndHoldAtTime=="function")S===null&&T.flush(p.context.currentTime),T.add(o(C)),m.cancelAndHoldAtTime(C);else{const _=Array.from(T).pop();S===null&&T.flush(p.context.currentTime),T.add(o(C));const y=Array.from(T).pop();m.cancelScheduledValues(C),_!==y&&y!==void 0&&(y.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(y.value,y.endTime):y.type==="linearRampToValue"?m.linearRampToValueAtTime(y.value,y.endTime):y.type==="setValue"?m.setValueAtTime(y.value,y.startTime):y.type==="setValueCurve"&&m.setValueCurveAtTime(y.values,y.startTime,y.duration))}return g},cancelScheduledValues(C){return S===null&&T.flush(p.context.currentTime),T.add(s(C)),m.cancelScheduledValues(C),g},exponentialRampToValueAtTime(C,_){if(C===0)throw new RangeError;if(!Number.isFinite(_)||_<0)throw new RangeError;const y=p.context.currentTime;return S===null&&T.flush(y),Array.from(T).length===0&&(T.add(c(E,y)),m.setValueAtTime(E,y)),T.add(l(C,_)),m.exponentialRampToValueAtTime(C,_),g},linearRampToValueAtTime(C,_){const y=p.context.currentTime;return S===null&&T.flush(y),Array.from(T).length===0&&(T.add(c(E,y)),m.setValueAtTime(E,y)),T.add(a(C,_)),m.linearRampToValueAtTime(C,_),g},setTargetAtTime(C,_,y){return S===null&&T.flush(p.context.currentTime),T.add(i(C,_,y)),m.setTargetAtTime(C,_,y),g},setValueAtTime(C,_){return S===null&&T.flush(p.context.currentTime),T.add(c(C,_)),m.setValueAtTime(C,_),g},setValueCurveAtTime(C,_,y){const M=C instanceof Float32Array?C:new Float32Array(C);if(d!==null&&d.name==="webkitAudioContext"){const w=_+y,I=p.context.sampleRate,b=Math.ceil(_*I),A=Math.floor(w*I),R=A-b,k=new Float32Array(R);for(let D=0;D<R;D+=1){const V=(M.length-1)/y*((b+D)/I-_),P=Math.floor(V),L=Math.ceil(V);k[D]=P===L?M[P]:(1-(V-P))*M[P]+(1-(L-V))*M[L]}S===null&&T.flush(p.context.currentTime),T.add(u(k,_,y)),m.setValueCurveAtTime(k,_,y);const O=A/I;O<w&&h(g,k[k.length-1],O),h(g,M[M.length-1],w)}else S===null&&T.flush(p.context.currentTime),T.add(u(M,_,y)),m.setValueCurveAtTime(M,_,y);return g}};return t.set(g,m),n.set(g,p),e(g,S),g},vs=e=>({replay(n){for(const t of e)if(t.type==="exponentialRampToValue"){const{endTime:r,value:o}=t;n.exponentialRampToValueAtTime(o,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:o}=t;n.linearRampToValueAtTime(o,r)}else if(t.type==="setTarget"){const{startTime:r,target:o,timeConstant:s}=t;n.setTargetAtTime(o,r,s)}else if(t.type==="setValue"){const{startTime:r,value:o}=t;n.setValueAtTime(o,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:o,values:s}=t;n.setValueCurveAtTime(s,o,r)}else throw new Error("Can't apply an unknown automation.")}}),Ns=(e,n,t,r,o,s,l,a,i,c,u,d,h,p,f,m,v,N,E,T)=>class extends f{constructor(g,C){super(g,C),this._nativeContext=g,this._audioWorklet=e===void 0?void 0:{addModule:(_,y)=>e(this,_,y)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new n(this)}createBiquadFilter(){return new o(this)}createBuffer(g,C,_){return new t({length:C,numberOfChannels:g,sampleRate:_})}createBufferSource(){return new r(this)}createChannelMerger(g=6){return new s(this,{numberOfInputs:g})}createChannelSplitter(g=6){return new l(this,{numberOfOutputs:g})}createConstantSource(){return new a(this)}createConvolver(){return new i(this)}createDelay(g=1){return new u(this,{maxDelayTime:g})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(g,C){return new p(this,{feedback:C,feedforward:g})}createOscillator(){return new m(this)}createPanner(){return new v(this)}createPeriodicWave(g,C,_={disableNormalization:!1}){return new N(this,{..._,imag:C,real:g})}createStereoPanner(){return new E(this)}createWaveShaper(){return new T(this)}decodeAudioData(g,C,_){return c(this._nativeContext,g).then(y=>(typeof C=="function"&&C(y),y),y=>{throw typeof _=="function"&&_(y),y})}},ws={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Cs=(e,n,t,r,o,s,l,a)=>class extends e{constructor(c,u){const d=s(c),h={...ws,...u},p=o(d,h),f=l(d),m=f?t():null;super(c,!1,p,m),this._Q=n(this,f,p.Q,J,ne),this._detune=n(this,f,p.detune,1200*Math.log2(J),-1200*Math.log2(J)),this._frequency=n(this,f,p.frequency,c.sampleRate/2,0),this._gain=n(this,f,p.gain,40*Math.log10(J),ne),this._nativeBiquadFilterNode=p,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,d)}catch(h){throw h.code===11?r():h}if(c.length!==u.length||u.length!==d.length)throw r()}},_s=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,i)=>{let c=t(a);const u=Q(c,i);if(!u){const d={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=n(i,d)}return s.set(i,c),u?(await e(i,a.Q,c.Q),await e(i,a.detune,c.detune),await e(i,a.frequency,c.frequency),await e(i,a.gain,c.gain)):(await r(i,a.Q,c.Q),await r(i,a.detune,c.detune),await r(i,a.frequency,c.frequency),await r(i,a.gain,c.gain)),await o(a,i,c),c};return{render(a,i){const c=s.get(i);return c!==void 0?Promise.resolve(c):l(a,i)}}},bs=(e,n)=>(t,r)=>{const o=n.get(t);if(o!==void 0)return o;const s=e.get(t);if(s!==void 0)return s;try{const l=r();return l instanceof Promise?(e.set(t,l),l.catch(()=>!1).then(a=>(e.delete(t),n.set(t,a),a))):(n.set(t,l),l)}catch{return n.set(t,!1),!1}},Ts={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Is=(e,n,t,r,o)=>class extends e{constructor(l,a){const i=r(l),c={...Ts,...a},u=t(i,c),d=o(i)?n():null;super(l,!1,u,d)}},Es=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=e(l,c)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},Ss={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ms=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=r(a),u=s({...Ss,...i}),d=t(c,u),h=o(c)?n():null;super(a,!1,d,h)}},Rs=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=e(l,c)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},As=e=>(n,t,r)=>e(t,n,r),Os=e=>(n,t)=>{const r=e(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=n.createBuffer(1,2,44100);return r.buffer=o,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},Fs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Ds=(e,n,t,r,o,s,l)=>class extends e{constructor(i,c){const u=o(i),d={...Fs,...c},h=r(u,d),p=s(u),f=p?t():null;super(i,!1,h,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=h,this._offset=n(this,p,h.offset,J,ne),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(i){const c=typeof i=="function"?l(this,i):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?i:u}start(i=0){if(this._nativeConstantSourceNode.start(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=i),this.context.state!=="closed"){We(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),me(this)&&Je(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(i=0){this._nativeConstantSourceNode.stop(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=i)}},ks=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null;const i=async(c,u)=>{let d=t(c);const h=Q(d,u);if(!h){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=n(u,p),l!==null&&d.start(l),a!==null&&d.stop(a)}return s.set(u,d),h?await e(u,c.offset,d.offset):await r(u,c.offset,d.offset),await o(c,u,d),d};return{set start(c){l=c},set stop(c){a=c},render(c,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):i(c,u)}}},Ps=e=>n=>(e[0]=n,e[0]),Ls={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Bs=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=r(a),u={...Ls,...i},d=t(c,u),p=o(c)?n():null;super(a,!1,d,p),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const i=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=i.createBuffer(1,1,i.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},Ws=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=e(l,c)}return r.set(l,a),qe(a)?await t(s,l,a.inputs[0]):await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},Vs=(e,n)=>(t,r,o)=>{if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new n(t,r,o)}catch(s){throw s.name==="SyntaxError"?e():s}},qs=()=>new DOMException("","DataCloneError"),Un=e=>{const{port1:n,port2:t}=new MessageChannel;return new Promise(r=>{const o=()=>{t.onmessage=null,n.close(),t.close(),r()};t.onmessage=()=>o();try{n.postMessage(e,[e])}catch{}finally{o()}})},Us=(e,n,t,r,o,s,l,a,i,c,u)=>(d,h)=>{const p=l(d)?d:s(d);if(o.has(h)){const f=t();return Promise.reject(f)}try{o.add(h)}catch{}return n(i,()=>i(p))?p.decodeAudioData(h).then(f=>(Un(h).catch(()=>{}),n(a,()=>a(f))||u(f),e.add(f),f)):new Promise((f,m)=>{const v=async()=>{try{await Un(h)}catch{}},N=E=>{m(E),v()};try{p.decodeAudioData(h,E=>{typeof E.copyFromChannel!="function"&&(c(E),an(E)),e.add(E),v().then(()=>f(E))},E=>{N(E===null?r():E)})}catch(E){N(E)}})},xs=(e,n,t,r,o,s,l,a)=>(i,c)=>{const u=n.get(i);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(i.context),h=a(d);if(u===c){if(n.delete(i),!h&&l(i)){const p=r(i),{outputs:f}=t(i);for(const m of f)if(tt(m)){const v=r(m[0]);e(p,v,m[1],m[2])}else{const v=o(m[0]);p.connect(v,m[1])}}}else n.set(i,u-c)},js={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Xs=(e,n,t,r,o,s,l)=>class extends e{constructor(i,c){const u=o(i),d={...js,...c},h=r(u,d),p=s(u),f=p?t(d.maxDelayTime):null;super(i,!1,h,f),this._delayTime=n(this,p,h.delayTime),l(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},Zs=(e,n,t,r,o)=>s=>{const l=new WeakMap,a=async(i,c)=>{let u=t(i);const d=Q(u,c);if(!d){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=n(c,h)}return l.set(c,u),d?await e(c,i.delayTime,u.delayTime):await r(c,i.delayTime,u.delayTime),await o(i,c,u),u};return{render(i,c){const u=l.get(c);return u!==void 0?Promise.resolve(u):a(i,c)}}},zs=e=>(n,t,r,o)=>e(n[o],s=>s[0]===t&&s[1]===r),Gs=e=>"delayTime"in e,$s=(e,n,t)=>function r(o,s){const l=gt(s)?s:t(e,s);if(Gs(l))return[];if(o[0]===l)return[o];if(o.includes(l))return[];const{outputs:a}=n(l);return Array.from(a).map(i=>r([...o,l],i[0])).reduce((i,c)=>i.concat(c),[])},Ys={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Hs=(e,n,t,r,o,s,l,a)=>class extends e{constructor(c,u){const d=s(c),h={...Ys,...u},p=r(d,h),f=l(d),m=f?t():null;super(c,!1,p,m),this._attack=n(this,f,p.attack),this._knee=n(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=n(this,f,p.ratio),this._release=n(this,f,p.release),this._threshold=n(this,f,p.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Ks=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,i)=>{let c=t(a);const u=Q(c,i);if(!u){const d={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=n(i,d)}return s.set(i,c),u?(await e(i,a.attack,c.attack),await e(i,a.knee,c.knee),await e(i,a.ratio,c.ratio),await e(i,a.release,c.release),await e(i,a.threshold,c.threshold)):(await r(i,a.attack,c.attack),await r(i,a.knee,c.knee),await r(i,a.ratio,c.ratio),await r(i,a.release,c.release),await r(i,a.threshold,c.threshold)),await o(a,i,c),c};return{render(a,i){const c=s.get(i);return c!==void 0?Promise.resolve(c):l(a,i)}}},Qs=()=>new DOMException("","EncodingError"),Js=e=>n=>new Promise((t,r)=>{if(e===null){r(new SyntaxError);return}const o=e.document.head;if(o===null)r(new SyntaxError);else{const s=e.document.createElement("script"),l=new Blob([n],{type:"application/javascript"}),a=URL.createObjectURL(l),i=e.onerror,c=()=>{e.onerror=i,URL.revokeObjectURL(a)};e.onerror=(u,d,h,p,f)=>{if(d===a||d===e.location.href&&h===1&&p===1)return c(),r(f),!1;if(i!==null)return i(u,d,h,p,f)},s.onerror=()=>{c(),r(new SyntaxError)},s.onload=()=>{c(),t()},s.src=a,s.type="module",o.appendChild(s)}}),ea=e=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,o){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=e(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(t,s,o)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,o){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,s===void 0?null:s,o)}},ta=e=>(n,t,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(n*t)}},currentTime:{configurable:!0,get(){return n}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},na=e=>async n=>{try{const t=await fetch(n);if(t.ok)return[await t.text(),t.url]}catch{}throw e()},ra={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},oa=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=o(a),u={...ra,...i},d=r(c,u),h=s(c),p=h?t():null;super(a,!1,d,p),this._gain=n(this,h,d.gain,J,ne)}get gain(){return this._gain}},sa=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,i)=>{let c=t(a);const u=Q(c,i);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=n(i,d)}return s.set(i,c),u?await e(i,a.gain,c.gain):await r(i,a.gain,c.gain),await o(a,i,c),c};return{render(a,i){const c=s.get(i);return c!==void 0?Promise.resolve(c):l(a,i)}}},aa=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},ca=e=>n=>{var t;return(t=e.get(n))!==null&&t!==void 0?t:0},ia=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},ee=()=>new DOMException("","InvalidStateError"),la=e=>n=>{const t=e.get(n);if(t===void 0)throw ee();return t},ua=(e,n)=>t=>{let r=e.get(t);if(r!==void 0)return r;if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new n(1,1,44100),e.set(t,r),r},da=e=>n=>{const t=e.get(n);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},bt=()=>new DOMException("","InvalidAccessError"),ha=e=>{e.getFrequencyResponse=(n=>(t,r,o)=>{if(t.length!==r.length||r.length!==o.length)throw bt();return n.call(e,t,r,o)})(e.getFrequencyResponse)},fa={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},pa=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=r(a),u=o(c),d={...fa,...i},h=n(c,u?null:a.baseLatency,d),p=u?t(d.feedback,d.feedforward):null;super(a,!1,h,p),ha(h),this._nativeIIRFilterNode=h,s(this,1)}getFrequencyResponse(a,i,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,i,c)}},Cr=(e,n,t,r,o,s,l,a,i,c,u)=>{const d=c.length;let h=a;for(let p=0;p<d;p+=1){let f=t[0]*c[p];for(let m=1;m<o;m+=1){const v=h-m&i-1;f+=t[m]*s[v],f-=e[m]*l[v]}for(let m=o;m<r;m+=1)f+=t[m]*s[h-m&i-1];for(let m=o;m<n;m+=1)f-=e[m]*l[h-m&i-1];s[h]=c[p],l[h]=f,h=h+1&i-1,u[p]=f}return h},ma=(e,n,t,r)=>{const o=t instanceof Float64Array?t:new Float64Array(t),s=r instanceof Float64Array?r:new Float64Array(r),l=o.length,a=s.length,i=Math.min(l,a);if(o[0]!==1){for(let f=0;f<l;f+=1)s[f]/=o[0];for(let f=1;f<a;f+=1)o[f]/=o[0]}const c=32,u=new Float32Array(c),d=new Float32Array(c),h=n.createBuffer(e.numberOfChannels,e.length,e.sampleRate),p=e.numberOfChannels;for(let f=0;f<p;f+=1){const m=e.getChannelData(f),v=h.getChannelData(f);u.fill(0),d.fill(0),Cr(o,l,s,a,i,u,d,0,c,m,v)}return h},ga=(e,n,t,r,o)=>(s,l)=>{const a=new WeakMap;let i=null;const c=async(u,d)=>{let h=null,p=n(u);const f=Q(p,d);if(d.createIIRFilter===void 0?h=e(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=d.createIIRFilter(l,s)),a.set(d,h===null?p:h),h!==null){if(i===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const v=new t(u.context.destination.channelCount,u.context.length,d.sampleRate);i=(async()=>{await r(u,v,v.destination);const N=await o(v);return ma(N,d,s,l)})()}const m=await i;return h.buffer=m,h.start(0),h}return await r(u,d,p),p};return{render(u,d){const h=a.get(d);return h!==void 0?Promise.resolve(h):c(u,d)}}},ya=(e,n,t,r,o,s)=>l=>(a,i)=>{const c=e.get(a);if(c===void 0){if(!l&&s(a)){const u=r(a),{outputs:d}=t(a);for(const h of d)if(tt(h)){const p=r(h[0]);n(u,p,h[1],h[2])}else{const p=o(h[0]);u.disconnect(p,h[1])}}e.set(a,i)}else e.set(a,c+i)},va=e=>n=>e!==null&&n instanceof e,Na=e=>n=>e!==null&&typeof e.AudioNode=="function"&&n instanceof e.AudioNode,wa=e=>n=>e!==null&&typeof e.AudioParam=="function"&&n instanceof e.AudioParam,Ca=(e,n)=>t=>e(t)||n(t),_a=e=>n=>e!==null&&n instanceof e,ba=e=>e!==null&&e.isSecureContext,Ta=(e,n,t,r,o,s)=>class extends t{constructor(a,i){super(a),this._nativeContext=a,hr.set(this,a),r(a)&&o.set(a,new Set),this._destination=new e(this,i),this._listener=n(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const i=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=i;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===i?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},He=e=>{const n=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=e.decodeAudioData(n.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},Ia=(e,n)=>(t,r,o)=>{const s=new Set;return t.connect=(l=>(a,i=0,c=0)=>{const u=s.size===0;if(n(a))return l.call(t,a,i,c),e(s,[a,i,c],d=>d[0]===a&&d[1]===i&&d[2]===c,!0),u&&r(),a;l.call(t,a,i),e(s,[a,i],d=>d[0]===a&&d[1]===i,!0),u&&r()})(t.connect),t.disconnect=(l=>(a,i,c)=>{const u=s.size>0;if(a===void 0)l.apply(t),s.clear();else if(typeof a=="number"){l.call(t,a);for(const h of s)h[1]===a&&s.delete(h)}else{n(a)?l.call(t,a,i,c):l.call(t,a,i);for(const h of s)h[0]===a&&(i===void 0||h[1]===i)&&(c===void 0||h[2]===c)&&s.delete(h)}const d=s.size===0;u&&d&&o()})(t.disconnect),t},U=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t]&&(e[t]=r)},Y=(e,n)=>{U(e,n,"channelCount"),U(e,n,"channelCountMode"),U(e,n,"channelInterpretation")},xn=e=>typeof e.getFloatTimeDomainData=="function",Ea=e=>{e.getFloatTimeDomainData=n=>{const t=new Uint8Array(n.length);e.getByteTimeDomainData(t);const r=Math.max(t.length,e.fftSize);for(let o=0;o<r;o+=1)n[o]=(t[o]-128)*.0078125;return n}},Sa=(e,n)=>(t,r)=>{const o=t.createAnalyser();if(Y(o,r),!(r.maxDecibels>r.minDecibels))throw n();return U(o,r,"fftSize"),U(o,r,"maxDecibels"),U(o,r,"minDecibels"),U(o,r,"smoothingTimeConstant"),e(xn,()=>xn(o))||Ea(o),o},Ma=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,X=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t].value&&(e[t].value=r)},Ra=e=>{e.start=(n=>{let t=!1;return(r=0,o=0,s)=>{if(t)throw ee();n.call(e,r,o,s),t=!0}})(e.start)},un=e=>{e.start=(n=>(t=0,r=0,o)=>{if(typeof o=="number"&&o<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");n.call(e,t,r,o)})(e.start)},dn=e=>{e.stop=(n=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");n.call(e,t)})(e.stop)},Aa=(e,n,t,r,o,s,l,a,i,c,u)=>(d,h)=>{const p=d.createBufferSource();return Y(p,h),X(p,h,"playbackRate"),U(p,h,"buffer"),U(p,h,"loop"),U(p,h,"loopEnd"),U(p,h,"loopStart"),n(t,()=>t(d))||Ra(p),n(r,()=>r(d))||i(p),n(o,()=>o(d))||c(p,d),n(s,()=>s(d))||un(p),n(l,()=>l(d))||u(p,d),n(a,()=>a(d))||dn(p),e(d,p),p},Oa=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,Fa=(e,n)=>(t,r,o)=>{const s=t.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}o&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const l=e(t,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return n(l,"channelCount",a=>()=>a.call(l),a=>i=>{a.call(l,i);try{s.channelCount=i}catch(c){if(i>s.maxChannelCount)throw c}}),n(l,"channelCountMode",a=>()=>a.call(l),a=>i=>{a.call(l,i),s.channelCountMode=i}),n(l,"channelInterpretation",a=>()=>a.call(l),a=>i=>{a.call(l,i),s.channelInterpretation=i}),Object.defineProperty(l,"maxChannelCount",{get:()=>s.maxChannelCount}),l.connect(s),l},Da=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,ka=(e,n)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*n))))),_r=(e,n)=>{const t=e.createBiquadFilter();return Y(t,n),X(t,n,"Q"),X(t,n,"detune"),X(t,n,"frequency"),X(t,n,"gain"),U(t,n,"type"),t},Pa=(e,n)=>(t,r)=>{const o=t.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&n(t,o),Y(o,r),o},La=e=>{const n=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>n,set:t=>{if(t!==n)throw ee()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw ee()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw ee()}})},hn=(e,n)=>{const t=e.createChannelSplitter(n.numberOfOutputs);return Y(t,n),La(t),t},Ba=(e,n,t,r,o)=>(s,l)=>{if(s.createConstantSource===void 0)return t(s,l);const a=s.createConstantSource();return Y(a,l),X(a,l,"offset"),n(r,()=>r(s))||un(a),n(o,()=>o(s))||dn(a),e(s,a),a},Ue=(e,n)=>(e.connect=n.connect.bind(n),e.disconnect=n.disconnect.bind(n),e),Wa=(e,n,t,r)=>(o,{offset:s,...l})=>{const a=o.createBuffer(1,2,44100),i=n(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t(o,{...l,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,i.buffer=a,i.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(f){c.channelCount=f},get channelCountMode(){return c.channelCountMode},set channelCountMode(f){c.channelCountMode=f},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(f){c.channelInterpretation=f},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return i.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return i.onended},set onended(f){i.onended=f},addEventListener(...f){return i.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return i.dispatchEvent(f[0])},removeEventListener(...f){return i.removeEventListener(f[0],f[1],f[2])},start(f=0){i.start.call(i,f)},stop(f=0){i.stop.call(i,f)}},h=()=>i.connect(c),p=()=>i.disconnect(c);return e(o,i),r(Ue(d,c),h,p)},Va=(e,n)=>(t,r)=>{const o=t.createConvolver();if(Y(o,r),r.disableNormalization===o.normalize&&(o.normalize=!r.disableNormalization),U(o,r,"buffer"),r.channelCount>2||(n(o,"channelCount",s=>()=>s.call(o),s=>l=>{if(l>2)throw e();return s.call(o,l)}),r.channelCountMode==="max"))throw e();return n(o,"channelCountMode",s=>()=>s.call(o),s=>l=>{if(l==="max")throw e();return s.call(o,l)}),o},br=(e,n)=>{const t=e.createDelay(n.maxDelayTime);return Y(t,n),X(t,n,"delayTime"),t},qa=e=>(n,t)=>{const r=n.createDynamicsCompressor();if(Y(r,t),t.channelCount>2||t.channelCountMode==="max")throw e();return X(r,t,"attack"),X(r,t,"knee"),X(r,t,"ratio"),X(r,t,"release"),X(r,t,"threshold"),r},ce=(e,n)=>{const t=e.createGain();return Y(t,n),X(t,n,"gain"),t},Ua=e=>(n,t,r)=>{if(n.createIIRFilter===void 0)return e(n,t,r);const o=n.createIIRFilter(r.feedforward,r.feedback);return Y(o,r),o};function xa(e,n){const t=n[0]*n[0]+n[1]*n[1];return[(e[0]*n[0]+e[1]*n[1])/t,(e[1]*n[0]-e[0]*n[1])/t]}function ja(e,n){return[e[0]*n[0]-e[1]*n[1],e[0]*n[1]+e[1]*n[0]]}function jn(e,n){let t=[0,0];for(let r=e.length-1;r>=0;r-=1)t=ja(t,n),t[0]+=e[r];return t}const Xa=(e,n,t,r)=>(o,s,{channelCount:l,channelCountMode:a,channelInterpretation:i,feedback:c,feedforward:u})=>{const d=ka(s,o.sampleRate),h=c instanceof Float64Array?c:new Float64Array(c),p=u instanceof Float64Array?u:new Float64Array(u),f=h.length,m=p.length,v=Math.min(f,m);if(f===0||f>20)throw r();if(h[0]===0)throw n();if(m===0||m>20)throw r();if(p[0]===0)throw n();if(h[0]!==1){for(let y=0;y<m;y+=1)p[y]/=h[0];for(let y=1;y<f;y+=1)h[y]/=h[0]}const N=t(o,d,l,l);N.channelCount=l,N.channelCountMode=a,N.channelInterpretation=i;const E=32,T=[],S=[],g=[];for(let y=0;y<l;y+=1){T.push(0);const M=new Float32Array(E),w=new Float32Array(E);M.fill(0),w.fill(0),S.push(M),g.push(w)}N.onaudioprocess=y=>{const M=y.inputBuffer,w=y.outputBuffer,I=M.numberOfChannels;for(let b=0;b<I;b+=1){const A=M.getChannelData(b),R=w.getChannelData(b);T[b]=Cr(h,f,p,m,v,S[b],g[b],T[b],E,A,R)}};const C=o.sampleRate/2;return Ue({get bufferSize(){return d},get channelCount(){return N.channelCount},set channelCount(y){N.channelCount=y},get channelCountMode(){return N.channelCountMode},set channelCountMode(y){N.channelCountMode=y},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(y){N.channelInterpretation=y},get context(){return N.context},get inputs(){return[N]},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},addEventListener(...y){return N.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return N.dispatchEvent(y[0])},getFrequencyResponse(y,M,w){if(y.length!==M.length||M.length!==w.length)throw e();const I=y.length;for(let b=0;b<I;b+=1){const A=-Math.PI*(y[b]/C),R=[Math.cos(A),Math.sin(A)],k=jn(p,R),O=jn(h,R),D=xa(k,O);M[b]=Math.sqrt(D[0]*D[0]+D[1]*D[1]),w[b]=Math.atan2(D[1],D[0])}},removeEventListener(...y){return N.removeEventListener(y[0],y[1],y[2])}},N)},Za=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,za=(e,n,t,r,o,s)=>(l,a)=>{const i=l.createOscillator();return Y(i,a),X(i,a,"detune"),X(i,a,"frequency"),a.periodicWave!==void 0?i.setPeriodicWave(a.periodicWave):U(i,a,"type"),n(t,()=>t(l))||un(i),n(r,()=>r(l))||s(i,l),n(o,()=>o(l))||dn(i),e(l,i),i},Ga=e=>(n,t)=>{const r=n.createPanner();return r.orientationX===void 0?e(n,t):(Y(r,t),X(r,t,"orientationX"),X(r,t,"orientationY"),X(r,t,"orientationZ"),X(r,t,"positionX"),X(r,t,"positionY"),X(r,t,"positionZ"),U(r,t,"coneInnerAngle"),U(r,t,"coneOuterAngle"),U(r,t,"coneOuterGain"),U(r,t,"distanceModel"),U(r,t,"maxDistance"),U(r,t,"panningModel"),U(r,t,"refDistance"),U(r,t,"rolloffFactor"),r)},$a=(e,n,t,r,o,s,l,a,i,c)=>(u,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:p,distanceModel:f,maxDistance:m,orientationX:v,orientationY:N,orientationZ:E,panningModel:T,positionX:S,positionY:g,positionZ:C,refDistance:_,rolloffFactor:y,...M})=>{const w=u.createPanner();if(M.channelCount>2||M.channelCountMode==="max")throw l();Y(w,M);const I={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},b=t(u,{...I,channelInterpretation:"speakers",numberOfInputs:6}),A=r(u,{...M,gain:1}),R=r(u,{...I,gain:1}),k=r(u,{...I,gain:0}),O=r(u,{...I,gain:0}),D=r(u,{...I,gain:0}),V=r(u,{...I,gain:0}),P=r(u,{...I,gain:0}),L=o(u,256,6,1),B=s(u,{...I,curve:new Float32Array([1,1]),oversample:"none"});let x=[v,N,E],Ae=[S,g,C];const Oe=new Float32Array(1);L.onaudioprocess=({inputBuffer:F})=>{const Rt=[i(F,Oe,0),i(F,Oe,1),i(F,Oe,2)];Rt.some((Ot,Ft)=>Ot!==x[Ft])&&(w.setOrientation(...Rt),x=Rt);const At=[i(F,Oe,3),i(F,Oe,4),i(F,Oe,5)];At.some((Ot,Ft)=>Ot!==Ae[Ft])&&(w.setPosition(...At),Ae=At)},Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0});const W={get bufferSize(){},get channelCount(){return w.channelCount},set channelCount(F){if(F>2)throw l();A.channelCount=F,w.channelCount=F},get channelCountMode(){return w.channelCountMode},set channelCountMode(F){if(F==="max")throw l();A.channelCountMode=F,w.channelCountMode=F},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(F){A.channelInterpretation=F,w.channelInterpretation=F},get coneInnerAngle(){return w.coneInnerAngle},set coneInnerAngle(F){w.coneInnerAngle=F},get coneOuterAngle(){return w.coneOuterAngle},set coneOuterAngle(F){w.coneOuterAngle=F},get coneOuterGain(){return w.coneOuterGain},set coneOuterGain(F){if(F<0||F>1)throw n();w.coneOuterGain=F},get context(){return w.context},get distanceModel(){return w.distanceModel},set distanceModel(F){w.distanceModel=F},get inputs(){return[A]},get maxDistance(){return w.maxDistance},set maxDistance(F){if(F<0)throw new RangeError;w.maxDistance=F},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get orientationX(){return R.gain},get orientationY(){return k.gain},get orientationZ(){return O.gain},get panningModel(){return w.panningModel},set panningModel(F){w.panningModel=F},get positionX(){return D.gain},get positionY(){return V.gain},get positionZ(){return P.gain},get refDistance(){return w.refDistance},set refDistance(F){if(F<0)throw new RangeError;w.refDistance=F},get rolloffFactor(){return w.rolloffFactor},set rolloffFactor(F){if(F<0)throw new RangeError;w.rolloffFactor=F},addEventListener(...F){return A.addEventListener(F[0],F[1],F[2])},dispatchEvent(...F){return A.dispatchEvent(F[0])},removeEventListener(...F){return A.removeEventListener(F[0],F[1],F[2])}};d!==W.coneInnerAngle&&(W.coneInnerAngle=d),h!==W.coneOuterAngle&&(W.coneOuterAngle=h),p!==W.coneOuterGain&&(W.coneOuterGain=p),f!==W.distanceModel&&(W.distanceModel=f),m!==W.maxDistance&&(W.maxDistance=m),v!==W.orientationX.value&&(W.orientationX.value=v),N!==W.orientationY.value&&(W.orientationY.value=N),E!==W.orientationZ.value&&(W.orientationZ.value=E),T!==W.panningModel&&(W.panningModel=T),S!==W.positionX.value&&(W.positionX.value=S),g!==W.positionY.value&&(W.positionY.value=g),C!==W.positionZ.value&&(W.positionZ.value=C),_!==W.refDistance&&(W.refDistance=_),y!==W.rolloffFactor&&(W.rolloffFactor=y),(x[0]!==1||x[1]!==0||x[2]!==0)&&w.setOrientation(...x),(Ae[0]!==0||Ae[1]!==0||Ae[2]!==0)&&w.setPosition(...Ae);const eo=()=>{A.connect(w),e(A,B,0,0),B.connect(R).connect(b,0,0),B.connect(k).connect(b,0,1),B.connect(O).connect(b,0,2),B.connect(D).connect(b,0,3),B.connect(V).connect(b,0,4),B.connect(P).connect(b,0,5),b.connect(L).connect(u.destination)},to=()=>{A.disconnect(w),a(A,B,0,0),B.disconnect(R),R.disconnect(b),B.disconnect(k),k.disconnect(b),B.disconnect(O),O.disconnect(b),B.disconnect(D),D.disconnect(b),B.disconnect(V),V.disconnect(b),B.disconnect(P),P.disconnect(b),b.disconnect(L),L.disconnect(u.destination)};return c(Ue(W,w),eo,to)},Ya=e=>(n,{disableNormalization:t,imag:r,real:o})=>{const s=r instanceof Float32Array?r:new Float32Array(r),l=o instanceof Float32Array?o:new Float32Array(o),a=n.createPeriodicWave(l,s,{disableNormalization:t});if(Array.from(r).length<2)throw e();return a},Tt=(e,n,t,r)=>e.createScriptProcessor(n,t,r),Ha=(e,n)=>(t,r)=>{const o=r.channelCountMode;if(o==="clamped-max")throw n();if(t.createStereoPanner===void 0)return e(t,r);const s=t.createStereoPanner();return Y(s,r),X(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>o,set:l=>{if(l!==o)throw n()}}),s},Ka=(e,n,t,r,o,s)=>{const a=new Float32Array([1,1]),i=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(f,m,v,N)=>{const E=new Float32Array(16385),T=new Float32Array(16385);for(let M=0;M<16385;M+=1){const w=M/16384*i;E[M]=Math.cos(w),T[M]=Math.sin(w)}const S=t(f,{...c,gain:0}),g=r(f,{...u,curve:E}),C=r(f,{...u,curve:a}),_=t(f,{...c,gain:0}),y=r(f,{...u,curve:T});return{connectGraph(){m.connect(S),m.connect(C.inputs===void 0?C:C.inputs[0]),m.connect(_),C.connect(v),v.connect(g.inputs===void 0?g:g.inputs[0]),v.connect(y.inputs===void 0?y:y.inputs[0]),g.connect(S.gain),y.connect(_.gain),S.connect(N,0,0),_.connect(N,0,1)},disconnectGraph(){m.disconnect(S),m.disconnect(C.inputs===void 0?C:C.inputs[0]),m.disconnect(_),C.disconnect(v),v.disconnect(g.inputs===void 0?g:g.inputs[0]),v.disconnect(y.inputs===void 0?y:y.inputs[0]),g.disconnect(S.gain),y.disconnect(_.gain),S.disconnect(N,0,0),_.disconnect(N,0,1)}}},h=(f,m,v,N)=>{const E=new Float32Array(16385),T=new Float32Array(16385),S=new Float32Array(16385),g=new Float32Array(16385),C=Math.floor(16385/2);for(let D=0;D<16385;D+=1)if(D>C){const V=(D-C)/(16384-C)*i;E[D]=Math.cos(V),T[D]=Math.sin(V),S[D]=0,g[D]=1}else{const V=D/(16384-C)*i;E[D]=1,T[D]=0,S[D]=Math.cos(V),g[D]=Math.sin(V)}const _=n(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=t(f,{...c,gain:0}),M=r(f,{...u,curve:E}),w=t(f,{...c,gain:0}),I=r(f,{...u,curve:T}),b=r(f,{...u,curve:a}),A=t(f,{...c,gain:0}),R=r(f,{...u,curve:S}),k=t(f,{...c,gain:0}),O=r(f,{...u,curve:g});return{connectGraph(){m.connect(_),m.connect(b.inputs===void 0?b:b.inputs[0]),_.connect(y,0),_.connect(w,0),_.connect(A,1),_.connect(k,1),b.connect(v),v.connect(M.inputs===void 0?M:M.inputs[0]),v.connect(I.inputs===void 0?I:I.inputs[0]),v.connect(R.inputs===void 0?R:R.inputs[0]),v.connect(O.inputs===void 0?O:O.inputs[0]),M.connect(y.gain),I.connect(w.gain),R.connect(A.gain),O.connect(k.gain),y.connect(N,0,0),A.connect(N,0,0),w.connect(N,0,1),k.connect(N,0,1)},disconnectGraph(){m.disconnect(_),m.disconnect(b.inputs===void 0?b:b.inputs[0]),_.disconnect(y,0),_.disconnect(w,0),_.disconnect(A,1),_.disconnect(k,1),b.disconnect(v),v.disconnect(M.inputs===void 0?M:M.inputs[0]),v.disconnect(I.inputs===void 0?I:I.inputs[0]),v.disconnect(R.inputs===void 0?R:R.inputs[0]),v.disconnect(O.inputs===void 0?O:O.inputs[0]),M.disconnect(y.gain),I.disconnect(w.gain),R.disconnect(A.gain),O.disconnect(k.gain),y.disconnect(N,0,0),A.disconnect(N,0,0),w.disconnect(N,0,1),k.disconnect(N,0,1)}}},p=(f,m,v,N,E)=>{if(m===1)return d(f,v,N,E);if(m===2)return h(f,v,N,E);throw o()};return(f,{channelCount:m,channelCountMode:v,pan:N,...E})=>{if(v==="max")throw o();const T=e(f,{...E,channelCount:1,channelCountMode:v,numberOfInputs:2}),S=t(f,{...E,channelCount:m,channelCountMode:v,gain:1}),g=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:N});let{connectGraph:C,disconnectGraph:_}=p(f,m,S,g,T);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});const y={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(b){S.channelCount!==b&&(M&&_(),{connectGraph:C,disconnectGraph:_}=p(f,b,S,g,T),M&&C()),S.channelCount=b},get channelCountMode(){return S.channelCountMode},set channelCountMode(b){if(b==="clamped-max"||b==="max")throw o();S.channelCountMode=b},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(b){S.channelInterpretation=b},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get pan(){return g.gain},addEventListener(...b){return S.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return S.dispatchEvent(b[0])},removeEventListener(...b){return S.removeEventListener(b[0],b[1],b[2])}};let M=!1;const w=()=>{C(),M=!0},I=()=>{_(),M=!1};return s(Ue(y,T),w,I)}},Qa=(e,n,t,r,o,s,l)=>(a,i)=>{const c=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,i);Y(c,i);const u=i.curve===null||i.curve instanceof Float32Array?i.curve:new Float32Array(i.curve);if(u!==null&&u.length<2)throw n();U(c,{curve:u},"curve"),U(c,i,"oversample");let d=null,h=!1;return l(c,"curve",m=>()=>m.call(c),m=>v=>(m.call(c,v),h&&(r(v)&&d===null?d=e(a,c):!r(v)&&d!==null&&(d(),d=null)),v)),o(c,()=>{h=!0,r(c.curve)&&(d=e(a,c))},()=>{h=!1,d!==null&&(d(),d=null)})},Ja=(e,n,t,r,o)=>(s,{curve:l,oversample:a,...i})=>{const c=s.createWaveShaper(),u=s.createWaveShaper();Y(c,i),Y(u,i);const d=t(s,{...i,gain:1}),h=t(s,{...i,gain:-1}),p=t(s,{...i,gain:1}),f=t(s,{...i,gain:-1});let m=null,v=!1,N=null;const E={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(g){d.channelCount=g,h.channelCount=g,c.channelCount=g,p.channelCount=g,u.channelCount=g,f.channelCount=g},get channelCountMode(){return c.channelCountMode},set channelCountMode(g){d.channelCountMode=g,h.channelCountMode=g,c.channelCountMode=g,p.channelCountMode=g,u.channelCountMode=g,f.channelCountMode=g},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(g){d.channelInterpretation=g,h.channelInterpretation=g,c.channelInterpretation=g,p.channelInterpretation=g,u.channelInterpretation=g,f.channelInterpretation=g},get context(){return c.context},get curve(){return N},set curve(g){if(g!==null&&g.length<2)throw n();if(g===null)c.curve=g,u.curve=g;else{const C=g.length,_=new Float32Array(C+2-C%2),y=new Float32Array(C+2-C%2);_[0]=g[0],y[0]=-g[C-1];const M=Math.ceil((C+1)/2),w=(C+1)/2-1;for(let I=1;I<M;I+=1){const b=I/M*w,A=Math.floor(b),R=Math.ceil(b);_[I]=A===R?g[A]:(1-(b-A))*g[A]+(1-(R-b))*g[R],y[I]=A===R?-g[C-1-A]:-((1-(b-A))*g[C-1-A])-(1-(R-b))*g[C-1-R]}_[M]=C%2===1?g[M-1]:(g[M-2]+g[M-1])/2,c.curve=_,u.curve=y}N=g,v&&(r(N)&&m===null?m=e(s,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(g){c.oversample=g,u.oversample=g},addEventListener(...g){return d.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return d.dispatchEvent(g[0])},removeEventListener(...g){return d.removeEventListener(g[0],g[1],g[2])}};l!==null&&(E.curve=l instanceof Float32Array?l:new Float32Array(l)),a!==E.oversample&&(E.oversample=a);const T=()=>{d.connect(c).connect(p),d.connect(h).connect(u).connect(f).connect(p),v=!0,r(N)&&(m=e(s,d))},S=()=>{d.disconnect(c),c.disconnect(p),d.disconnect(h),h.disconnect(u),u.disconnect(f),f.disconnect(p),v=!1,m!==null&&(m(),m=null)};return o(Ue(E,p),T,S)},oe=()=>new DOMException("","NotSupportedError"),ec={numberOfChannels:1},tc=(e,n,t,r,o)=>class extends e{constructor(l,a,i){let c;if(typeof l=="number"&&a!==void 0&&i!==void 0)c={length:a,numberOfChannels:l,sampleRate:i};else if(typeof l=="object")c=l;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:d,sampleRate:h}={...ec,...c},p=r(d,u,h);n(He,()=>He(p))||p.addEventListener("statechange",(()=>{let f=0;const m=v=>{this._state==="running"&&(f>0?(p.removeEventListener("statechange",m),v.stopImmediatePropagation(),this._waitForThePromiseToSettle(v)):f+=1)};return m})()),super(p,d),this._length=u,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,os(this)}))}_waitForThePromiseToSettle(l){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(l):setTimeout(()=>this._waitForThePromiseToSettle(l))}},nc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},rc=(e,n,t,r,o,s,l)=>class extends e{constructor(i,c){const u=o(i),d={...nc,...c},h=t(u,d),p=s(u),f=p?r():null,m=i.sampleRate/2;super(i,!1,h,f),this._detune=n(this,p,h.detune,153600,-153600),this._frequency=n(this,p,h.frequency,m,-m),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(i){const c=typeof i=="function"?l(this,i):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?i:u}get type(){return this._nativeOscillatorNode.type}set type(i){this._nativeOscillatorNode.type=i,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(i){this._nativeOscillatorNode.setPeriodicWave(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=i)}start(i=0){if(this._nativeOscillatorNode.start(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=i),this.context.state!=="closed"){We(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),me(this)&&Je(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(i=0){this._nativeOscillatorNode.stop(i),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=i)}},oc=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null,i=null;const c=async(u,d)=>{let h=t(u);const p=Q(h,d);if(!p){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:l===null?void 0:l,type:h.type};h=n(d,f),a!==null&&h.start(a),i!==null&&h.stop(i)}return s.set(d,h),p?(await e(d,u.detune,h.detune),await e(d,u.frequency,h.frequency)):(await r(d,u.detune,h.detune),await r(d,u.frequency,h.frequency)),await o(u,d,h),h};return{set periodicWave(u){l=u},set start(u){a=u},set stop(u){i=u},render(u,d){const h=s.get(d);return h!==void 0?Promise.resolve(h):c(u,d)}}},sc={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},ac=(e,n,t,r,o,s,l)=>class extends e{constructor(i,c){const u=o(i),d={...sc,...c},h=t(u,d),p=s(u),f=p?r():null;super(i,!1,h,f),this._nativePannerNode=h,this._orientationX=n(this,p,h.orientationX,J,ne),this._orientationY=n(this,p,h.orientationY,J,ne),this._orientationZ=n(this,p,h.orientationZ,J,ne),this._positionX=n(this,p,h.positionX,J,ne),this._positionY=n(this,p,h.positionY,J,ne),this._positionZ=n(this,p,h.positionZ,J,ne),l(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(i){this._nativePannerNode.coneInnerAngle=i}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(i){this._nativePannerNode.coneOuterAngle=i}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(i){this._nativePannerNode.coneOuterGain=i}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(i){this._nativePannerNode.distanceModel=i}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(i){this._nativePannerNode.maxDistance=i}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(i){this._nativePannerNode.panningModel=i}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(i){this._nativePannerNode.refDistance=i}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(i){this._nativePannerNode.rolloffFactor=i}},cc=(e,n,t,r,o,s,l,a,i,c)=>()=>{const u=new WeakMap;let d=null;const h=async(p,f)=>{let m=null,v=s(p);const N={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},E={...N,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},T=Q(v,f);if("bufferSize"in v)m=r(f,{...N,gain:1});else if(!T){const S={...E,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=o(f,S)}if(u.set(f,m===null?v:m),m!==null){if(d===null){if(l===null)throw new Error("Missing the native OfflineAudioContext constructor.");const I=new l(6,p.context.length,f.sampleRate),b=n(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});b.connect(I.destination),d=(async()=>{const A=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(R,k)=>{const O=t(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:k===0?1:0});return await a(I,R,O.offset),O}));for(let R=0;R<6;R+=1)A[R].connect(b,0,R),A[R].start(0);return c(I)})()}const S=await d,g=r(f,{...N,gain:1});await i(p,f,g);const C=[];for(let I=0;I<S.numberOfChannels;I+=1)C.push(S.getChannelData(I));let _=[C[0][0],C[1][0],C[2][0]],y=[C[3][0],C[4][0],C[5][0]],M=r(f,{...N,gain:1}),w=o(f,{...E,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]});g.connect(M).connect(w.inputs[0]),w.connect(m);for(let I=128;I<S.length;I+=128){const b=[C[0][I],C[1][I],C[2][I]],A=[C[3][I],C[4][I],C[5][I]];if(b.some((R,k)=>R!==_[k])||A.some((R,k)=>R!==y[k])){_=b,y=A;const R=I/f.sampleRate;M.gain.setValueAtTime(0,R),M=r(f,{...N,gain:0}),w=o(f,{...E,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),M.gain.setValueAtTime(1,R),g.connect(M).connect(w.inputs[0]),w.connect(m)}}return m}return T?(await e(f,p.orientationX,v.orientationX),await e(f,p.orientationY,v.orientationY),await e(f,p.orientationZ,v.orientationZ),await e(f,p.positionX,v.positionX),await e(f,p.positionY,v.positionY),await e(f,p.positionZ,v.positionZ)):(await a(f,p.orientationX,v.orientationX),await a(f,p.orientationY,v.orientationY),await a(f,p.orientationZ,v.orientationZ),await a(f,p.positionX,v.positionX),await a(f,p.positionY,v.positionY),await a(f,p.positionZ,v.positionZ)),qe(v)?await i(p,f,v.inputs[0]):await i(p,f,v),v};return{render(p,f){const m=u.get(f);return m!==void 0?Promise.resolve(m):h(p,f)}}},ic={disableNormalization:!1},lc=(e,n,t,r)=>class Tr{constructor(s,l){const a=n(s),i=r({...ic,...l}),c=e(a,i);return t.add(c),c}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Tr.prototype||t.has(s)}},uc=(e,n)=>(t,r,o)=>(e(r).replay(o),n(r,t,o)),dc=(e,n,t)=>async(r,o,s)=>{const l=e(r);await Promise.all(l.activeInputs.map((a,i)=>Array.from(a).map(async([c,u])=>{const h=await n(c).render(c,o),p=r.context.destination;!t(c)&&(r!==p||!t(r))&&h.connect(s,u,i)})).reduce((a,i)=>[...a,...i],[]))},hc=(e,n,t)=>async(r,o,s)=>{const l=n(r);await Promise.all(Array.from(l.activeInputs).map(async([a,i])=>{const u=await e(a).render(a,o);t(a)||u.connect(s,i)}))},fc=(e,n,t,r)=>o=>e(He,()=>He(o))?Promise.resolve(e(r,r)).then(s=>{if(!s){const l=t(o,512,0,1);o.oncomplete=()=>{l.onaudioprocess=null,l.disconnect()},l.onaudioprocess=()=>o.currentTime,l.connect(o.destination)}return o.startRendering()}):new Promise(s=>{const l=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=a=>{l.disconnect(),s(a.renderedBuffer)},l.connect(o.destination),o.startRendering()}),pc=e=>(n,t)=>e.set(n,t),mc=(e,n,t,r,o,s,l,a)=>(i,c)=>t(i).render(i,c).then(()=>Promise.all(Array.from(r(c)).map(u=>t(u).render(u,c)))).then(()=>o(c)).then(u=>(typeof u.copyFromChannel!="function"?(l(u),an(u)):n(s,()=>s(u))||a(u),e.add(u),u)),gc={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},yc=(e,n,t,r,o,s)=>class extends e{constructor(a,i){const c=o(a),u={...gc,...i},d=t(c,u),h=s(c),p=h?r():null;super(a,!1,d,p),this._pan=n(this,h,d.pan)}get pan(){return this._pan}},vc=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,i)=>{let c=t(a);const u=Q(c,i);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=n(i,d)}return s.set(i,c),u?await e(i,a.pan,c.pan):await r(i,a.pan,c.pan),qe(c)?await o(a,i,c.inputs[0]):await o(a,i,c),c};return{render(a,i){const c=s.get(i);return c!==void 0?Promise.resolve(c):l(a,i)}}},Nc=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0},wc=(e,n)=>async()=>{if(e===null)return!0;if(n===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new n(1,128,44100),o=URL.createObjectURL(t);let s=!1,l=!1;try{await r.audioWorklet.addModule(o);const a=new e(r,"a",{numberOfOutputs:0}),i=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>l=!0,i.connect(a),i.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(o)}return s&&!l},Cc=(e,n)=>()=>{if(n===null)return Promise.resolve(!1);const t=new n(1,1,44100),r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(o=>{t.oncomplete=()=>{r.disconnect(),o(t.currentTime!==0)},t.startRendering()})},_c={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},bc=(e,n,t,r,o,s,l)=>class extends e{constructor(i,c){const u=o(i),d={..._c,...c},h=t(u,d),f=s(u)?r():null;super(i,!0,h,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,l(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(i){if(i===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(i.length<2)throw n();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=i}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(i){this._nativeWaveShaperNode.oversample=i}},Tc=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=e(l,c)}return r.set(l,a),qe(a)?await t(s,l,a.inputs[0]):await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},Ic=()=>typeof window>"u"?null:window,Ec=(e,n)=>t=>{t.copyFromChannel=(r,o,s=0)=>{const l=e(s),a=e(o);if(a>=t.numberOfChannels)throw n();const i=t.length,c=t.getChannelData(a),u=r.length;for(let d=l<0?-l:0;d+l<i&&d<u;d+=1)r[d]=c[d+l]},t.copyToChannel=(r,o,s=0)=>{const l=e(s),a=e(o);if(a>=t.numberOfChannels)throw n();const i=t.length,c=t.getChannelData(a),u=r.length;for(let d=l<0?-l:0;d+l<i&&d<u;d+=1)c[d+l]=r[d]}},Sc=e=>n=>{n.copyFromChannel=(t=>(r,o,s=0)=>{const l=e(s),a=e(o);if(l<n.length)return t.call(n,r,a,l)})(n.copyFromChannel),n.copyToChannel=(t=>(r,o,s=0)=>{const l=e(s),a=e(o);if(l<n.length)return t.call(n,r,a,l)})(n.copyToChannel)},Mc=e=>(n,t)=>{const r=t.createBuffer(1,1,44100);n.buffer===null&&(n.buffer=r),e(n,"buffer",o=>()=>{const s=o.call(n);return s===r?null:s},o=>s=>o.call(n,s===null?r:s))},Rc=(e,n)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const o=t.createBufferSource();n(r,()=>{const a=r.numberOfInputs;for(let i=0;i<a;i+=1)o.connect(r,0,i)},()=>o.disconnect(r))},Ir=(e,n,t)=>e.copyFromChannel===void 0?e.getChannelData(t)[0]:(e.copyFromChannel(n,t),n[0]),Er=e=>{if(e===null)return!1;const n=e.length;return n%2!==0?e[Math.floor(n/2)]!==0:e[n/2-1]+e[n/2]!==0},nt=(e,n,t,r)=>{let o=e;for(;!o.hasOwnProperty(n);)o=Object.getPrototypeOf(o);const{get:s,set:l}=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(e,n,{get:t(s),set:r(l)})},Ac=e=>({...e,channelCount:e.numberOfOutputs}),Oc=e=>{const{imag:n,real:t}=e;return n===void 0?t===void 0?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(t,()=>0),real:t}:t===void 0?{...e,imag:n,real:Array.from(n,()=>0)}:{...e,imag:n,real:t}},Sr=(e,n,t)=>{try{e.setValueAtTime(n,t)}catch(r){if(r.code!==9)throw r;Sr(e,n,t+1e-7)}},Fc=e=>{const n=e.createBufferSource();n.start();try{n.start()}catch{return!0}return!1},Dc=e=>{const n=e.createBufferSource(),t=e.createBuffer(1,1,44100);n.buffer=t;try{n.start(0,1)}catch{return!1}return!0},kc=e=>{const n=e.createBufferSource();n.start();try{n.stop()}catch{return!1}return!0},fn=e=>{const n=e.createOscillator();try{n.start(-1)}catch(t){return t instanceof RangeError}return!1},Mr=e=>{const n=e.createBuffer(1,1,44100),t=e.createBufferSource();t.buffer=n,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},pn=e=>{const n=e.createOscillator();try{n.stop(-1)}catch(t){return t instanceof RangeError}return!1},Pc=e=>{e.start=(n=>(t=0,r=0,o)=>{const s=e.buffer,l=s===null?r:Math.min(s.duration,r);s!==null&&l>s.duration-.5/e.context.sampleRate?n.call(e,t,0,0):n.call(e,t,l,o)})(e.start)},Rr=(e,n)=>{const t=n.createGain();e.connect(t);const r=(o=>()=>{o.call(e,t),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),Ue(e,t),e.stop=(o=>{let s=!1;return(l=0)=>{if(s)try{o.call(e,l)}catch{t.gain.setValueAtTime(0,l)}else o.call(e,l),s=!0}})(e.stop)},rt=(e,n)=>t=>{const r={value:e};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof n=="function"?n.call(e,t):n.handleEvent.call(e,t)},Lc=Lo(Me),Bc=xo(Me),Wc=zs(_t),Ar=new WeakMap,Vc=ca(Ar),ie=bs(new Map,new WeakMap),he=Ic(),Or=Sa(ie,Se),mn=aa(re),H=dc(re,mn,Ee),qc=zo(Or,j,H),G=la(hr),_e=Za(he),Z=_a(_e),Fr=new WeakMap,Dr=ea(rt),It=Oa(he),kr=va(It),Pr=Na(he),Uc=wa(he),Zt=Da(he),K=gs(Bo(ir),Uo(Lc,Bc,yt,Wc,vt,re,Vc,Qe,j,Me,me,Ee,dt),ie,ya(xt,vt,re,j,Ye,me),Se,bt,oe,xs(yt,xt,re,j,Ye,G,me,Z),$s(Fr,re,Ce),Dr,G,kr,Pr,Uc,Z,Zt),xc=Zo(K,qc,Se,Or,G,Z),gn=new WeakSet,Xn=Ma(he),Lr=Ps(new Uint32Array(1)),yn=Ec(Lr,Se),vn=Sc(Lr),jc=$o(gn,ie,oe,Xn,_e,Nc(Xn),yn,vn),Et=jo(ce),Br=hc(mn,et,Ee),ge=As(Br),ot=Aa(Et,ie,Fc,Dc,kc,fn,Mr,pn,Pc,Mc(nt),Rr),ye=uc(ia(et),Br),Xc=Ko(ge,ot,j,ye,H),fe=ys(Wo(ur),Fr,dr,vs,Ao,Oo,Fo,Do,ko,Vt,ar,It,Sr),Zc=Ho(K,Xc,fe,ee,ot,G,Z,rt),zc=ss(K,as,Se,ee,Fa(ce,nt),G,Z,H),Gc=_s(ge,_r,j,ye,H),Re=pc(Ar),$c=Cs(K,fe,Gc,bt,_r,G,Z,Re),xe=Ia(Me,Pr),Yc=Rc(ee,xe),je=Pa(It,Yc),Hc=Es(je,j,H),Kc=Is(K,Hc,je,G,Z),Qc=Rs(hn,j,H),Jc=Ms(K,Qc,hn,G,Z,Ac),ei=Wa(Et,ot,ce,xe),St=Ba(Et,ie,ei,fn,pn),ti=ks(ge,St,j,ye,H),ni=Ds(K,fe,ti,St,G,Z,rt),Wr=Va(oe,nt),ri=Ws(Wr,j,H),oi=Bs(K,ri,Wr,G,Z,Re),si=Zs(ge,br,j,ye,H),ai=Xs(K,fe,si,br,G,Z,Re),Vr=qa(oe),ci=Ks(ge,Vr,j,ye,H),ii=Hs(K,fe,ci,Vr,oe,G,Z,Re),li=sa(ge,ce,j,ye,H),ui=oa(K,fe,li,ce,G,Z),di=Xa(bt,ee,Tt,oe),Nn=fc(ie,ce,Tt,Cc(ce,_e)),hi=ga(ot,j,_e,H,Nn),fi=Ua(di),pi=pa(K,fi,hi,G,Z,Re),mi=cs(fe,je,St,Tt,oe,Ir,Z,nt),qr=new WeakMap,gi=Ta(zc,mi,Dr,Z,qr,rt),Ur=za(Et,ie,fn,Mr,pn,Rr),yi=oc(ge,Ur,j,ye,H),vi=rc(K,fe,Ur,yi,G,Z,rt),xr=Os(ot),Ni=Ja(xr,ee,ce,Er,xe),Mt=Qa(xr,ee,Ni,Er,xe,It,nt),wi=$a(yt,ee,je,ce,Tt,Mt,oe,vt,Ir,xe),jr=Ga(wi),Ci=cc(ge,je,St,ce,jr,j,_e,ye,H,Nn),_i=ac(K,fe,jr,Ci,G,Z,Re),bi=Ya(Se),Ti=lc(bi,G,new WeakSet,Oc),Ii=Ka(je,hn,ce,Mt,oe,xe),Xr=Ha(Ii,oe),Ei=vc(ge,Xr,j,ye,H),Si=yc(K,fe,Xr,Ei,G,Z),Mi=Tc(Mt,j,H),Ri=bc(K,ee,Mt,Mi,G,Z,Re),Ai=ba(he),Oi=ta(he),Fi=new WeakMap,Di=ua(Fi,_e),ki=Ai?qo(ie,oe,Js(he),Oi,na(Po),G,Di,Z,Zt,new WeakMap,new WeakMap,wc(Zt,_e),he):void 0,Pi=Ca(kr,Z),Li=Us(gn,ie,qs,Qs,new WeakSet,G,Pi,mt,He,yn,vn),Bi=Ns(ki,xc,jc,Zc,$c,Kc,Jc,ni,oi,Li,ai,ii,ui,pi,gi,vi,_i,Ti,Si,Ri),Wi=da(qr),Vi=Vs(oe,_e),qi=mc(gn,ie,mn,Wi,Nn,mt,yn,vn),Ui=tc(Bi,ie,ee,Vi,qi),Zn=(e,n,t)=>{const r=new Ui(e.numberOfChannels,Math.round(t*e.sampleRate),e.sampleRate),o=r.createBiquadFilter(),s=r.createBufferSource();return o.frequency.value=240,o.type="lowpass",s.buffer=e,s.connect(o).connect(r.destination),s.start(0,n,t),r.startRendering().then(l=>{const a=l.getChannelData(0),i=l.sampleRate;return{channelData:a,sampleRate:i}})},xi=Eo({analyze:({call:e})=>async(...n)=>{var t;const[r,o,s]=n,l=typeof o=="number"?o:0,a=typeof s=="number"?s:r.duration-l,{channelData:i,sampleRate:c}=await Zn(r,l,a),u=typeof o=="object"?o:typeof s=="object"?s:(t=n[3])!==null&&t!==void 0?t:null;return e("analyze",{channelData:i,sampleRate:c,...u===null?u:{tempoSettings:u}},[i.buffer])},guess:({call:e})=>async(...n)=>{var t;const[r,o,s]=n,l=typeof o=="number"?o:0,a=typeof s=="number"?s:r.duration-l,{channelData:i,sampleRate:c}=await Zn(r,l,a),u=typeof o=="object"?o:typeof s=="object"?s:(t=n[3])!==null&&t!==void 0?t:null;return e("guess",{channelData:i,sampleRate:c,...u===null?u:{tempoSettings:u}},[i.buffer])}}),ji=e=>{const n=new Worker(e);return xi(n)},Xi=(e,n)=>{let t=null;return()=>{if(t!==null)return t;const r=new Blob([n],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return t=e(o),setTimeout(()=>URL.revokeObjectURL(o)),t}},Zi=`(()=>{var e={455(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=a(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:c}})=>{const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const c=new Map,u=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(c);return c.set(o,()=>{n(),t.close(),c.delete(o)}),{result:o}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=u(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},h=(e,t,r)=>{const n=e.length,o=[];let s=!1;for(let a=0;a<n;a+=1)e[a]>t?s=!0:s&&(s=!1,o.push(a-1),a+=r/4-1);return s&&o.push(n-1),o},d=(e,t,r)=>{const n=(e=>{let t=0;const r=e.length;for(let n=0;n<r;n+=1)e[n]>t&&(t=e[n]);return t})(e),o=.3*n;let s=[],a=n-.05*n;if(n>.25)for(;s.length<30&&a>=o;)s=h(e,a,t),a-=.05*n;const i=(e=>{const t=[];return e.forEach((r,n)=>{const o=Math.min(e.length-n,10);for(let s=1;s<o;s+=1){const o=e[n+s]-r;t.some(e=>e.interval===o&&(e.peaks.push(r),!0))||t.push({interval:o,peaks:[r]})}}),t})(s),c=((e,t,r={})=>{var n,o;const s=Math.max(0,null!==(n=r.maxTempo)&&void 0!==n?n:180),a=Math.max(0,null!==(o=r.minTempo)&&void 0!==o?o:90),i=[];return e.forEach(e=>{let r=60/(e.interval/t);for(;r<a;)r*=2;for(;r>s;)r/=2;if(r<a)return;let n=!1,o=e.peaks.length;i.forEach(t=>{if(t.tempo===r&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],n=!0),t.tempo>r-.5&&t.tempo<r+.5){const n=2*Math.abs(t.tempo-r);o+=(1-n)*t.peaks.length,t.score+=(1-n)*e.peaks.length}}),n||i.push({peaks:e.peaks,score:o,tempo:r})}),i})(i,t,r);return c.sort((e,t)=>t.score-e.score),c},p=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo},f=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:o,tempo:s}=n[0],a=Math.round(s),i=60/a;o.sort((e,t)=>e-t);let c=o[0]/t;for(;c>i;)c-=i;return{bpm:a,offset:c,tempo:s}};l(self,{analyze:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:p(e,t,r)}),guess:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:f(e,t,r)})})})()})();`,zi=Xi(ji,Zi),Gi=(...e)=>zi().guess(...e),kt=new Set,Pt=new Set;let it=null;function st(e){return new Promise((n,t)=>{const r=new(window.AudioContext||window.webkitAudioContext),o=new FileReader;o.onload=()=>{const s=o.result;if(!(s instanceof ArrayBuffer)){t(new Error("Failed to read file"));return}r.decodeAudioData(s).then(l=>{r.close(),n(l)}).catch(l=>{r.close(),t(l)})},o.onerror=()=>t(o.error),o.readAsArrayBuffer(e)})}function $i(e){e.bpm!=null||kt.has(e.id)||(kt.add(e.id),st(e.file).then(n=>Gi(n,{minTempo:60,maxTempo:200})).then(({bpm:n})=>{Number.isFinite(n)&&n>=1&&Le(e.id,{bpm:Math.round(n)})}).catch(()=>{}).finally(()=>kt.delete(e.id)))}function zn(e){return new Promise((n,t)=>{if(document.querySelector(`script[src="${e}"]`)){n();return}const r=document.createElement("script");r.src=e,r.onload=()=>n(),r.onerror=()=>t(new Error(`Failed to load ${e}`)),document.head.appendChild(r)})}async function wn(){if(it)return it;const e="https://cdn.jsdelivr.net/npm/essentia.js@0.1.3/dist";await zn(`${e}/essentia-wasm.web.js`),await zn(`${e}/essentia.js-core.js`);const n=await window.EssentiaWASM();return it=new window.Essentia(n),it}function Yi(e){e.key!=null&&e.key!==""||Pt.has(e.id)||(Pt.add(e.id),wn().then(n=>st(e.file).then(t=>({essentia:n,buf:t}))).then(({essentia:n,buf:t})=>{const r=n.audioBufferToMonoSignal(t),o=n.arrayToVector(r),s=n.KeyExtractor(o,!0,4096,4096,12,3500,60,25,.2,"bgate",t.sampleRate),l=[s.key,s.scale].filter(Boolean).join(" ")||null;l&&Le(e.id,{key:l})}).catch(()=>{Le(e.id,{key:""})}).finally(()=>Pt.delete(e.id)))}const lt=4096,Zr=2048;function Hi(e,n,t){const r=[];for(let o=0;o+lt<=n.length;o+=Zr){const s=n.slice(o,o+lt),l=e.arrayToVector(s),a=e.Windowing(l,!1,lt,"hann",0,!0).frame,i=e.Spectrum(a,lt).spectrum,c=e.SpectralPeaks(i,0,4500,60,80,"frequency",t),u=e.HPCP(c.frequencies,c.magnitudes,!0,500,0,4500,!1,80,!1,"unitMax",440,t,12,"squaredCosine",1).hpcp;r.push(e.vectorToArray(u))}return r}function Ki(e,n,t){const r=e.sampleRate,o=Math.max(0,Math.floor(n*r)),s=Math.min(e.length,Math.ceil(t*r));if(s-o<r*.5)return Promise.resolve(null);const a=e.getChannelData(0).slice(o,s);if(e.numberOfChannels===2){const i=e.getChannelData(1);for(let c=0;c<a.length;c++)a[c]=(a[c]+i[o+c])/2}return wn().then(i=>{const c=i.arrayToVector(a),u=i.KeyExtractor(c,!0,4096,4096,12,3500,60,25,.2,"bgate",r),d=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];let h=u.key!=null?String(u.key).trim():"";const p=(u.scale!=null?String(u.scale).trim():"")||"";h==="NaN"&&(h="");const f=Number(h);return h!==""&&Number.isInteger(f)&&f>=0&&f<=11&&(h=d[f]),[h,p==="NaN"?"":p].filter(Boolean).join(" ")||null||null}).catch(()=>null)}function Qi(e,n,t){const r=e.sampleRate,o=Math.max(0,Math.floor(n*r)),s=Math.min(e.length,Math.ceil(t*r));if(s-o<r*1.5)return Promise.resolve(null);const a=e.getChannelData(0).slice(o,s);if(e.numberOfChannels===2){const i=e.getChannelData(1);for(let c=0;c<a.length;c++)a[c]=(a[c]+i[o+c])/2}return wn().then(i=>{const c=Hi(i,a,r);if(c.length===0)return null;let u=c;if(i.module&&typeof i.module.VectorVectorFloat<"u")try{const m=new i.module.VectorVectorFloat;for(let v=0;v<c.length;v++)m.push_back(i.arrayToVector(c[v]));u=m}catch{}const h=i.ChordsDetection(u,Zr,r,2).chords;if(!h)return null;let p=null;if(Array.isArray(h)&&h.length>0)p=h[h.length-1];else if(typeof h.size=="function"&&h.size()>0)try{const m=i.vectorToArray?i.vectorToArray(h):null;p=m&&m.length?m[m.length-1]:h.get?h.get(h.size()-1):null}catch{p=h.get?h.get(h.size()-1):null}const f=p!=null?String(p).trim():"";return f!==""&&f!=="NaN"?f:null}).catch(()=>null)}let Pe=null,zt=()=>{},zr=()=>{},Gr=()=>{},$r=()=>{};const ut=new Set;function Ji(e){if(e.duration!=null||ut.has(e.id))return;ut.add(e.id);const n=URL.createObjectURL(e.file),t=new Audio;t.addEventListener("loadedmetadata",()=>{const r=t.duration;Number.isFinite(r)&&Le(e.id,{duration:r}),URL.revokeObjectURL(n),ut.delete(e.id)}),t.addEventListener("error",()=>{URL.revokeObjectURL(n),ut.delete(e.id)}),t.src=n}function el(e,n={}){Pe=e,n.onPlayRequest&&(zt=n.onPlayRequest),n.onPauseRequest&&(zr=n.onPauseRequest),n.onStopRequest&&(Gr=n.onStopRequest),n.onSeekRequest&&($r=n.onSeekRequest),no(()=>{Gn()}),ro(tl),Gn()}function tl(){if(!Pe)return;const e=Pe.querySelector(".audio-list tbody tr.playing");if(!e)return;const n=e.querySelector(".position-time"),t=e.querySelector(".progress-bar-fill");if(!n||!t)return;const r=se(),o=ae();if(o===null||o>=r.length)return;const l=r[o].duration;if(l==null||l<=0)return;const a=Math.min(Jn(),l);n.textContent=`${ue(a)} / ${ue(l)}`,t.style.width=`${a/l*100}%`}function Gn(){if(!Pe)return;const e=se(),n=ae(),t=Jn(),r=nn();if(Pe.innerHTML="",e.length===0)return;const o=on(e),s=document.createElement("table");s.className="audio-list",s.innerHTML=`
    <thead>
      <tr>
        <th class="col-grip"></th>
        <th class="col-name">ファイル名</th>
        <th class="col-start">再生開始</th>
        <th class="col-duration">素材の長さ</th>
        <th class="col-bpm">BPM</th>
        <th class="col-key">Key</th>
        <th class="col-loop">ループ</th>
        <th class="col-max">最大再生時間</th>
        <th class="col-controls">再生</th>
        <th class="col-position">再生位置</th>
        <th class="col-playing"></th>
      </tr>
    </thead>
    <tbody></tbody>
  `;const l=s.querySelector("tbody");e.forEach((a,i)=>{a.duration===null&&Ji(a),a.bpm===null&&$i(a),a.key===null&&Yi(a);const c=document.createElement("tr");c.dataset.index=String(i),c.draggable=!0,n===i&&c.classList.add("playing");const u=document.createElement("td");u.className="col-grip",u.innerHTML='<span class="grip" aria-label="並び替え">⋮⋮</span>',u.addEventListener("mousedown",w=>w.stopPropagation());const d=document.createElement("td");d.className="col-name",d.textContent=a.name;const h=document.createElement("td");h.className="col-start",h.textContent=ue(o[i]);const p=document.createElement("td");p.className="col-duration",p.textContent=a.duration!=null?ue(a.duration):"…";const f=document.createElement("td");f.className="col-bpm",f.textContent=a.bpm!=null?String(a.bpm):"…";const m=document.createElement("td");m.className="col-key",m.textContent=a.key!=null&&a.key!==""?a.key:"—";const v=document.createElement("td");v.className="col-loop";const N=document.createElement("button");N.type="button",N.className="loop-btn",N.setAttribute("aria-label","ループ"),N.innerHTML=a.loop?'<span class="loop-icon loop-on" title="ループON">↻</span>':'<span class="loop-icon loop-off" title="ループOFF">↻</span>',N.addEventListener("click",w=>{w.stopPropagation(),Le(a.id,{loop:!a.loop})}),v.appendChild(N);const E=document.createElement("td");if(E.className="col-max",a.loop){const w=document.createElement("input");w.type="text",w.placeholder="0:00",w.value=a.maxLoopSeconds!=null?ue(a.maxLoopSeconds):"",w.className="max-time-input",w.setAttribute("inputmode","numeric"),w.addEventListener("click",I=>I.stopPropagation()),w.addEventListener("change",()=>{const I=nr(w.value.trim());Le(a.id,{maxLoopSeconds:I})}),E.appendChild(w)}const T=document.createElement("td");T.className="col-controls";const S=n===i,g=document.createElement("button");g.type="button",g.className="control-btn control-play"+(S&&r?" is-active":""),g.setAttribute("aria-label","再生"),g.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>',g.addEventListener("click",w=>{w.stopPropagation(),zt(i)});const C=document.createElement("button");C.type="button",C.className="control-btn control-pause"+(S&&!r?" is-active":""),C.setAttribute("aria-label","ポーズ"),C.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/></svg>',C.addEventListener("click",w=>{w.stopPropagation(),zr()});const _=document.createElement("button");_.type="button",_.className="control-btn control-stop",_.setAttribute("aria-label","停止"),_.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M6 6h12v12H6z"/></svg>',_.addEventListener("click",w=>{w.stopPropagation(),Gr()}),T.append(g,C,_);const y=document.createElement("td");if(y.className="col-position",n===i&&a.duration!=null&&a.duration>0){const w=a.duration,I=Math.min(t,w),b=I/w*100,A=document.createElement("span");A.className="position-time",A.textContent=`${ue(I)} / ${ue(w)}`;const R=document.createElement("div");R.className="progress-bar",R.setAttribute("role","slider"),R.setAttribute("aria-label","再生位置をクリックでシーク"),R.setAttribute("aria-valuenow",String(I)),R.setAttribute("aria-valuemin","0"),R.setAttribute("aria-valuemax",String(w));const k=document.createElement("div");k.className="progress-bar-fill",k.style.width=`${b}%`,R.appendChild(k),R.addEventListener("click",O=>{O.stopPropagation();const D=R.getBoundingClientRect(),V=O.clientX-D.left,L=Math.max(0,Math.min(1,V/D.width))*w;$r(L)}),y.append(A,R)}else y.textContent="—";const M=document.createElement("td");M.className="col-playing",n===i&&(M.innerHTML='<span class="playing-mark">▶</span>'),c.append(u,d,h,p,f,m,v,E,T,y,M),c.addEventListener("click",w=>{(w.target.closest("button")||w.target.closest("input")||w.target.closest(".col-position"))===null&&zt(i)}),c.addEventListener("dragstart",w=>{w.dataTransfer.setData("text/plain",String(i)),w.dataTransfer.effectAllowed="move",c.classList.add("dragging")}),c.addEventListener("dragend",()=>c.classList.remove("dragging")),c.addEventListener("dragover",w=>{w.preventDefault(),w.dataTransfer.dropEffect="move";const I=parseInt(w.dataTransfer.getData("text/plain"),10);Number.isNaN(I)||I===i||(l.querySelectorAll("tr").forEach(b=>b.classList.remove("drop-target")),c.classList.add("drop-target"))}),c.addEventListener("dragleave",()=>c.classList.remove("drop-target")),c.addEventListener("drop",w=>{w.preventDefault(),c.classList.remove("drop-target");const I=parseInt(w.dataTransfer.getData("text/plain"),10);Number.isNaN(I)||I===i||ho(I,i)}),l.appendChild(c)}),Pe.appendChild(s)}const we=new Audio;let Xe=null,Yr=()=>{};function nl(e){Yr=e}function Gt(e){if(Xe===e){we.currentTime=0,we.play().catch(()=>{});return}rl(),Xe=e,we.src=e,we.currentTime=0,we.play().catch(()=>{})}function Cn(){we.pause()}function at(){return we}function rl(){Xe&&(URL.revokeObjectURL(Xe),Xe=null)}we.addEventListener("ended",()=>{Yr()});let be=null,Nt=null,Te=null;const ol=256;function Hr(e){if(!Nt)try{const n=new(window.AudioContext||window.webkitAudioContext),t=n.createMediaElementSource(e),r=n.createAnalyser();r.fftSize=ol,r.smoothingTimeConstant=.7,r.minDecibels=-60,r.maxDecibels=0,t.connect(r),r.connect(n.destination),be=n,Nt=r,Te=new Float32Array(r.frequencyBinCount)}catch{}}const ht=-60;function Lt(e,n,t){let r=ht;for(let o=n;o<t;o++){const s=e[o];Number.isFinite(s)&&s>r&&(r=s)}return r}function sl(){var r;if(!Nt||!Te)return{low:ht,mid:ht,hi:ht};(be==null?void 0:be.state)==="suspended"&&((r=be.resume)==null||r.call(be)),Nt.getFloatFrequencyData(Te);const e=Te.length,n=Math.min(3,e),t=Math.min(Math.floor(e*.4),e);return{low:Lt(Te,0,n),mid:Lt(Te,n,t),hi:Lt(Te,t,e)}}const Ie=100,al=10,$n=new Array(Ie).fill(0),Yn=new Array(Ie).fill(0),Hn=new Array(Ie).fill(0);let Fe=0,le=null;const cl="#2e7d32",il="#1565c0",ll="#c62828",wt=200,$t=60,Ct=34,Ze=-60,Yt=0,ul=[{db:0,label:"0 dB"},{db:-6,label:"-6 dB"},{db:-12,label:"-12 dB"},{db:-18,label:"-18 dB"},{db:-24,label:"-24 dB"},{db:-48,label:"-48 dB"},{db:-60,label:"-60 dB"}];function Kr(e){const n=Number(e);return!Number.isFinite(n)||n<=Ze?0:n>=Yt?1:(n-Ze)/(Yt-Ze)}function dl(e,n){e.save(),e.strokeStyle="rgba(255,255,255,0.25)",e.fillStyle="rgba(255,255,255,0.7)",e.font="10px system-ui, sans-serif",e.textAlign="right",e.textBaseline="middle";for(const{db:t,label:r}of ul){const s=(1-Kr(t))*n;e.fillText(r,Ct-4,s),e.beginPath(),e.moveTo(Ct,s),e.lineTo(wt,s),e.stroke()}e.restore()}function Bt(e,n,t,r,o,s){const l=r/(Ie-1);e.strokeStyle=t,e.lineWidth=1.5,e.lineJoin="round",e.lineCap="round",e.beginPath();for(let a=0;a<Ie;a++){const i=(Fe+1+a)%Ie,c=Kr(n[i]),u=s+a*l,d=(1-c)*o;a===0?e.moveTo(u,d):e.lineTo(u,d)}e.stroke()}function Wt(e){const n=Number(e);return Number.isFinite(n)?Math.max(Ze,Math.min(Yt,n)):Ze}function hl(e){const n=e();if($n[Fe]=Wt(n.low),Yn[Fe]=Wt(n.mid),Hn[Fe]=Wt(n.hi),Fe=(Fe+1)%Ie,!le)return;const t=le.getContext("2d");if(!t)return;const r=wt,o=$t,s=r-Ct,l=Ct;t.clearRect(0,0,r,o),dl(t,o),Bt(t,$n,cl,s,o,l),Bt(t,Yn,il,s,o,l),Bt(t,Hn,ll,s,o,l)}function fl(e,n){if(!e)return;e.innerHTML="";const t=document.createElement("div");t.className="level-strip-wrap",t.setAttribute("aria-label","レベルメーター（Low / Mid / Hi 過去1秒・共通縦軸）");const r=document.createElement("div");r.className="level-strip-labels",r.innerHTML='<span class="level-legend low">Low</span><span class="level-legend mid">Mid</span><span class="level-legend hi">Hi</span>',le=document.createElement("canvas"),le.className="level-strip-canvas";const o=window.devicePixelRatio||1;le.width=wt*o,le.height=$t*o,le.style.width=`${wt}px`,le.style.height=`${$t}px`;const s=le.getContext("2d");s&&s.scale(o,o),t.appendChild(r),t.appendChild(le),e.appendChild(t);let l=0;function a(i){i-l>=al&&(l=i,hl(n)),requestAnimationFrame(a)}requestAnimationFrame(a)}let $=null,de=null,te=null,Ke=0;function Ht(e){const n=se();if(e<0||e>=n.length)return;const t=n[e];$&&URL.revokeObjectURL($),$=URL.createObjectURL(t.file),de=null,te!=null&&(clearInterval(te),te=null),Hr(at()),Gt($),$e(e),Ge(!1),Ke=0,bn(),st(t.file).then(r=>{ae()===e&&(de=r,_n(e,r))}).catch(()=>{})}function Qr(e){if(e.action==="loop"){const n=se(),t=ae();t!==null&&t<n.length&&(Ke+=n[t].duration??0),Ge(!1),Gt($);return}if(e.action==="next"){$e(e.index),Ge(!1),Ke=0;const t=se()[e.index];$&&URL.revokeObjectURL($),$=URL.createObjectURL(t.file),de=null,Gt($),bn(),st(t.file).then(r=>{ae()===e.index&&(de=r,_n(e.index,r))}).catch(()=>{});return}e.action==="stop"&&($e(null),de=null,te!=null&&(clearInterval(te),te=null),$&&(URL.revokeObjectURL($),$=null))}function pl(){Qr(er())}function ml(){Cn(),Ge(!0)}function Jr(){Cn(),$e(null),de=null,te!=null&&(clearInterval(te),te=null),$&&(URL.revokeObjectURL($),$=null)}function _n(e,n){const r=se()[e],o=(r==null?void 0:r.duration)??(n==null?void 0:n.duration)??0;if(!(o>0))return;const l=at().currentTime,a=Math.max(0,l-2),i=Math.min(o,l+1);i<=a||Promise.all([Ki(n,a,i),Qi(n,a,i)]).then(([c,u])=>{ae()===e&&co(c,u)})}function bn(){te==null&&(te=setInterval(()=>{const e=ae();e===null||!de||nn()||_n(e,de)},1500))}function gl(e){const n=at();if(ae()===null)return;const r=Math.max(0,e);n.currentTime=r,rn(r)}function yl(e){const n=se();if(n.length===0)return;const t=on(n),r=n.reduce((p,f)=>p+ke(f),0),o=Math.max(0,Math.min(e,r));let s=n.length-1,l=ke(n[s]);for(let p=0;p<n.length;p++){const f=ke(n[p]);if(o<t[p]+f){s=p,l=o-t[p];break}}const a=n[s],i=a.duration??0,c=i>0?Math.floor(l/i)*i:0,u=i>0?l%i:0;$&&URL.revokeObjectURL($),$=URL.createObjectURL(a.file),de=null,te!=null&&(clearInterval(te),te=null),Ke=c,$e(s),Ge(!1),uo(Date.now()-o*1e3);const d=at();d.src=$;const h=()=>{d.currentTime=u,rn(u),d.play().catch(()=>{}),Hr(d),bn(),st(a.file).then(p=>{ae()===s&&(de=p)}).catch(()=>{})};d.readyState>=2?h():d.addEventListener("canplay",h,{once:!0})}function vl(){const e=se(),n=ae();if(e.length===0)return;if(n===null){Ht(0);return}const t=n+1;if(t>=e.length){Jr();return}Ht(t)}function Nl(){const e=se();if(!e.length)return;const n=po(e.map(s=>({name:s.name,loop:s.loop,maxLoopSeconds:s.maxLoopSeconds}))),t=new Blob([n],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download="audio-list.txt",o.click(),URL.revokeObjectURL(r)}function wl(){const e=document.getElementById("input-load-list");e&&(e.value="",e.onchange=()=>{var r;const n=(r=e.files)==null?void 0:r[0];if(!n)return;const t=new FileReader;t.onload=()=>{const o=typeof t.result=="string"?t.result:"",s=rr(o);s.length&&tr(s)},t.readAsText(n,"UTF-8")},e.click())}function Cl(){yo(document.getElementById("dropzone"));const e=document.getElementById("btn-save-list"),n=document.getElementById("btn-load-list");e&&e.addEventListener("click",Nl),n&&n.addEventListener("click",wl),el(document.getElementById("list-container"),{onPlayRequest(d){Ht(d)},onPauseRequest:ml,onStopRequest:Jr,onSeekRequest:gl}),nl(pl);const t=document.getElementById("elapsed-display"),r=document.getElementById("elapsed-progress-fill"),o=document.querySelector(".elapsed-progress-bar"),s=document.getElementById("btn-next"),l=document.getElementById("level-meters"),a=at();s&&s.addEventListener("click",vl),l&&fl(l,()=>sl());const i=document.getElementById("realtime-key"),c=document.getElementById("realtime-chord");function u(){const d=h=>h!=null&&String(h)!=="NaN"?h:"—";i&&(i.textContent=d(so())),c&&(c.textContent=d(ao()))}oo(u),u(),o&&(o.addEventListener("click",d=>{const h=se();if(h.length===0)return;const p=h.reduce((v,N)=>v+ke(N),0);if(p<=0)return;const f=o.getBoundingClientRect(),m=Math.max(0,Math.min(1,(d.clientX-f.left)/f.width));yl(p*m)}),o.style.cursor="pointer"),setInterval(()=>{const d=se(),h=ae();if(h!==null&&h<d.length&&!nn()){const v=d[h],N=io();if(N!=null&&v.loop&&v.maxLoopSeconds!=null&&v.maxLoopSeconds>0&&(Date.now()-N)/1e3>=v.maxLoopSeconds){Cn(),Qr(er());return}}const p=d.reduce((v,N)=>v+ke(N),0);let f=0;h!==null&&h>=0&&(f=on(d)[h]+Ke+a.currentTime),t&&(t.textContent=`再生経過: ${ue(f)} / ${ue(p)}`);const m=p>0?Math.min(100,f/p*100):0;if(r&&(r.style.width=`${m}%`),o&&o.setAttribute("aria-valuenow",String(Math.round(m))),h!==null){const v=a.currentTime;rn(v)}},500)}Cl();
