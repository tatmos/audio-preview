(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();let X=[],q=null,Lt=null,Yt=0,Ht=!1,jn=()=>{},Zn=()=>{},Kt=null,Qt=null,Jt=()=>{};function Yr(e){jn=e}function Hr(e){Zn=e}function Kr(e){Jt=e}function Qr(){return Kt}function Jr(){return Qt}function eo(e,n){Kt=e,n!==void 0&&(Qt=n),Jt()}function Be(){jn([...X],q)}function we(){return[...X]}function pe(){return q}function zn(){return Yt}function Xn(){return Ht}function at(e){Ht=e,Be()}function Gn(e){Yt=Math.max(0,e),Zn()}function to(e){const n=Array.from(e).filter(t=>t.type.startsWith("audio/"));for(const t of n)X.push({id:crypto.randomUUID(),file:t,name:t.name,loop:!1,maxLoopSeconds:null,duration:null,bpm:null,key:null});Be()}function ct(e){q=e>=0&&e<X.length?e:null,Lt=q!==null?Date.now():null,Yt=0,Ht=q===null,q===null&&(Kt=null,Qt=null,Jt()),Be()}function no(){if(q===null||q>=X.length)return{action:"stop"};const e=X[q],n=Lt!==null?(Date.now()-Lt)/1e3:0;if(e.loop&&e.maxLoopSeconds!=null&&e.maxLoopSeconds>0){if(n>=e.maxLoopSeconds){const r=q+1;return r<X.length?{action:"next",index:r}:{action:"stop"}}return{action:"loop"}}if(e.loop&&(e.maxLoopSeconds==null||e.maxLoopSeconds<=0))return{action:"loop"};const t=q+1;return t<X.length?{action:"next",index:t}:{action:"stop"}}function ro(e,n){if(e<0||e>=X.length||n<0||n>=X.length)return;const[t]=X.splice(e,1);X.splice(n,0,t),q===e?q=n:q!==null&&(e<q&&n>=q?q--:e>q&&n<=q&&q++),Be()}function ke(e,n){const t=X.findIndex(r=>r.id===e);t!==-1&&(n.loop!==void 0&&(X[t].loop=n.loop),n.maxLoopSeconds!==void 0&&(X[t].maxLoopSeconds=n.maxLoopSeconds),n.duration!==void 0&&(X[t].duration=n.duration),n.bpm!==void 0&&(X[t].bpm=n.bpm),n.key!==void 0&&(X[t].key=n.key),Be())}function $n(e){if(!e.length)return;const n=[...X],t=new Set,r=[];for(const s of e){const l=n.findIndex(a=>a.name===s.name&&!t.has(a.id));if(l>=0){const a={...n[l],loop:s.loop,maxLoopSeconds:s.maxLoopSeconds};t.add(n[l].id),r.push(a)}}for(const s of n)t.has(s.id)||r.push(s);const o=q!==null&&q<n.length?n[q].id:null;X=r,q=o!==null?X.findIndex(s=>s.id===o):null,q===-1&&(q=null),Be()}function he(e){if(e==null||Number.isNaN(e)||e<0)return"0:00";const n=Math.floor(e/60),t=Math.floor(e%60);return`${n}:${String(t).padStart(2,"0")}`}function Yn(e){const n=e.trim();if(!n)return null;const t=n.split(":");if(t.length!==2)return null;const r=parseInt(t[0],10),o=parseInt(t[1],10);return Number.isNaN(r)||Number.isNaN(o)||r<0||o<0||o>=60?null:r*60+o}function oo(e){const n=e.trim();if(!n)return null;const t=n.split("	");if(t.length>=3){const r=t.slice(0,-2).join("	").trim(),o=t[t.length-2]==="1",s=t[t.length-1].trim(),l=s?Yn(s):null;return{name:r,loop:o,maxLoopSeconds:l}}return t.length===2?{name:t[0].trim(),loop:t[1]==="1",maxLoopSeconds:null}:t.length===1?{name:t[0].trim(),loop:!1,maxLoopSeconds:null}:null}function so(e){return e.map(n=>`${n.name}	${n.loop?1:0}	${n.maxLoopSeconds!=null?he(n.maxLoopSeconds):""}`).join(`
`)}function Hn(e){const n=e.split(/\r?\n/),t=[];for(const r of n){const o=oo(r);o&&o.name&&t.push(o)}return t}function ao(e){const n=[],t=[];for(const r of e)r.type.startsWith("audio/")?n.push(r):(r.name.toLowerCase().endsWith(".txt")||r.type==="text/plain")&&t.push(r);return{audioFiles:n,txtFiles:t}}function co(e,n){const t=new FileReader;t.onload=()=>{const r=typeof t.result=="string"?t.result:"",o=Hn(r);o.length&&$n(o)},t.onerror=n,t.readAsText(e,"UTF-8")}function gn(e){const{audioFiles:n,txtFiles:t}=ao(Array.from(e));n.length&&to(n);const r=t[0];r&&co(r,()=>{})}function io(e){const n=document.createElement("span");n.textContent="オーディオファイル・リストtxtをドラッグ＆ドロップ または クリックして選択",n.className="dropzone-label",e.appendChild(n);const t=document.createElement("input");t.type="file",t.accept="audio/*,.txt,text/plain",t.multiple=!0,t.style.display="none",e.appendChild(t),e.addEventListener("click",()=>t.click()),e.addEventListener("dragover",r=>{r.preventDefault(),r.stopPropagation(),e.classList.add("dragover")}),e.addEventListener("dragleave",r=>{r.preventDefault(),r.stopPropagation(),e.classList.remove("dragover")}),e.addEventListener("drop",r=>{var s;r.preventDefault(),r.stopPropagation(),e.classList.remove("dragover");const o=(s=r.dataTransfer)==null?void 0:s.files;o!=null&&o.length&&gn(Array.from(o))}),t.addEventListener("change",()=>{const r=t.files;r!=null&&r.length&&gn(Array.from(r)),t.value=""})}const lo=e=>(n,t)=>(e.set(n,t),t),yn=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Kn=536870912,vn=Kn*2,uo=(e,n)=>t=>{const r=n.get(t);let o=r===void 0?t.size:r<vn?r+1:0;if(!t.has(o))return e(t,o);if(t.size<Kn){for(;t.has(o);)o=Math.floor(Math.random()*vn);return e(t,o)}if(t.size>yn)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(o);)o=Math.floor(Math.random()*yn);return e(t,o)},Qn=new WeakMap,ho=lo(Qn),fo=uo(ho,Qn),po=(e,n,t,r)=>o=>{const s=n(o);return l=>{const a=e(l);l.addEventListener("message",({data:d})=>{const{id:h}=d;if(h!==null&&a.has(h)){const{reject:p,resolve:f}=a.get(h);a.delete(h),d.error===void 0?f(d.result):p(new Error(d.error.message))}}),r(l)&&l.start();const c=(d,h=null,p=[])=>new Promise((f,g)=>{const v=t(a);a.set(v,{reject:g,resolve:f}),h===null?l.postMessage({id:v,method:d},p):l.postMessage({id:v,method:d,params:h},p)}),i=(d,h,p=[])=>{l.postMessage({id:null,method:d,params:h},p)};let u={};for(const[d,h]of Object.entries(s))u={...u,[d]:h({call:c,notify:i})};return{...u}}},mo=e=>n=>{if(e.has(n))return e.get(n);const t=new Map;return e.set(n,t),t},go=e=>n=>({...n,connect:({call:t})=>async()=>{const{port1:r,port2:o}=new MessageChannel,s=await t("connect",{port:r},[r]);return e.set(o,s),o},disconnect:({call:t})=>async r=>{const o=e.get(r);if(o===void 0)throw new Error("The given port is not connected.");await t("disconnect",{portId:o})},isSupported:({call:t})=>()=>t("isSupported")}),yo=e=>typeof e.start=="function",vo=po(mo(new WeakMap),go(new WeakMap),fo,yo),Nn=(e,n,t)=>({endTime:n,insertTime:t,type:"exponentialRampToValue",value:e}),wn=(e,n,t)=>({endTime:n,insertTime:t,type:"linearRampToValue",value:e}),Wt=(e,n)=>({startTime:n,type:"setValue",value:e}),Jn=(e,n,t)=>({duration:t,startTime:n,type:"setValueCurve",values:e}),er=(e,n,{startTime:t,target:r,timeConstant:o})=>r+(n-r)*Math.exp((t-e)/o),De=e=>e.type==="exponentialRampToValue",it=e=>e.type==="linearRampToValue",ve=e=>De(e)||it(e),en=e=>e.type==="setValue",de=e=>e.type==="setValueCurve",lt=(e,n,t,r)=>{const o=e[n];return o===void 0?r:ve(o)||en(o)?o.value:de(o)?o.values[o.values.length-1]:er(t,lt(e,n-1,o.startTime,r),o)},Cn=(e,n,t,r,o)=>t===void 0?[r.insertTime,o]:ve(t)?[t.endTime,t.value]:en(t)?[t.startTime,t.value]:de(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,lt(e,n-1,t.startTime,o)],Bt=e=>e.type==="cancelAndHold",Vt=e=>e.type==="cancelScheduledValues",ye=e=>Bt(e)||Vt(e)?e.cancelTime:De(e)||it(e)?e.endTime:e.startTime,_n=(e,n,t,{endTime:r,value:o})=>t===o?o:0<t&&0<o||t<0&&o<0?t*(o/t)**((e-n)/(r-n)):0,bn=(e,n,t,{endTime:r,value:o})=>t+(e-n)/(r-n)*(o-t),No=(e,n)=>{const t=Math.floor(n),r=Math.ceil(n);return t===r?e[t]:(1-(n-t))*e[t]+(1-(r-n))*e[r]},wo=(e,{duration:n,startTime:t,values:r})=>{const o=(e-t)/n*(r.length-1);return No(r,o)},et=e=>e.type==="setTarget";class Co{constructor(n){this._automationEvents=[],this._currenTime=0,this._defaultValue=n}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(n){const t=ye(n);if(Bt(n)||Vt(n)){const r=this._automationEvents.findIndex(s=>Vt(n)&&de(s)?s.startTime+s.duration>=t:ye(s)>=t),o=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Bt(n)){const s=this._automationEvents[this._automationEvents.length-1];if(o!==void 0&&ve(o)){if(s!==void 0&&et(s))throw new Error("The internal list is malformed.");const l=s===void 0?o.insertTime:de(s)?s.startTime+s.duration:ye(s),a=s===void 0?this._defaultValue:de(s)?s.values[s.values.length-1]:s.value,c=De(o)?_n(t,l,a,o):bn(t,l,a,o),i=De(o)?Nn(c,t,this._currenTime):wn(c,t,this._currenTime);this._automationEvents.push(i)}if(s!==void 0&&et(s)&&this._automationEvents.push(Wt(this.getValue(t),t)),s!==void 0&&de(s)&&s.startTime+s.duration>t){const l=t-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(l*a)),i=l/(c-1)*a,u=s.values.slice(0,c);if(i<1)for(let d=1;d<c;d+=1){const h=i*d%1;u[d]=s.values[d-1]*(1-h)+s.values[d]*h}this._automationEvents[this._automationEvents.length-1]=Jn(u,s.startTime,l)}}}else{const r=this._automationEvents.findIndex(l=>ye(l)>t),o=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(o!==void 0&&de(o)&&ye(o)+o.duration>t)return!1;const s=De(n)?Nn(n.value,n.endTime,this._currenTime):it(n)?wn(n.value,t,this._currenTime):n;if(r===-1)this._automationEvents.push(s);else{if(de(n)&&t+n.duration>ye(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(n){const t=this._automationEvents.findIndex(r=>ye(r)>n);if(t>1){const r=this._automationEvents.slice(t-1),o=r[0];et(o)&&r.unshift(Wt(lt(this._automationEvents,t-2,o.startTime,this._defaultValue),o.startTime)),this._automationEvents=r}}getValue(n){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(l=>ye(l)>n),r=this._automationEvents[t],o=(t===-1?this._automationEvents.length:t)-1,s=this._automationEvents[o];if(s!==void 0&&et(s)&&(r===void 0||!ve(r)||r.insertTime>n))return er(n,lt(this._automationEvents,o-1,s.startTime,this._defaultValue),s);if(s!==void 0&&en(s)&&(r===void 0||!ve(r)))return s.value;if(s!==void 0&&de(s)&&(r===void 0||!ve(r)||s.startTime+s.duration>n))return n<s.startTime+s.duration?wo(n,s):s.values[s.values.length-1];if(s!==void 0&&ve(s)&&(r===void 0||!ve(r)))return s.value;if(r!==void 0&&De(r)){const[l,a]=Cn(this._automationEvents,o,s,r,this._defaultValue);return _n(n,l,a,r)}if(r!==void 0&&it(r)){const[l,a]=Cn(this._automationEvents,o,s,r,this._defaultValue);return bn(n,l,a,r)}return this._defaultValue}}const _o=e=>({cancelTime:e,type:"cancelAndHold"}),bo=e=>({cancelTime:e,type:"cancelScheduledValues"}),To=(e,n)=>({endTime:n,type:"exponentialRampToValue",value:e}),Io=(e,n)=>({endTime:n,type:"linearRampToValue",value:e}),Eo=(e,n,t)=>({startTime:n,target:e,timeConstant:t,type:"setTarget"}),Mo=()=>new DOMException("","AbortError"),So=e=>(n,t,[r,o,s],l)=>{e(n[o],[t,r,s],a=>a[0]===t&&a[1]===r,l)},Ro=e=>(n,t,r)=>{const o=[];for(let s=0;s<r.numberOfInputs;s+=1)o.push(new Set);e.set(n,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Ao=e=>(n,t)=>{e.set(n,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Le=new WeakSet,tr=new WeakMap,nr=new WeakMap,rr=new WeakMap,or=new WeakMap,sr=new WeakMap,ar=new WeakMap,qt=new WeakMap,Tn=new WeakMap,cr={construct(){return cr}},Oo=e=>{try{const n=new Proxy(e,cr);new n}catch{return!1}return!0},In=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,En=(e,n)=>{const t=[];let r=e.replace(/^[\s]+/,""),o=r.match(In);for(;o!==null;){const s=o[1].slice(1,-1),l=o[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,n).toString());t.push(l),r=r.slice(o[0].length).replace(/^[\s]+/,""),o=r.match(In)}return[t.join(";"),r]},Mn=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Sn=e=>{if(!Oo(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Fo=(e,n,t,r,o,s,l,a,c,i,u,d,h)=>{let p=0;return(f,g,v={credentials:"omit"})=>{const w=u.get(f);if(w!==void 0&&w.has(g))return Promise.resolve();const M=i.get(f);if(M!==void 0){const y=M.get(g);if(y!==void 0)return y}const b=s(f),E=b.audioWorklet===void 0?o(g).then(([y,N])=>{const[C,m]=En(y,N),I=`${C};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${m}
})})(window,'_AWGS')`;return t(I)}).then(()=>{const y=h._AWGS.pop();if(y===void 0)throw new SyntaxError;r(b.currentTime,b.sampleRate,()=>y(class{},void 0,(N,C)=>{if(N.trim()==="")throw n();const m=Tn.get(b);if(m!==void 0){if(m.has(N))throw n();Sn(C),Mn(C.parameterDescriptors),m.set(N,C)}else Sn(C),Mn(C.parameterDescriptors),Tn.set(b,new Map([[N,C]]))},b.sampleRate,void 0,void 0))}):Promise.all([o(g),Promise.resolve(e(d,d))]).then(([[y,N],C])=>{const m=p+1;p=m;const[I,T]=En(y,N),R=`${I};((AudioWorkletProcessor,registerProcessor)=>{${T}
})(${C?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${C?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${C?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${m}',class extends AudioWorkletProcessor{process(){return !1}})`,P=new Blob([R],{type:"application/javascript; charset=utf-8"}),F=URL.createObjectURL(P);return b.audioWorklet.addModule(F,v).then(()=>{if(a(b))return b;const D=l(b);return D.audioWorklet.addModule(F,v).then(()=>D)}).then(D=>{if(c===null)throw new SyntaxError;try{new c(D,`__sac${m}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(F))});return M===void 0?i.set(f,new Map([[g,E]])):M.set(g,E),E.then(()=>{const y=u.get(f);y===void 0?u.set(f,new Set([g])):y.add(g)}).finally(()=>{const y=i.get(f);y!==void 0&&y.delete(g)}),E}},Ce=(e,n)=>{const t=e.get(n);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},yt=(e,n)=>{const t=Array.from(e).filter(n);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return e.delete(r),r},ir=(e,n,t,r)=>{const o=Ce(e,n),s=yt(o,l=>l[0]===t&&l[1]===r);return o.size===0&&e.delete(n),s},Ge=e=>Ce(ar,e),We=e=>{if(Le.has(e))throw new Error("The AudioNode is already stored.");Le.add(e),Ge(e).forEach(n=>n(!0))},lr=e=>"port"in e,$e=e=>{if(!Le.has(e))throw new Error("The AudioNode is not stored.");Le.delete(e),Ge(e).forEach(n=>n(!1))},Ut=(e,n)=>{!lr(e)&&n.every(t=>t.size===0)&&$e(e)},Do=(e,n,t,r,o,s,l,a,c,i,u,d,h)=>{const p=new WeakMap;return(f,g,v,w,M)=>{const{activeInputs:b,passiveInputs:E}=s(g),{outputs:y}=s(f),N=a(f),C=m=>{const I=c(g),T=c(f);if(m){const S=ir(E,f,v,w);e(b,f,S,!1),!M&&!d(f)&&t(T,I,v,w),h(g)&&We(g)}else{const S=r(b,f,v,w);n(E,w,S,!1),!M&&!d(f)&&o(T,I,v,w);const _=l(g);if(_===0)u(g)&&Ut(g,b);else{const A=p.get(g);A!==void 0&&clearTimeout(A),p.set(g,setTimeout(()=>{u(g)&&Ut(g,b)},_*1e3))}}};return i(y,[g,v,w],m=>m[0]===g&&m[1]===v&&m[2]===w,!0)?(N.add(C),u(f)?e(b,f,[v,w,C],!0):n(E,w,[f,v,C],!0),!0):!1}},Po=e=>(n,t,[r,o,s],l)=>{const a=n.get(r);a===void 0?n.set(r,new Set([[o,t,s]])):e(a,[o,t,s],c=>c[0]===o&&c[1]===t,l)},ko=e=>(n,t)=>{const r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(n.destination);const o=()=>{t.removeEventListener("ended",o),t.disconnect(r),r.disconnect()};t.addEventListener("ended",o)},Lo={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Wo=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=o(a),u={...Lo,...c},d=r(i,u),h=s(i)?n():null;super(a,!1,d,h),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Q=(e,n)=>e.context===n,Bo=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const i={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=e(l,i)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},ut=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Me=()=>new DOMException("","IndexSizeError"),tn=e=>{e.getChannelData=(n=>t=>{try{return n.call(e,t)}catch(r){throw r.code===12?Me():r}})(e.getChannelData)},Vo={numberOfChannels:1},qo=(e,n,t,r,o,s,l,a)=>{let c=null;return class ur{constructor(u){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:h,sampleRate:p}={...Vo,...u};c===null&&(c=new o(1,1,44100));const f=r!==null&&n(s,s)?new r({length:d,numberOfChannels:h,sampleRate:p}):c.createBuffer(h,d,p);if(f.numberOfChannels===0)throw t();return typeof f.copyFromChannel!="function"?(l(f),tn(f)):n(ut,()=>ut(f))||a(f),e.add(f),f}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===ur.prototype||e.has(u)}}},ne=-34028234663852886e22,J=-ne,fe=e=>Le.has(e),Uo={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},xo=(e,n,t,r,o,s,l,a)=>class extends e{constructor(i,u){const d=s(i),h={...Uo,...u},p=o(d,h),f=l(d),g=f?n():null;super(i,!1,p,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=t(this,f,p.playbackRate,J,ne)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(i){if(this._nativeAudioBufferSourceNode.buffer=i,i!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(i){this._nativeAudioBufferSourceNode.loop=i}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(i){this._nativeAudioBufferSourceNode.loopEnd=i}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(i){this._nativeAudioBufferSourceNode.loopStart=i}get onended(){return this._onended}set onended(i){const u=typeof i=="function"?a(this,i):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?i:d}get playbackRate(){return this._playbackRate}start(i=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(i,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[i,u]:[i,u,d]),this.context.state!=="closed"){We(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),fe(this)&&$e(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(i=0){this._nativeAudioBufferSourceNode.stop(i),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=i)}},jo=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null;const c=async(i,u)=>{let d=t(i);const h=Q(d,u);if(!h){const p={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=n(u,p),l!==null&&d.start(...l),a!==null&&d.stop(a)}return s.set(u,d),h?await e(u,i.playbackRate,d.playbackRate):await r(u,i.playbackRate,d.playbackRate),await o(i,u,d),d};return{set start(i){l=i},set stop(i){a=i},render(i,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(i,u)}}},Zo=e=>"playbackRate"in e,zo=e=>"frequency"in e&&"gain"in e,Xo=e=>"offset"in e,Go=e=>!("frequency"in e)&&"gain"in e,$o=e=>"detune"in e&&"frequency"in e&&!("gain"in e),Yo=e=>"pan"in e,re=e=>Ce(tr,e),Ye=e=>Ce(rr,e),xt=(e,n)=>{const{activeInputs:t}=re(e);t.forEach(o=>o.forEach(([s])=>{n.includes(e)||xt(s,[...n,e])}));const r=Zo(e)?[e.playbackRate]:lr(e)?Array.from(e.parameters.values()):zo(e)?[e.Q,e.detune,e.frequency,e.gain]:Xo(e)?[e.offset]:Go(e)?[e.gain]:$o(e)?[e.detune,e.frequency]:Yo(e)?[e.pan]:[];for(const o of r){const s=Ye(o);s!==void 0&&s.activeInputs.forEach(([l])=>xt(l,n))}fe(e)&&$e(e)},Ho=e=>{xt(e.destination,[])},Ko=(e,n,t,r,o,s,l,a)=>class extends e{constructor(i,u){const d=s(i),h=l(d),p=o(d,u,h),f=h?n(a):null;super(i,!1,p,f),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(i){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(i>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=i}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(i){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=i}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Qo=e=>{const n=new WeakMap,t=async(r,o)=>{const s=o.destination;return n.set(o,s),await e(r,o,s),s};return{render(r,o){const s=n.get(o);return s!==void 0?Promise.resolve(s):t(r,o)}}},Jo=(e,n,t,r,o,s,l,a)=>(c,i)=>{const u=i.listener,d=()=>{const y=new Float32Array(1),N=n(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),C=l(i);let m=!1,I=[0,0,-1,0,1,0],T=[0,0,0];const S=()=>{if(m)return;m=!0;const P=r(i,256,9,0);P.onaudioprocess=({inputBuffer:F})=>{const D=[s(F,y,0),s(F,y,1),s(F,y,2),s(F,y,3),s(F,y,4),s(F,y,5)];D.some((k,W)=>k!==I[W])&&(u.setOrientation(...D),I=D);const V=[s(F,y,6),s(F,y,7),s(F,y,8)];V.some((k,W)=>k!==T[W])&&(u.setPosition(...V),T=V)},N.connect(P)},_=P=>F=>{F!==I[P]&&(I[P]=F,u.setOrientation(...I))},A=P=>F=>{F!==T[P]&&(T[P]=F,u.setPosition(...T))},R=(P,F,D)=>{const V=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:F});V.connect(N,0,P),V.start(),Object.defineProperty(V.offset,"defaultValue",{get(){return F}});const k=e({context:c},C,V.offset,J,ne);return a(k,"value",W=>()=>W.call(k),W=>L=>{try{W.call(k,L)}catch(x){if(x.code!==9)throw x}S(),C&&D(L)}),k.cancelAndHoldAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.cancelAndHoldAtTime),k.cancelScheduledValues=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.cancelScheduledValues),k.exponentialRampToValueAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.exponentialRampToValueAtTime),k.linearRampToValueAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.linearRampToValueAtTime),k.setTargetAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.setTargetAtTime),k.setValueAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.setValueAtTime),k.setValueCurveAtTime=(W=>C?()=>{throw o()}:(...L)=>{const x=W.apply(k,L);return S(),x})(k.setValueCurveAtTime),k};return{forwardX:R(0,0,_(0)),forwardY:R(1,0,_(1)),forwardZ:R(2,-1,_(2)),positionX:R(6,0,A(0)),positionY:R(7,0,A(1)),positionZ:R(8,0,A(2)),upX:R(3,0,_(3)),upY:R(4,1,_(4)),upZ:R(5,0,_(5))}},{forwardX:h,forwardY:p,forwardZ:f,positionX:g,positionY:v,positionZ:w,upX:M,upY:b,upZ:E}=u.forwardX===void 0?d():u;return{get forwardX(){return h},get forwardY(){return p},get forwardZ(){return f},get positionX(){return g},get positionY(){return v},get positionZ(){return w},get upX(){return M},get upY(){return b},get upZ(){return E}}},dt=e=>"context"in e,He=e=>dt(e[0]),Se=(e,n,t,r)=>{for(const o of e)if(t(o)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(n),!0},Rn=(e,n,[t,r],o)=>{Se(e,[n,t,r],s=>s[0]===n&&s[1]===t,o)},An=(e,[n,t,r],o)=>{const s=e.get(n);s===void 0?e.set(n,new Set([[t,r]])):Se(s,[t,r],l=>l[0]===t,o)},Ve=e=>"inputs"in e,ht=(e,n,t,r)=>{if(Ve(n)){const o=n.inputs[r];return e.connect(o,t,0),[o,t,0]}return e.connect(n,t,r),[n,t,r]},dr=(e,n,t)=>{for(const r of e)if(r[0]===n&&r[1]===t)return e.delete(r),r;return null},es=(e,n,t)=>yt(e,r=>r[0]===n&&r[1]===t),hr=(e,n)=>{if(!Ge(e).delete(n))throw new Error("Missing the expected event listener.")},fr=(e,n,t)=>{const r=Ce(e,n),o=yt(r,s=>s[0]===t);return r.size===0&&e.delete(n),o},ft=(e,n,t,r)=>{Ve(n)?e.disconnect(n.inputs[r],t,0):e.disconnect(n,t,r)},j=e=>Ce(nr,e),ze=e=>Ce(or,e),Ee=e=>qt.has(e),ot=e=>!Le.has(e),On=(e,n)=>new Promise(t=>{if(n!==null)t(!0);else{const r=e.createScriptProcessor(256,1,1),o=e.createGain(),s=e.createBuffer(1,2,44100),l=s.getChannelData(0);l[0]=1,l[1]=1;const a=e.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(e.destination),a.connect(o),a.disconnect(o),r.onaudioprocess=c=>{const i=c.inputBuffer.getChannelData(0);Array.prototype.some.call(i,u=>u===1)?t(!0):t(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(e.destination)},a.start()}}),At=(e,n)=>{const t=new Map;for(const r of e)for(const o of r){const s=t.get(o);t.set(o,s===void 0?1:s+1)}t.forEach((r,o)=>n(o,r))},Fn=e=>"context"in e,ts=e=>{const n=new Map;e.connect=(t=>(r,o=0,s=0)=>{const l=Fn(r)?t(r,o,s):t(r,o),a=n.get(r);return a===void 0?n.set(r,[{input:s,output:o}]):a.every(c=>c.input!==s||c.output!==o)&&a.push({input:s,output:o}),l})(e.connect.bind(e)),e.disconnect=(t=>(r,o,s)=>{if(t.apply(e),r===void 0)n.clear();else if(typeof r=="number")for(const[l,a]of n){const c=a.filter(i=>i.output!==r);c.length===0?n.delete(l):n.set(l,c)}else if(n.has(r))if(o===void 0)n.delete(r);else{const l=n.get(r);if(l!==void 0){const a=l.filter(c=>c.output!==o&&(c.input!==s||s===void 0));a.length===0?n.delete(r):n.set(r,a)}}for(const[l,a]of n)a.forEach(c=>{Fn(l)?e.connect(l,c.output,c.input):e.connect(l,c.output)})})(e.disconnect)},ns=(e,n,t,r)=>{const{activeInputs:o,passiveInputs:s}=Ye(n),{outputs:l}=re(e),a=Ge(e),c=i=>{const u=j(e),d=ze(n);if(i){const h=fr(s,e,t);Rn(o,e,h,!1),!r&&!Ee(e)&&u.connect(d,t)}else{const h=es(o,e,t);An(s,h,!1),!r&&!Ee(e)&&u.disconnect(d,t)}};return Se(l,[n,t],i=>i[0]===n&&i[1]===t,!0)?(a.add(c),fe(e)?Rn(o,e,[t,c],!0):An(s,[e,t,c],!0),!0):!1},rs=(e,n,t,r)=>{const{activeInputs:o,passiveInputs:s}=re(n),l=dr(o[r],e,t);return l===null?[ir(s,e,t,r)[2],!1]:[l[2],!0]},os=(e,n,t)=>{const{activeInputs:r,passiveInputs:o}=Ye(n),s=dr(r,e,t);return s===null?[fr(o,e,t)[1],!1]:[s[2],!0]},nn=(e,n,t,r,o)=>{const[s,l]=rs(e,t,r,o);if(s!==null&&(hr(e,s),l&&!n&&!Ee(e)&&ft(j(e),j(t),r,o)),fe(t)){const{activeInputs:a}=re(t);Ut(t,a)}},rn=(e,n,t,r)=>{const[o,s]=os(e,t,r);o!==null&&(hr(e,o),s&&!n&&!Ee(e)&&j(e).disconnect(ze(t),r))},ss=(e,n)=>{const t=re(e),r=[];for(const o of t.outputs)He(o)?nn(e,n,...o):rn(e,n,...o),r.push(o[0]);return t.outputs.clear(),r},as=(e,n,t)=>{const r=re(e),o=[];for(const s of r.outputs)s[1]===t&&(He(s)?nn(e,n,...s):rn(e,n,...s),o.push(s[0]),r.outputs.delete(s));return o},cs=(e,n,t,r,o)=>{const s=re(e);return Array.from(s.outputs).filter(l=>l[0]===t&&(r===void 0||l[1]===r)&&(o===void 0||l[2]===o)).map(l=>(He(l)?nn(e,n,...l):rn(e,n,...l),s.outputs.delete(l),l[0]))},is=(e,n,t,r,o,s,l,a,c,i,u,d,h,p,f,g)=>class extends i{constructor(w,M,b,E){super(b),this._context=w,this._nativeAudioNode=b;const y=u(w);d(y)&&t(On,()=>On(y,g))!==!0&&ts(b),nr.set(this,b),ar.set(this,new Set),w.state!=="closed"&&M&&We(this),e(this,E,b)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(w){this._nativeAudioNode.channelCount=w}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(w){this._nativeAudioNode.channelCountMode=w}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(w){this._nativeAudioNode.channelInterpretation=w}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(w,M=0,b=0){if(M<0||M>=this._nativeAudioNode.numberOfOutputs)throw o();const E=u(this._context),y=f(E);if(h(w)||p(w))throw s();if(dt(w)){const m=j(w);try{const T=ht(this._nativeAudioNode,m,M,b),S=ot(this);(y||S)&&this._nativeAudioNode.disconnect(...T),this.context.state!=="closed"&&!S&&ot(w)&&We(w)}catch(T){throw T.code===12?s():T}if(n(this,w,M,b,y)){const T=c([this],w);At(T,r(y))}return w}const N=ze(w);if(N.name==="playbackRate"&&N.maxValue===1024)throw l();try{this._nativeAudioNode.connect(N,M),(y||ot(this))&&this._nativeAudioNode.disconnect(N,M)}catch(m){throw m.code===12?s():m}if(ns(this,w,M,y)){const m=c([this],w);At(m,r(y))}}disconnect(w,M,b){let E;const y=u(this._context),N=f(y);if(w===void 0)E=ss(this,N);else if(typeof w=="number"){if(w<0||w>=this.numberOfOutputs)throw o();E=as(this,N,w)}else{if(M!==void 0&&(M<0||M>=this.numberOfOutputs)||dt(w)&&b!==void 0&&(b<0||b>=w.numberOfInputs))throw o();if(E=cs(this,N,w,M,b),E.length===0)throw s()}for(const C of E){const m=c([this],C);At(m,a)}}},ls=(e,n,t,r,o,s,l,a,c,i,u,d,h)=>(p,f,g,v=null,w=null)=>{const M=g.value,b=new Co(M),E=f?r(b):null,y={get defaultValue(){return M},get maxValue(){return v===null?g.maxValue:v},get minValue(){return w===null?g.minValue:w},get value(){return g.value},set value(N){g.value=N,y.setValueAtTime(N,p.context.currentTime)},cancelAndHoldAtTime(N){if(typeof g.cancelAndHoldAtTime=="function")E===null&&b.flush(p.context.currentTime),b.add(o(N)),g.cancelAndHoldAtTime(N);else{const C=Array.from(b).pop();E===null&&b.flush(p.context.currentTime),b.add(o(N));const m=Array.from(b).pop();g.cancelScheduledValues(N),C!==m&&m!==void 0&&(m.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(m.value,m.endTime):m.type==="linearRampToValue"?g.linearRampToValueAtTime(m.value,m.endTime):m.type==="setValue"?g.setValueAtTime(m.value,m.startTime):m.type==="setValueCurve"&&g.setValueCurveAtTime(m.values,m.startTime,m.duration))}return y},cancelScheduledValues(N){return E===null&&b.flush(p.context.currentTime),b.add(s(N)),g.cancelScheduledValues(N),y},exponentialRampToValueAtTime(N,C){if(N===0)throw new RangeError;if(!Number.isFinite(C)||C<0)throw new RangeError;const m=p.context.currentTime;return E===null&&b.flush(m),Array.from(b).length===0&&(b.add(i(M,m)),g.setValueAtTime(M,m)),b.add(l(N,C)),g.exponentialRampToValueAtTime(N,C),y},linearRampToValueAtTime(N,C){const m=p.context.currentTime;return E===null&&b.flush(m),Array.from(b).length===0&&(b.add(i(M,m)),g.setValueAtTime(M,m)),b.add(a(N,C)),g.linearRampToValueAtTime(N,C),y},setTargetAtTime(N,C,m){return E===null&&b.flush(p.context.currentTime),b.add(c(N,C,m)),g.setTargetAtTime(N,C,m),y},setValueAtTime(N,C){return E===null&&b.flush(p.context.currentTime),b.add(i(N,C)),g.setValueAtTime(N,C),y},setValueCurveAtTime(N,C,m){const I=N instanceof Float32Array?N:new Float32Array(N);if(d!==null&&d.name==="webkitAudioContext"){const T=C+m,S=p.context.sampleRate,_=Math.ceil(C*S),A=Math.floor(T*S),R=A-_,P=new Float32Array(R);for(let D=0;D<R;D+=1){const V=(I.length-1)/m*((_+D)/S-C),k=Math.floor(V),W=Math.ceil(V);P[D]=k===W?I[k]:(1-(V-k))*I[k]+(1-(W-V))*I[W]}E===null&&b.flush(p.context.currentTime),b.add(u(P,C,m)),g.setValueCurveAtTime(P,C,m);const F=A/S;F<T&&h(y,P[P.length-1],F),h(y,I[I.length-1],T)}else E===null&&b.flush(p.context.currentTime),b.add(u(I,C,m)),g.setValueCurveAtTime(I,C,m);return y}};return t.set(y,g),n.set(y,p),e(y,E),y},us=e=>({replay(n){for(const t of e)if(t.type==="exponentialRampToValue"){const{endTime:r,value:o}=t;n.exponentialRampToValueAtTime(o,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:o}=t;n.linearRampToValueAtTime(o,r)}else if(t.type==="setTarget"){const{startTime:r,target:o,timeConstant:s}=t;n.setTargetAtTime(o,r,s)}else if(t.type==="setValue"){const{startTime:r,value:o}=t;n.setValueAtTime(o,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:o,values:s}=t;n.setValueCurveAtTime(s,o,r)}else throw new Error("Can't apply an unknown automation.")}}),ds=(e,n,t,r,o,s,l,a,c,i,u,d,h,p,f,g,v,w,M,b)=>class extends f{constructor(y,N){super(y,N),this._nativeContext=y,this._audioWorklet=e===void 0?void 0:{addModule:(C,m)=>e(this,C,m)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new n(this)}createBiquadFilter(){return new o(this)}createBuffer(y,N,C){return new t({length:N,numberOfChannels:y,sampleRate:C})}createBufferSource(){return new r(this)}createChannelMerger(y=6){return new s(this,{numberOfInputs:y})}createChannelSplitter(y=6){return new l(this,{numberOfOutputs:y})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(y=1){return new u(this,{maxDelayTime:y})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(y,N){return new p(this,{feedback:N,feedforward:y})}createOscillator(){return new g(this)}createPanner(){return new v(this)}createPeriodicWave(y,N,C={disableNormalization:!1}){return new w(this,{...C,imag:N,real:y})}createStereoPanner(){return new M(this)}createWaveShaper(){return new b(this)}decodeAudioData(y,N,C){return i(this._nativeContext,y).then(m=>(typeof N=="function"&&N(m),m),m=>{throw typeof C=="function"&&C(m),m})}},hs={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},fs=(e,n,t,r,o,s,l,a)=>class extends e{constructor(i,u){const d=s(i),h={...hs,...u},p=o(d,h),f=l(d),g=f?t():null;super(i,!1,p,g),this._Q=n(this,f,p.Q,J,ne),this._detune=n(this,f,p.detune,1200*Math.log2(J),-1200*Math.log2(J)),this._frequency=n(this,f,p.frequency,i.sampleRate/2,0),this._gain=n(this,f,p.gain,40*Math.log10(J),ne),this._nativeBiquadFilterNode=p,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(i){this._nativeBiquadFilterNode.type=i}getFrequencyResponse(i,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(i,u,d)}catch(h){throw h.code===11?r():h}if(i.length!==u.length||u.length!==d.length)throw r()}},ps=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,c)=>{let i=t(a);const u=Q(i,c);if(!u){const d={Q:i.Q.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,detune:i.detune.value,frequency:i.frequency.value,gain:i.gain.value,type:i.type};i=n(c,d)}return s.set(c,i),u?(await e(c,a.Q,i.Q),await e(c,a.detune,i.detune),await e(c,a.frequency,i.frequency),await e(c,a.gain,i.gain)):(await r(c,a.Q,i.Q),await r(c,a.detune,i.detune),await r(c,a.frequency,i.frequency),await r(c,a.gain,i.gain)),await o(a,c,i),i};return{render(a,c){const i=s.get(c);return i!==void 0?Promise.resolve(i):l(a,c)}}},ms=(e,n)=>(t,r)=>{const o=n.get(t);if(o!==void 0)return o;const s=e.get(t);if(s!==void 0)return s;try{const l=r();return l instanceof Promise?(e.set(t,l),l.catch(()=>!1).then(a=>(e.delete(t),n.set(t,a),a))):(n.set(t,l),l)}catch{return n.set(t,!1),!1}},gs={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ys=(e,n,t,r,o)=>class extends e{constructor(l,a){const c=r(l),i={...gs,...a},u=t(c,i),d=o(c)?n():null;super(l,!1,u,d)}},vs=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const i={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=e(l,i)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},Ns={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ws=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=r(a),u=s({...Ns,...c}),d=t(i,u),h=o(i)?n():null;super(a,!1,d,h)}},Cs=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const i={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=e(l,i)}return r.set(l,a),await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},_s=e=>(n,t,r)=>e(t,n,r),bs=e=>(n,t)=>{const r=e(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=n.createBuffer(1,2,44100);return r.buffer=o,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},Ts={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Is=(e,n,t,r,o,s,l)=>class extends e{constructor(c,i){const u=o(c),d={...Ts,...i},h=r(u,d),p=s(u),f=p?t():null;super(c,!1,h,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=h,this._offset=n(this,p,h.offset,J,ne),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const i=typeof c=="function"?l(this,c):null;this._nativeConstantSourceNode.onended=i;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===i?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){We(this);const i=()=>{this._nativeConstantSourceNode.removeEventListener("ended",i),fe(this)&&$e(this)};this._nativeConstantSourceNode.addEventListener("ended",i)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},Es=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null;const c=async(i,u)=>{let d=t(i);const h=Q(d,u);if(!h){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=n(u,p),l!==null&&d.start(l),a!==null&&d.stop(a)}return s.set(u,d),h?await e(u,i.offset,d.offset):await r(u,i.offset,d.offset),await o(i,u,d),d};return{set start(i){l=i},set stop(i){a=i},render(i,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(i,u)}}},Ms=e=>n=>(e[0]=n,e[0]),Ss={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Rs=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=r(a),u={...Ss,...c},d=t(i,u),p=o(i)?n():null;super(a,!1,d,p),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},As=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const i={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=e(l,i)}return r.set(l,a),Ve(a)?await t(s,l,a.inputs[0]):await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},Os=(e,n)=>(t,r,o)=>{if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new n(t,r,o)}catch(s){throw s.name==="SyntaxError"?e():s}},Fs=()=>new DOMException("","DataCloneError"),Dn=e=>{const{port1:n,port2:t}=new MessageChannel;return new Promise(r=>{const o=()=>{t.onmessage=null,n.close(),t.close(),r()};t.onmessage=()=>o();try{n.postMessage(e,[e])}catch{}finally{o()}})},Ds=(e,n,t,r,o,s,l,a,c,i,u)=>(d,h)=>{const p=l(d)?d:s(d);if(o.has(h)){const f=t();return Promise.reject(f)}try{o.add(h)}catch{}return n(c,()=>c(p))?p.decodeAudioData(h).then(f=>(Dn(h).catch(()=>{}),n(a,()=>a(f))||u(f),e.add(f),f)):new Promise((f,g)=>{const v=async()=>{try{await Dn(h)}catch{}},w=M=>{g(M),v()};try{p.decodeAudioData(h,M=>{typeof M.copyFromChannel!="function"&&(i(M),tn(M)),e.add(M),v().then(()=>f(M))},M=>{w(M===null?r():M)})}catch(M){w(M)}})},Ps=(e,n,t,r,o,s,l,a)=>(c,i)=>{const u=n.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(c.context),h=a(d);if(u===i){if(n.delete(c),!h&&l(c)){const p=r(c),{outputs:f}=t(c);for(const g of f)if(He(g)){const v=r(g[0]);e(p,v,g[1],g[2])}else{const v=o(g[0]);p.connect(v,g[1])}}}else n.set(c,u-i)},ks={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ls=(e,n,t,r,o,s,l)=>class extends e{constructor(c,i){const u=o(c),d={...ks,...i},h=r(u,d),p=s(u),f=p?t(d.maxDelayTime):null;super(c,!1,h,f),this._delayTime=n(this,p,h.delayTime),l(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},Ws=(e,n,t,r,o)=>s=>{const l=new WeakMap,a=async(c,i)=>{let u=t(c);const d=Q(u,i);if(!d){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=n(i,h)}return l.set(i,u),d?await e(i,c.delayTime,u.delayTime):await r(i,c.delayTime,u.delayTime),await o(c,i,u),u};return{render(c,i){const u=l.get(i);return u!==void 0?Promise.resolve(u):a(c,i)}}},Bs=e=>(n,t,r,o)=>e(n[o],s=>s[0]===t&&s[1]===r),Vs=e=>"delayTime"in e,qs=(e,n,t)=>function r(o,s){const l=dt(s)?s:t(e,s);if(Vs(l))return[];if(o[0]===l)return[o];if(o.includes(l))return[];const{outputs:a}=n(l);return Array.from(a).map(c=>r([...o,l],c[0])).reduce((c,i)=>c.concat(i),[])},Us={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},xs=(e,n,t,r,o,s,l,a)=>class extends e{constructor(i,u){const d=s(i),h={...Us,...u},p=r(d,h),f=l(d),g=f?t():null;super(i,!1,p,g),this._attack=n(this,f,p.attack),this._knee=n(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=n(this,f,p.ratio),this._release=n(this,f,p.release),this._threshold=n(this,f,p.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(i){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=i,i>2)throw this._nativeDynamicsCompressorNode.channelCount=u,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(i){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=i,i==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},js=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,c)=>{let i=t(a);const u=Q(i,c);if(!u){const d={attack:i.attack.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,knee:i.knee.value,ratio:i.ratio.value,release:i.release.value,threshold:i.threshold.value};i=n(c,d)}return s.set(c,i),u?(await e(c,a.attack,i.attack),await e(c,a.knee,i.knee),await e(c,a.ratio,i.ratio),await e(c,a.release,i.release),await e(c,a.threshold,i.threshold)):(await r(c,a.attack,i.attack),await r(c,a.knee,i.knee),await r(c,a.ratio,i.ratio),await r(c,a.release,i.release),await r(c,a.threshold,i.threshold)),await o(a,c,i),i};return{render(a,c){const i=s.get(c);return i!==void 0?Promise.resolve(i):l(a,c)}}},Zs=()=>new DOMException("","EncodingError"),zs=e=>n=>new Promise((t,r)=>{if(e===null){r(new SyntaxError);return}const o=e.document.head;if(o===null)r(new SyntaxError);else{const s=e.document.createElement("script"),l=new Blob([n],{type:"application/javascript"}),a=URL.createObjectURL(l),c=e.onerror,i=()=>{e.onerror=c,URL.revokeObjectURL(a)};e.onerror=(u,d,h,p,f)=>{if(d===a||d===e.location.href&&h===1&&p===1)return i(),r(f),!1;if(c!==null)return c(u,d,h,p,f)},s.onerror=()=>{i(),r(new SyntaxError)},s.onload=()=>{i(),t()},s.src=a,s.type="module",o.appendChild(s)}}),Xs=e=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,o){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=e(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(t,s,o)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,o){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,s===void 0?null:s,o)}},Gs=e=>(n,t,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(n*t)}},currentTime:{configurable:!0,get(){return n}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},$s=e=>async n=>{try{const t=await fetch(n);if(t.ok)return[await t.text(),t.url]}catch{}throw e()},Ys={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Hs=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=o(a),u={...Ys,...c},d=r(i,u),h=s(i),p=h?t():null;super(a,!1,d,p),this._gain=n(this,h,d.gain,J,ne)}get gain(){return this._gain}},Ks=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,c)=>{let i=t(a);const u=Q(i,c);if(!u){const d={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:i.gain.value};i=n(c,d)}return s.set(c,i),u?await e(c,a.gain,i.gain):await r(c,a.gain,i.gain),await o(a,c,i),i};return{render(a,c){const i=s.get(c);return i!==void 0?Promise.resolve(i):l(a,c)}}},Qs=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},Js=e=>n=>{var t;return(t=e.get(n))!==null&&t!==void 0?t:0},ea=e=>n=>{const t=e(n);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},te=()=>new DOMException("","InvalidStateError"),ta=e=>n=>{const t=e.get(n);if(t===void 0)throw te();return t},na=(e,n)=>t=>{let r=e.get(t);if(r!==void 0)return r;if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new n(1,1,44100),e.set(t,r),r},ra=e=>n=>{const t=e.get(n);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},vt=()=>new DOMException("","InvalidAccessError"),oa=e=>{e.getFrequencyResponse=(n=>(t,r,o)=>{if(t.length!==r.length||r.length!==o.length)throw vt();return n.call(e,t,r,o)})(e.getFrequencyResponse)},sa={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},aa=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=r(a),u=o(i),d={...sa,...c},h=n(i,u?null:a.baseLatency,d),p=u?t(d.feedback,d.feedforward):null;super(a,!1,h,p),oa(h),this._nativeIIRFilterNode=h,s(this,1)}getFrequencyResponse(a,c,i){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,i)}},pr=(e,n,t,r,o,s,l,a,c,i,u)=>{const d=i.length;let h=a;for(let p=0;p<d;p+=1){let f=t[0]*i[p];for(let g=1;g<o;g+=1){const v=h-g&c-1;f+=t[g]*s[v],f-=e[g]*l[v]}for(let g=o;g<r;g+=1)f+=t[g]*s[h-g&c-1];for(let g=o;g<n;g+=1)f-=e[g]*l[h-g&c-1];s[h]=i[p],l[h]=f,h=h+1&c-1,u[p]=f}return h},ca=(e,n,t,r)=>{const o=t instanceof Float64Array?t:new Float64Array(t),s=r instanceof Float64Array?r:new Float64Array(r),l=o.length,a=s.length,c=Math.min(l,a);if(o[0]!==1){for(let f=0;f<l;f+=1)s[f]/=o[0];for(let f=1;f<a;f+=1)o[f]/=o[0]}const i=32,u=new Float32Array(i),d=new Float32Array(i),h=n.createBuffer(e.numberOfChannels,e.length,e.sampleRate),p=e.numberOfChannels;for(let f=0;f<p;f+=1){const g=e.getChannelData(f),v=h.getChannelData(f);u.fill(0),d.fill(0),pr(o,l,s,a,c,u,d,0,i,g,v)}return h},ia=(e,n,t,r,o)=>(s,l)=>{const a=new WeakMap;let c=null;const i=async(u,d)=>{let h=null,p=n(u);const f=Q(p,d);if(d.createIIRFilter===void 0?h=e(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=d.createIIRFilter(l,s)),a.set(d,h===null?p:h),h!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const v=new t(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,v,v.destination);const w=await o(v);return ca(w,d,s,l)})()}const g=await c;return h.buffer=g,h.start(0),h}return await r(u,d,p),p};return{render(u,d){const h=a.get(d);return h!==void 0?Promise.resolve(h):i(u,d)}}},la=(e,n,t,r,o,s)=>l=>(a,c)=>{const i=e.get(a);if(i===void 0){if(!l&&s(a)){const u=r(a),{outputs:d}=t(a);for(const h of d)if(He(h)){const p=r(h[0]);n(u,p,h[1],h[2])}else{const p=o(h[0]);u.disconnect(p,h[1])}}e.set(a,c)}else e.set(a,i+c)},ua=e=>n=>e!==null&&n instanceof e,da=e=>n=>e!==null&&typeof e.AudioNode=="function"&&n instanceof e.AudioNode,ha=e=>n=>e!==null&&typeof e.AudioParam=="function"&&n instanceof e.AudioParam,fa=(e,n)=>t=>e(t)||n(t),pa=e=>n=>e!==null&&n instanceof e,ma=e=>e!==null&&e.isSecureContext,ga=(e,n,t,r,o,s)=>class extends t{constructor(a,c){super(a),this._nativeContext=a,sr.set(this,a),r(a)&&o.set(a,new Set),this._destination=new e(this,c),this._listener=n(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const i=this._nativeContext.onstatechange;this._onstatechange=i!==null&&i===c?a:i}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Xe=e=>{const n=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=e.decodeAudioData(n.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},ya=(e,n)=>(t,r,o)=>{const s=new Set;return t.connect=(l=>(a,c=0,i=0)=>{const u=s.size===0;if(n(a))return l.call(t,a,c,i),e(s,[a,c,i],d=>d[0]===a&&d[1]===c&&d[2]===i,!0),u&&r(),a;l.call(t,a,c),e(s,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(t.connect),t.disconnect=(l=>(a,c,i)=>{const u=s.size>0;if(a===void 0)l.apply(t),s.clear();else if(typeof a=="number"){l.call(t,a);for(const h of s)h[1]===a&&s.delete(h)}else{n(a)?l.call(t,a,c,i):l.call(t,a,c);for(const h of s)h[0]===a&&(c===void 0||h[1]===c)&&(i===void 0||h[2]===i)&&s.delete(h)}const d=s.size===0;u&&d&&o()})(t.disconnect),t},U=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t]&&(e[t]=r)},$=(e,n)=>{U(e,n,"channelCount"),U(e,n,"channelCountMode"),U(e,n,"channelInterpretation")},Pn=e=>typeof e.getFloatTimeDomainData=="function",va=e=>{e.getFloatTimeDomainData=n=>{const t=new Uint8Array(n.length);e.getByteTimeDomainData(t);const r=Math.max(t.length,e.fftSize);for(let o=0;o<r;o+=1)n[o]=(t[o]-128)*.0078125;return n}},Na=(e,n)=>(t,r)=>{const o=t.createAnalyser();if($(o,r),!(r.maxDecibels>r.minDecibels))throw n();return U(o,r,"fftSize"),U(o,r,"maxDecibels"),U(o,r,"minDecibels"),U(o,r,"smoothingTimeConstant"),e(Pn,()=>Pn(o))||va(o),o},wa=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,Z=(e,n,t)=>{const r=n[t];r!==void 0&&r!==e[t].value&&(e[t].value=r)},Ca=e=>{e.start=(n=>{let t=!1;return(r=0,o=0,s)=>{if(t)throw te();n.call(e,r,o,s),t=!0}})(e.start)},on=e=>{e.start=(n=>(t=0,r=0,o)=>{if(typeof o=="number"&&o<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");n.call(e,t,r,o)})(e.start)},sn=e=>{e.stop=(n=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");n.call(e,t)})(e.stop)},_a=(e,n,t,r,o,s,l,a,c,i,u)=>(d,h)=>{const p=d.createBufferSource();return $(p,h),Z(p,h,"playbackRate"),U(p,h,"buffer"),U(p,h,"loop"),U(p,h,"loopEnd"),U(p,h,"loopStart"),n(t,()=>t(d))||Ca(p),n(r,()=>r(d))||c(p),n(o,()=>o(d))||i(p,d),n(s,()=>s(d))||on(p),n(l,()=>l(d))||u(p,d),n(a,()=>a(d))||sn(p),e(d,p),p},ba=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,Ta=(e,n)=>(t,r,o)=>{const s=t.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}o&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const l=e(t,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return n(l,"channelCount",a=>()=>a.call(l),a=>c=>{a.call(l,c);try{s.channelCount=c}catch(i){if(c>s.maxChannelCount)throw i}}),n(l,"channelCountMode",a=>()=>a.call(l),a=>c=>{a.call(l,c),s.channelCountMode=c}),n(l,"channelInterpretation",a=>()=>a.call(l),a=>c=>{a.call(l,c),s.channelInterpretation=c}),Object.defineProperty(l,"maxChannelCount",{get:()=>s.maxChannelCount}),l.connect(s),l},Ia=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,Ea=(e,n)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*n))))),mr=(e,n)=>{const t=e.createBiquadFilter();return $(t,n),Z(t,n,"Q"),Z(t,n,"detune"),Z(t,n,"frequency"),Z(t,n,"gain"),U(t,n,"type"),t},Ma=(e,n)=>(t,r)=>{const o=t.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&n(t,o),$(o,r),o},Sa=e=>{const n=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>n,set:t=>{if(t!==n)throw te()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw te()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw te()}})},an=(e,n)=>{const t=e.createChannelSplitter(n.numberOfOutputs);return $(t,n),Sa(t),t},Ra=(e,n,t,r,o)=>(s,l)=>{if(s.createConstantSource===void 0)return t(s,l);const a=s.createConstantSource();return $(a,l),Z(a,l,"offset"),n(r,()=>r(s))||on(a),n(o,()=>o(s))||sn(a),e(s,a),a},qe=(e,n)=>(e.connect=n.connect.bind(n),e.disconnect=n.disconnect.bind(n),e),Aa=(e,n,t,r)=>(o,{offset:s,...l})=>{const a=o.createBuffer(1,2,44100),c=n(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t(o,{...l,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return i.channelCount},set channelCount(f){i.channelCount=f},get channelCountMode(){return i.channelCountMode},set channelCountMode(f){i.channelCountMode=f},get channelInterpretation(){return i.channelInterpretation},set channelInterpretation(f){i.channelInterpretation=f},get context(){return i.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return i.numberOfOutputs},get offset(){return i.gain},get onended(){return c.onended},set onended(f){c.onended=f},addEventListener(...f){return c.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return c.dispatchEvent(f[0])},removeEventListener(...f){return c.removeEventListener(f[0],f[1],f[2])},start(f=0){c.start.call(c,f)},stop(f=0){c.stop.call(c,f)}},h=()=>c.connect(i),p=()=>c.disconnect(i);return e(o,c),r(qe(d,i),h,p)},Oa=(e,n)=>(t,r)=>{const o=t.createConvolver();if($(o,r),r.disableNormalization===o.normalize&&(o.normalize=!r.disableNormalization),U(o,r,"buffer"),r.channelCount>2||(n(o,"channelCount",s=>()=>s.call(o),s=>l=>{if(l>2)throw e();return s.call(o,l)}),r.channelCountMode==="max"))throw e();return n(o,"channelCountMode",s=>()=>s.call(o),s=>l=>{if(l==="max")throw e();return s.call(o,l)}),o},gr=(e,n)=>{const t=e.createDelay(n.maxDelayTime);return $(t,n),Z(t,n,"delayTime"),t},Fa=e=>(n,t)=>{const r=n.createDynamicsCompressor();if($(r,t),t.channelCount>2||t.channelCountMode==="max")throw e();return Z(r,t,"attack"),Z(r,t,"knee"),Z(r,t,"ratio"),Z(r,t,"release"),Z(r,t,"threshold"),r},se=(e,n)=>{const t=e.createGain();return $(t,n),Z(t,n,"gain"),t},Da=e=>(n,t,r)=>{if(n.createIIRFilter===void 0)return e(n,t,r);const o=n.createIIRFilter(r.feedforward,r.feedback);return $(o,r),o};function Pa(e,n){const t=n[0]*n[0]+n[1]*n[1];return[(e[0]*n[0]+e[1]*n[1])/t,(e[1]*n[0]-e[0]*n[1])/t]}function ka(e,n){return[e[0]*n[0]-e[1]*n[1],e[0]*n[1]+e[1]*n[0]]}function kn(e,n){let t=[0,0];for(let r=e.length-1;r>=0;r-=1)t=ka(t,n),t[0]+=e[r];return t}const La=(e,n,t,r)=>(o,s,{channelCount:l,channelCountMode:a,channelInterpretation:c,feedback:i,feedforward:u})=>{const d=Ea(s,o.sampleRate),h=i instanceof Float64Array?i:new Float64Array(i),p=u instanceof Float64Array?u:new Float64Array(u),f=h.length,g=p.length,v=Math.min(f,g);if(f===0||f>20)throw r();if(h[0]===0)throw n();if(g===0||g>20)throw r();if(p[0]===0)throw n();if(h[0]!==1){for(let m=0;m<g;m+=1)p[m]/=h[0];for(let m=1;m<f;m+=1)h[m]/=h[0]}const w=t(o,d,l,l);w.channelCount=l,w.channelCountMode=a,w.channelInterpretation=c;const M=32,b=[],E=[],y=[];for(let m=0;m<l;m+=1){b.push(0);const I=new Float32Array(M),T=new Float32Array(M);I.fill(0),T.fill(0),E.push(I),y.push(T)}w.onaudioprocess=m=>{const I=m.inputBuffer,T=m.outputBuffer,S=I.numberOfChannels;for(let _=0;_<S;_+=1){const A=I.getChannelData(_),R=T.getChannelData(_);b[_]=pr(h,f,p,g,v,E[_],y[_],b[_],M,A,R)}};const N=o.sampleRate/2;return qe({get bufferSize(){return d},get channelCount(){return w.channelCount},set channelCount(m){w.channelCount=m},get channelCountMode(){return w.channelCountMode},set channelCountMode(m){w.channelCountMode=m},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(m){w.channelInterpretation=m},get context(){return w.context},get inputs(){return[w]},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},addEventListener(...m){return w.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return w.dispatchEvent(m[0])},getFrequencyResponse(m,I,T){if(m.length!==I.length||I.length!==T.length)throw e();const S=m.length;for(let _=0;_<S;_+=1){const A=-Math.PI*(m[_]/N),R=[Math.cos(A),Math.sin(A)],P=kn(p,R),F=kn(h,R),D=Pa(P,F);I[_]=Math.sqrt(D[0]*D[0]+D[1]*D[1]),T[_]=Math.atan2(D[1],D[0])}},removeEventListener(...m){return w.removeEventListener(m[0],m[1],m[2])}},w)},Wa=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,Ba=(e,n,t,r,o,s)=>(l,a)=>{const c=l.createOscillator();return $(c,a),Z(c,a,"detune"),Z(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):U(c,a,"type"),n(t,()=>t(l))||on(c),n(r,()=>r(l))||s(c,l),n(o,()=>o(l))||sn(c),e(l,c),c},Va=e=>(n,t)=>{const r=n.createPanner();return r.orientationX===void 0?e(n,t):($(r,t),Z(r,t,"orientationX"),Z(r,t,"orientationY"),Z(r,t,"orientationZ"),Z(r,t,"positionX"),Z(r,t,"positionY"),Z(r,t,"positionZ"),U(r,t,"coneInnerAngle"),U(r,t,"coneOuterAngle"),U(r,t,"coneOuterGain"),U(r,t,"distanceModel"),U(r,t,"maxDistance"),U(r,t,"panningModel"),U(r,t,"refDistance"),U(r,t,"rolloffFactor"),r)},qa=(e,n,t,r,o,s,l,a,c,i)=>(u,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:p,distanceModel:f,maxDistance:g,orientationX:v,orientationY:w,orientationZ:M,panningModel:b,positionX:E,positionY:y,positionZ:N,refDistance:C,rolloffFactor:m,...I})=>{const T=u.createPanner();if(I.channelCount>2||I.channelCountMode==="max")throw l();$(T,I);const S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},_=t(u,{...S,channelInterpretation:"speakers",numberOfInputs:6}),A=r(u,{...I,gain:1}),R=r(u,{...S,gain:1}),P=r(u,{...S,gain:0}),F=r(u,{...S,gain:0}),D=r(u,{...S,gain:0}),V=r(u,{...S,gain:0}),k=r(u,{...S,gain:0}),W=o(u,256,6,1),L=s(u,{...S,curve:new Float32Array([1,1]),oversample:"none"});let x=[v,w,M],Ae=[E,y,N];const Oe=new Float32Array(1);W.onaudioprocess=({inputBuffer:O})=>{const Et=[c(O,Oe,0),c(O,Oe,1),c(O,Oe,2)];Et.some((St,Rt)=>St!==x[Rt])&&(T.setOrientation(...Et),x=Et);const Mt=[c(O,Oe,3),c(O,Oe,4),c(O,Oe,5)];Mt.some((St,Rt)=>St!==Ae[Rt])&&(T.setPosition(...Mt),Ae=Mt)},Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0});const B={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(O){if(O>2)throw l();A.channelCount=O,T.channelCount=O},get channelCountMode(){return T.channelCountMode},set channelCountMode(O){if(O==="max")throw l();A.channelCountMode=O,T.channelCountMode=O},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(O){A.channelInterpretation=O,T.channelInterpretation=O},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(O){T.coneInnerAngle=O},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(O){T.coneOuterAngle=O},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(O){if(O<0||O>1)throw n();T.coneOuterGain=O},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(O){T.distanceModel=O},get inputs(){return[A]},get maxDistance(){return T.maxDistance},set maxDistance(O){if(O<0)throw new RangeError;T.maxDistance=O},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return R.gain},get orientationY(){return P.gain},get orientationZ(){return F.gain},get panningModel(){return T.panningModel},set panningModel(O){T.panningModel=O},get positionX(){return D.gain},get positionY(){return V.gain},get positionZ(){return k.gain},get refDistance(){return T.refDistance},set refDistance(O){if(O<0)throw new RangeError;T.refDistance=O},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(O){if(O<0)throw new RangeError;T.rolloffFactor=O},addEventListener(...O){return A.addEventListener(O[0],O[1],O[2])},dispatchEvent(...O){return A.dispatchEvent(O[0])},removeEventListener(...O){return A.removeEventListener(O[0],O[1],O[2])}};d!==B.coneInnerAngle&&(B.coneInnerAngle=d),h!==B.coneOuterAngle&&(B.coneOuterAngle=h),p!==B.coneOuterGain&&(B.coneOuterGain=p),f!==B.distanceModel&&(B.distanceModel=f),g!==B.maxDistance&&(B.maxDistance=g),v!==B.orientationX.value&&(B.orientationX.value=v),w!==B.orientationY.value&&(B.orientationY.value=w),M!==B.orientationZ.value&&(B.orientationZ.value=M),b!==B.panningModel&&(B.panningModel=b),E!==B.positionX.value&&(B.positionX.value=E),y!==B.positionY.value&&(B.positionY.value=y),N!==B.positionZ.value&&(B.positionZ.value=N),C!==B.refDistance&&(B.refDistance=C),m!==B.rolloffFactor&&(B.rolloffFactor=m),(x[0]!==1||x[1]!==0||x[2]!==0)&&T.setOrientation(...x),(Ae[0]!==0||Ae[1]!==0||Ae[2]!==0)&&T.setPosition(...Ae);const Gr=()=>{A.connect(T),e(A,L,0,0),L.connect(R).connect(_,0,0),L.connect(P).connect(_,0,1),L.connect(F).connect(_,0,2),L.connect(D).connect(_,0,3),L.connect(V).connect(_,0,4),L.connect(k).connect(_,0,5),_.connect(W).connect(u.destination)},$r=()=>{A.disconnect(T),a(A,L,0,0),L.disconnect(R),R.disconnect(_),L.disconnect(P),P.disconnect(_),L.disconnect(F),F.disconnect(_),L.disconnect(D),D.disconnect(_),L.disconnect(V),V.disconnect(_),L.disconnect(k),k.disconnect(_),_.disconnect(W),W.disconnect(u.destination)};return i(qe(B,T),Gr,$r)},Ua=e=>(n,{disableNormalization:t,imag:r,real:o})=>{const s=r instanceof Float32Array?r:new Float32Array(r),l=o instanceof Float32Array?o:new Float32Array(o),a=n.createPeriodicWave(l,s,{disableNormalization:t});if(Array.from(r).length<2)throw e();return a},Nt=(e,n,t,r)=>e.createScriptProcessor(n,t,r),xa=(e,n)=>(t,r)=>{const o=r.channelCountMode;if(o==="clamped-max")throw n();if(t.createStereoPanner===void 0)return e(t,r);const s=t.createStereoPanner();return $(s,r),Z(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>o,set:l=>{if(l!==o)throw n()}}),s},ja=(e,n,t,r,o,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,i={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...i,oversample:"none"},d=(f,g,v,w)=>{const M=new Float32Array(16385),b=new Float32Array(16385);for(let I=0;I<16385;I+=1){const T=I/16384*c;M[I]=Math.cos(T),b[I]=Math.sin(T)}const E=t(f,{...i,gain:0}),y=r(f,{...u,curve:M}),N=r(f,{...u,curve:a}),C=t(f,{...i,gain:0}),m=r(f,{...u,curve:b});return{connectGraph(){g.connect(E),g.connect(N.inputs===void 0?N:N.inputs[0]),g.connect(C),N.connect(v),v.connect(y.inputs===void 0?y:y.inputs[0]),v.connect(m.inputs===void 0?m:m.inputs[0]),y.connect(E.gain),m.connect(C.gain),E.connect(w,0,0),C.connect(w,0,1)},disconnectGraph(){g.disconnect(E),g.disconnect(N.inputs===void 0?N:N.inputs[0]),g.disconnect(C),N.disconnect(v),v.disconnect(y.inputs===void 0?y:y.inputs[0]),v.disconnect(m.inputs===void 0?m:m.inputs[0]),y.disconnect(E.gain),m.disconnect(C.gain),E.disconnect(w,0,0),C.disconnect(w,0,1)}}},h=(f,g,v,w)=>{const M=new Float32Array(16385),b=new Float32Array(16385),E=new Float32Array(16385),y=new Float32Array(16385),N=Math.floor(16385/2);for(let D=0;D<16385;D+=1)if(D>N){const V=(D-N)/(16384-N)*c;M[D]=Math.cos(V),b[D]=Math.sin(V),E[D]=0,y[D]=1}else{const V=D/(16384-N)*c;M[D]=1,b[D]=0,E[D]=Math.cos(V),y[D]=Math.sin(V)}const C=n(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),m=t(f,{...i,gain:0}),I=r(f,{...u,curve:M}),T=t(f,{...i,gain:0}),S=r(f,{...u,curve:b}),_=r(f,{...u,curve:a}),A=t(f,{...i,gain:0}),R=r(f,{...u,curve:E}),P=t(f,{...i,gain:0}),F=r(f,{...u,curve:y});return{connectGraph(){g.connect(C),g.connect(_.inputs===void 0?_:_.inputs[0]),C.connect(m,0),C.connect(T,0),C.connect(A,1),C.connect(P,1),_.connect(v),v.connect(I.inputs===void 0?I:I.inputs[0]),v.connect(S.inputs===void 0?S:S.inputs[0]),v.connect(R.inputs===void 0?R:R.inputs[0]),v.connect(F.inputs===void 0?F:F.inputs[0]),I.connect(m.gain),S.connect(T.gain),R.connect(A.gain),F.connect(P.gain),m.connect(w,0,0),A.connect(w,0,0),T.connect(w,0,1),P.connect(w,0,1)},disconnectGraph(){g.disconnect(C),g.disconnect(_.inputs===void 0?_:_.inputs[0]),C.disconnect(m,0),C.disconnect(T,0),C.disconnect(A,1),C.disconnect(P,1),_.disconnect(v),v.disconnect(I.inputs===void 0?I:I.inputs[0]),v.disconnect(S.inputs===void 0?S:S.inputs[0]),v.disconnect(R.inputs===void 0?R:R.inputs[0]),v.disconnect(F.inputs===void 0?F:F.inputs[0]),I.disconnect(m.gain),S.disconnect(T.gain),R.disconnect(A.gain),F.disconnect(P.gain),m.disconnect(w,0,0),A.disconnect(w,0,0),T.disconnect(w,0,1),P.disconnect(w,0,1)}}},p=(f,g,v,w,M)=>{if(g===1)return d(f,v,w,M);if(g===2)return h(f,v,w,M);throw o()};return(f,{channelCount:g,channelCountMode:v,pan:w,...M})=>{if(v==="max")throw o();const b=e(f,{...M,channelCount:1,channelCountMode:v,numberOfInputs:2}),E=t(f,{...M,channelCount:g,channelCountMode:v,gain:1}),y=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:w});let{connectGraph:N,disconnectGraph:C}=p(f,g,E,y,b);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(_){E.channelCount!==_&&(I&&C(),{connectGraph:N,disconnectGraph:C}=p(f,_,E,y,b),I&&N()),E.channelCount=_},get channelCountMode(){return E.channelCountMode},set channelCountMode(_){if(_==="clamped-max"||_==="max")throw o();E.channelCountMode=_},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(_){E.channelInterpretation=_},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return y.gain},addEventListener(..._){return E.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return E.dispatchEvent(_[0])},removeEventListener(..._){return E.removeEventListener(_[0],_[1],_[2])}};let I=!1;const T=()=>{N(),I=!0},S=()=>{C(),I=!1};return s(qe(m,b),T,S)}},Za=(e,n,t,r,o,s,l)=>(a,c)=>{const i=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);$(i,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw n();U(i,{curve:u},"curve"),U(i,c,"oversample");let d=null,h=!1;return l(i,"curve",g=>()=>g.call(i),g=>v=>(g.call(i,v),h&&(r(v)&&d===null?d=e(a,i):!r(v)&&d!==null&&(d(),d=null)),v)),o(i,()=>{h=!0,r(i.curve)&&(d=e(a,i))},()=>{h=!1,d!==null&&(d(),d=null)})},za=(e,n,t,r,o)=>(s,{curve:l,oversample:a,...c})=>{const i=s.createWaveShaper(),u=s.createWaveShaper();$(i,c),$(u,c);const d=t(s,{...c,gain:1}),h=t(s,{...c,gain:-1}),p=t(s,{...c,gain:1}),f=t(s,{...c,gain:-1});let g=null,v=!1,w=null;const M={get bufferSize(){},get channelCount(){return i.channelCount},set channelCount(y){d.channelCount=y,h.channelCount=y,i.channelCount=y,p.channelCount=y,u.channelCount=y,f.channelCount=y},get channelCountMode(){return i.channelCountMode},set channelCountMode(y){d.channelCountMode=y,h.channelCountMode=y,i.channelCountMode=y,p.channelCountMode=y,u.channelCountMode=y,f.channelCountMode=y},get channelInterpretation(){return i.channelInterpretation},set channelInterpretation(y){d.channelInterpretation=y,h.channelInterpretation=y,i.channelInterpretation=y,p.channelInterpretation=y,u.channelInterpretation=y,f.channelInterpretation=y},get context(){return i.context},get curve(){return w},set curve(y){if(y!==null&&y.length<2)throw n();if(y===null)i.curve=y,u.curve=y;else{const N=y.length,C=new Float32Array(N+2-N%2),m=new Float32Array(N+2-N%2);C[0]=y[0],m[0]=-y[N-1];const I=Math.ceil((N+1)/2),T=(N+1)/2-1;for(let S=1;S<I;S+=1){const _=S/I*T,A=Math.floor(_),R=Math.ceil(_);C[S]=A===R?y[A]:(1-(_-A))*y[A]+(1-(R-_))*y[R],m[S]=A===R?-y[N-1-A]:-((1-(_-A))*y[N-1-A])-(1-(R-_))*y[N-1-R]}C[I]=N%2===1?y[I-1]:(y[I-2]+y[I-1])/2,i.curve=C,u.curve=m}w=y,v&&(r(w)&&g===null?g=e(s,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return i.numberOfInputs},get numberOfOutputs(){return i.numberOfOutputs},get oversample(){return i.oversample},set oversample(y){i.oversample=y,u.oversample=y},addEventListener(...y){return d.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return d.dispatchEvent(y[0])},removeEventListener(...y){return d.removeEventListener(y[0],y[1],y[2])}};l!==null&&(M.curve=l instanceof Float32Array?l:new Float32Array(l)),a!==M.oversample&&(M.oversample=a);const b=()=>{d.connect(i).connect(p),d.connect(h).connect(u).connect(f).connect(p),v=!0,r(w)&&(g=e(s,d))},E=()=>{d.disconnect(i),i.disconnect(p),d.disconnect(h),h.disconnect(u),u.disconnect(f),f.disconnect(p),v=!1,g!==null&&(g(),g=null)};return o(qe(M,p),b,E)},oe=()=>new DOMException("","NotSupportedError"),Xa={numberOfChannels:1},Ga=(e,n,t,r,o)=>class extends e{constructor(l,a,c){let i;if(typeof l=="number"&&a!==void 0&&c!==void 0)i={length:a,numberOfChannels:l,sampleRate:c};else if(typeof l=="object")i=l;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:d,sampleRate:h}={...Xa,...i},p=r(d,u,h);n(Xe,()=>Xe(p))||p.addEventListener("statechange",(()=>{let f=0;const g=v=>{this._state==="running"&&(f>0?(p.removeEventListener("statechange",g),v.stopImmediatePropagation(),this._waitForThePromiseToSettle(v)):f+=1)};return g})()),super(p,d),this._length=u,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Ho(this)}))}_waitForThePromiseToSettle(l){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(l):setTimeout(()=>this._waitForThePromiseToSettle(l))}},$a={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Ya=(e,n,t,r,o,s,l)=>class extends e{constructor(c,i){const u=o(c),d={...$a,...i},h=t(u,d),p=s(u),f=p?r():null,g=c.sampleRate/2;super(c,!1,h,f),this._detune=n(this,p,h.detune,153600,-153600),this._frequency=n(this,p,h.frequency,g,-g),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const i=typeof c=="function"?l(this,c):null;this._nativeOscillatorNode.onended=i;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===i?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){We(this);const i=()=>{this._nativeOscillatorNode.removeEventListener("ended",i),fe(this)&&$e(this)};this._nativeOscillatorNode.addEventListener("ended",i)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},Ha=(e,n,t,r,o)=>()=>{const s=new WeakMap;let l=null,a=null,c=null;const i=async(u,d)=>{let h=t(u);const p=Q(h,d);if(!p){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:l===null?void 0:l,type:h.type};h=n(d,f),a!==null&&h.start(a),c!==null&&h.stop(c)}return s.set(d,h),p?(await e(d,u.detune,h.detune),await e(d,u.frequency,h.frequency)):(await r(d,u.detune,h.detune),await r(d,u.frequency,h.frequency)),await o(u,d,h),h};return{set periodicWave(u){l=u},set start(u){a=u},set stop(u){c=u},render(u,d){const h=s.get(d);return h!==void 0?Promise.resolve(h):i(u,d)}}},Ka={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Qa=(e,n,t,r,o,s,l)=>class extends e{constructor(c,i){const u=o(c),d={...Ka,...i},h=t(u,d),p=s(u),f=p?r():null;super(c,!1,h,f),this._nativePannerNode=h,this._orientationX=n(this,p,h.orientationX,J,ne),this._orientationY=n(this,p,h.orientationY,J,ne),this._orientationZ=n(this,p,h.orientationZ,J,ne),this._positionX=n(this,p,h.positionX,J,ne),this._positionY=n(this,p,h.positionY,J,ne),this._positionZ=n(this,p,h.positionZ,J,ne),l(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},Ja=(e,n,t,r,o,s,l,a,c,i)=>()=>{const u=new WeakMap;let d=null;const h=async(p,f)=>{let g=null,v=s(p);const w={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},M={...w,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},b=Q(v,f);if("bufferSize"in v)g=r(f,{...w,gain:1});else if(!b){const E={...M,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=o(f,E)}if(u.set(f,g===null?v:g),g!==null){if(d===null){if(l===null)throw new Error("Missing the native OfflineAudioContext constructor.");const S=new l(6,p.context.length,f.sampleRate),_=n(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});_.connect(S.destination),d=(async()=>{const A=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(R,P)=>{const F=t(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:P===0?1:0});return await a(S,R,F.offset),F}));for(let R=0;R<6;R+=1)A[R].connect(_,0,R),A[R].start(0);return i(S)})()}const E=await d,y=r(f,{...w,gain:1});await c(p,f,y);const N=[];for(let S=0;S<E.numberOfChannels;S+=1)N.push(E.getChannelData(S));let C=[N[0][0],N[1][0],N[2][0]],m=[N[3][0],N[4][0],N[5][0]],I=r(f,{...w,gain:1}),T=o(f,{...M,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:m[0],positionY:m[1],positionZ:m[2]});y.connect(I).connect(T.inputs[0]),T.connect(g);for(let S=128;S<E.length;S+=128){const _=[N[0][S],N[1][S],N[2][S]],A=[N[3][S],N[4][S],N[5][S]];if(_.some((R,P)=>R!==C[P])||A.some((R,P)=>R!==m[P])){C=_,m=A;const R=S/f.sampleRate;I.gain.setValueAtTime(0,R),I=r(f,{...w,gain:0}),T=o(f,{...M,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:m[0],positionY:m[1],positionZ:m[2]}),I.gain.setValueAtTime(1,R),y.connect(I).connect(T.inputs[0]),T.connect(g)}}return g}return b?(await e(f,p.orientationX,v.orientationX),await e(f,p.orientationY,v.orientationY),await e(f,p.orientationZ,v.orientationZ),await e(f,p.positionX,v.positionX),await e(f,p.positionY,v.positionY),await e(f,p.positionZ,v.positionZ)):(await a(f,p.orientationX,v.orientationX),await a(f,p.orientationY,v.orientationY),await a(f,p.orientationZ,v.orientationZ),await a(f,p.positionX,v.positionX),await a(f,p.positionY,v.positionY),await a(f,p.positionZ,v.positionZ)),Ve(v)?await c(p,f,v.inputs[0]):await c(p,f,v),v};return{render(p,f){const g=u.get(f);return g!==void 0?Promise.resolve(g):h(p,f)}}},ec={disableNormalization:!1},tc=(e,n,t,r)=>class yr{constructor(s,l){const a=n(s),c=r({...ec,...l}),i=e(a,c);return t.add(i),i}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===yr.prototype||t.has(s)}},nc=(e,n)=>(t,r,o)=>(e(r).replay(o),n(r,t,o)),rc=(e,n,t)=>async(r,o,s)=>{const l=e(r);await Promise.all(l.activeInputs.map((a,c)=>Array.from(a).map(async([i,u])=>{const h=await n(i).render(i,o),p=r.context.destination;!t(i)&&(r!==p||!t(r))&&h.connect(s,u,c)})).reduce((a,c)=>[...a,...c],[]))},oc=(e,n,t)=>async(r,o,s)=>{const l=n(r);await Promise.all(Array.from(l.activeInputs).map(async([a,c])=>{const u=await e(a).render(a,o);t(a)||u.connect(s,c)}))},sc=(e,n,t,r)=>o=>e(Xe,()=>Xe(o))?Promise.resolve(e(r,r)).then(s=>{if(!s){const l=t(o,512,0,1);o.oncomplete=()=>{l.onaudioprocess=null,l.disconnect()},l.onaudioprocess=()=>o.currentTime,l.connect(o.destination)}return o.startRendering()}):new Promise(s=>{const l=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=a=>{l.disconnect(),s(a.renderedBuffer)},l.connect(o.destination),o.startRendering()}),ac=e=>(n,t)=>e.set(n,t),cc=(e,n,t,r,o,s,l,a)=>(c,i)=>t(c).render(c,i).then(()=>Promise.all(Array.from(r(i)).map(u=>t(u).render(u,i)))).then(()=>o(i)).then(u=>(typeof u.copyFromChannel!="function"?(l(u),tn(u)):n(s,()=>s(u))||a(u),e.add(u),u)),ic={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},lc=(e,n,t,r,o,s)=>class extends e{constructor(a,c){const i=o(a),u={...ic,...c},d=t(i,u),h=s(i),p=h?r():null;super(a,!1,d,p),this._pan=n(this,h,d.pan)}get pan(){return this._pan}},uc=(e,n,t,r,o)=>()=>{const s=new WeakMap,l=async(a,c)=>{let i=t(a);const u=Q(i,c);if(!u){const d={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,pan:i.pan.value};i=n(c,d)}return s.set(c,i),u?await e(c,a.pan,i.pan):await r(c,a.pan,i.pan),Ve(i)?await o(a,c,i.inputs[0]):await o(a,c,i),i};return{render(a,c){const i=s.get(c);return i!==void 0?Promise.resolve(i):l(a,c)}}},dc=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0},hc=(e,n)=>async()=>{if(e===null)return!0;if(n===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new n(1,128,44100),o=URL.createObjectURL(t);let s=!1,l=!1;try{await r.audioWorklet.addModule(o);const a=new e(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>l=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(i=>setTimeout(i))}catch{}finally{URL.revokeObjectURL(o)}return s&&!l},fc=(e,n)=>()=>{if(n===null)return Promise.resolve(!1);const t=new n(1,1,44100),r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(o=>{t.oncomplete=()=>{r.disconnect(),o(t.currentTime!==0)},t.startRendering()})},pc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},mc=(e,n,t,r,o,s,l)=>class extends e{constructor(c,i){const u=o(c),d={...pc,...i},h=t(u,d),f=s(u)?r():null;super(c,!0,h,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,l(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw n();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},gc=(e,n,t)=>()=>{const r=new WeakMap,o=async(s,l)=>{let a=n(s);if(!Q(a,l)){const i={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=e(l,i)}return r.set(l,a),Ve(a)?await t(s,l,a.inputs[0]):await t(s,l,a),a};return{render(s,l){const a=r.get(l);return a!==void 0?Promise.resolve(a):o(s,l)}}},yc=()=>typeof window>"u"?null:window,vc=(e,n)=>t=>{t.copyFromChannel=(r,o,s=0)=>{const l=e(s),a=e(o);if(a>=t.numberOfChannels)throw n();const c=t.length,i=t.getChannelData(a),u=r.length;for(let d=l<0?-l:0;d+l<c&&d<u;d+=1)r[d]=i[d+l]},t.copyToChannel=(r,o,s=0)=>{const l=e(s),a=e(o);if(a>=t.numberOfChannels)throw n();const c=t.length,i=t.getChannelData(a),u=r.length;for(let d=l<0?-l:0;d+l<c&&d<u;d+=1)i[d+l]=r[d]}},Nc=e=>n=>{n.copyFromChannel=(t=>(r,o,s=0)=>{const l=e(s),a=e(o);if(l<n.length)return t.call(n,r,a,l)})(n.copyFromChannel),n.copyToChannel=(t=>(r,o,s=0)=>{const l=e(s),a=e(o);if(l<n.length)return t.call(n,r,a,l)})(n.copyToChannel)},wc=e=>(n,t)=>{const r=t.createBuffer(1,1,44100);n.buffer===null&&(n.buffer=r),e(n,"buffer",o=>()=>{const s=o.call(n);return s===r?null:s},o=>s=>o.call(n,s===null?r:s))},Cc=(e,n)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const o=t.createBufferSource();n(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)o.connect(r,0,c)},()=>o.disconnect(r))},vr=(e,n,t)=>e.copyFromChannel===void 0?e.getChannelData(t)[0]:(e.copyFromChannel(n,t),n[0]),Nr=e=>{if(e===null)return!1;const n=e.length;return n%2!==0?e[Math.floor(n/2)]!==0:e[n/2-1]+e[n/2]!==0},Ke=(e,n,t,r)=>{let o=e;for(;!o.hasOwnProperty(n);)o=Object.getPrototypeOf(o);const{get:s,set:l}=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(e,n,{get:t(s),set:r(l)})},_c=e=>({...e,channelCount:e.numberOfOutputs}),bc=e=>{const{imag:n,real:t}=e;return n===void 0?t===void 0?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(t,()=>0),real:t}:t===void 0?{...e,imag:n,real:Array.from(n,()=>0)}:{...e,imag:n,real:t}},wr=(e,n,t)=>{try{e.setValueAtTime(n,t)}catch(r){if(r.code!==9)throw r;wr(e,n,t+1e-7)}},Tc=e=>{const n=e.createBufferSource();n.start();try{n.start()}catch{return!0}return!1},Ic=e=>{const n=e.createBufferSource(),t=e.createBuffer(1,1,44100);n.buffer=t;try{n.start(0,1)}catch{return!1}return!0},Ec=e=>{const n=e.createBufferSource();n.start();try{n.stop()}catch{return!1}return!0},cn=e=>{const n=e.createOscillator();try{n.start(-1)}catch(t){return t instanceof RangeError}return!1},Cr=e=>{const n=e.createBuffer(1,1,44100),t=e.createBufferSource();t.buffer=n,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},ln=e=>{const n=e.createOscillator();try{n.stop(-1)}catch(t){return t instanceof RangeError}return!1},Mc=e=>{e.start=(n=>(t=0,r=0,o)=>{const s=e.buffer,l=s===null?r:Math.min(s.duration,r);s!==null&&l>s.duration-.5/e.context.sampleRate?n.call(e,t,0,0):n.call(e,t,l,o)})(e.start)},_r=(e,n)=>{const t=n.createGain();e.connect(t);const r=(o=>()=>{o.call(e,t),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),qe(e,t),e.stop=(o=>{let s=!1;return(l=0)=>{if(s)try{o.call(e,l)}catch{t.gain.setValueAtTime(0,l)}else o.call(e,l),s=!0}})(e.stop)},Qe=(e,n)=>t=>{const r={value:e};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof n=="function"?n.call(e,t):n.handleEvent.call(e,t)},Sc=So(Se),Rc=Po(Se),Ac=Bs(yt),br=new WeakMap,Oc=Js(br),ae=ms(new Map,new WeakMap),le=yc(),Tr=Na(ae,Me),un=Qs(re),H=rc(re,un,Ee),Fc=Bo(Tr,j,H),G=ta(sr),_e=Wa(le),z=pa(_e),Ir=new WeakMap,Er=Xs(Qe),wt=ba(le),Mr=ua(wt),Sr=da(le),Dc=ha(le),jt=Ia(le),K=is(Ro(tr),Do(Sc,Rc,ht,Ac,ft,re,Oc,Ge,j,Se,fe,Ee,ot),ae,la(qt,ft,re,j,ze,fe),Me,vt,oe,Ps(ht,qt,re,j,ze,G,fe,z),qs(Ir,re,Ce),Er,G,Mr,Sr,Dc,z,jt),Pc=Wo(K,Fc,Me,Tr,G,z),dn=new WeakSet,Ln=wa(le),Rr=Ms(new Uint32Array(1)),hn=vc(Rr,Me),fn=Nc(Rr),kc=qo(dn,ae,oe,Ln,_e,dc(Ln),hn,fn),Ct=ko(se),Ar=oc(un,Ye,Ee),me=_s(Ar),Je=_a(Ct,ae,Tc,Ic,Ec,cn,Cr,ln,Mc,wc(Ke),_r),ge=nc(ea(Ye),Ar),Lc=jo(me,Je,j,ge,H),ue=ls(Ao(rr),Ir,or,us,_o,bo,To,Io,Eo,Wt,Jn,wt,wr),Wc=xo(K,Lc,ue,te,Je,G,z,Qe),Bc=Ko(K,Qo,Me,te,Ta(se,Ke),G,z,H),Vc=ps(me,mr,j,ge,H),Re=ac(br),qc=fs(K,ue,Vc,vt,mr,G,z,Re),Ue=ya(Se,Sr),Uc=Cc(te,Ue),xe=Ma(wt,Uc),xc=vs(xe,j,H),jc=ys(K,xc,xe,G,z),Zc=Cs(an,j,H),zc=ws(K,Zc,an,G,z,_c),Xc=Aa(Ct,Je,se,Ue),_t=Ra(Ct,ae,Xc,cn,ln),Gc=Es(me,_t,j,ge,H),$c=Is(K,ue,Gc,_t,G,z,Qe),Or=Oa(oe,Ke),Yc=As(Or,j,H),Hc=Rs(K,Yc,Or,G,z,Re),Kc=Ws(me,gr,j,ge,H),Qc=Ls(K,ue,Kc,gr,G,z,Re),Fr=Fa(oe),Jc=js(me,Fr,j,ge,H),ei=xs(K,ue,Jc,Fr,oe,G,z,Re),ti=Ks(me,se,j,ge,H),ni=Hs(K,ue,ti,se,G,z),ri=La(vt,te,Nt,oe),pn=sc(ae,se,Nt,fc(se,_e)),oi=ia(Je,j,_e,H,pn),si=Da(ri),ai=aa(K,si,oi,G,z,Re),ci=Jo(ue,xe,_t,Nt,oe,vr,z,Ke),Dr=new WeakMap,ii=ga(Bc,ci,Er,z,Dr,Qe),Pr=Ba(Ct,ae,cn,Cr,ln,_r),li=Ha(me,Pr,j,ge,H),ui=Ya(K,ue,Pr,li,G,z,Qe),kr=bs(Je),di=za(kr,te,se,Nr,Ue),bt=Za(kr,te,di,Nr,Ue,wt,Ke),hi=qa(ht,te,xe,se,Nt,bt,oe,ft,vr,Ue),Lr=Va(hi),fi=Ja(me,xe,_t,se,Lr,j,_e,ge,H,pn),pi=Qa(K,ue,Lr,fi,G,z,Re),mi=Ua(Me),gi=tc(mi,G,new WeakSet,bc),yi=ja(xe,an,se,bt,oe,Ue),Wr=xa(yi,oe),vi=uc(me,Wr,j,ge,H),Ni=lc(K,ue,Wr,vi,G,z),wi=gc(bt,j,H),Ci=mc(K,te,bt,wi,G,z,Re),_i=ma(le),bi=Gs(le),Ti=new WeakMap,Ii=na(Ti,_e),Ei=_i?Fo(ae,oe,zs(le),bi,$s(Mo),G,Ii,z,jt,new WeakMap,new WeakMap,hc(jt,_e),le):void 0,Mi=fa(Mr,z),Si=Ds(dn,ae,Fs,Zs,new WeakSet,G,Mi,ut,Xe,hn,fn),Ri=ds(Ei,Pc,kc,Wc,qc,jc,zc,$c,Hc,Si,Qc,ei,ni,ai,ii,ui,pi,gi,Ni,Ci),Ai=ra(Dr),Oi=Os(oe,_e),Fi=cc(dn,ae,un,Ai,pn,ut,hn,fn),Di=Ga(Ri,ae,te,Oi,Fi),Wn=(e,n,t)=>{const r=new Di(e.numberOfChannels,Math.round(t*e.sampleRate),e.sampleRate),o=r.createBiquadFilter(),s=r.createBufferSource();return o.frequency.value=240,o.type="lowpass",s.buffer=e,s.connect(o).connect(r.destination),s.start(0,n,t),r.startRendering().then(l=>{const a=l.getChannelData(0),c=l.sampleRate;return{channelData:a,sampleRate:c}})},Pi=vo({analyze:({call:e})=>async(...n)=>{var t;const[r,o,s]=n,l=typeof o=="number"?o:0,a=typeof s=="number"?s:r.duration-l,{channelData:c,sampleRate:i}=await Wn(r,l,a),u=typeof o=="object"?o:typeof s=="object"?s:(t=n[3])!==null&&t!==void 0?t:null;return e("analyze",{channelData:c,sampleRate:i,...u===null?u:{tempoSettings:u}},[c.buffer])},guess:({call:e})=>async(...n)=>{var t;const[r,o,s]=n,l=typeof o=="number"?o:0,a=typeof s=="number"?s:r.duration-l,{channelData:c,sampleRate:i}=await Wn(r,l,a),u=typeof o=="object"?o:typeof s=="object"?s:(t=n[3])!==null&&t!==void 0?t:null;return e("guess",{channelData:c,sampleRate:i,...u===null?u:{tempoSettings:u}},[c.buffer])}}),ki=e=>{const n=new Worker(e);return Pi(n)},Li=(e,n)=>{let t=null;return()=>{if(t!==null)return t;const r=new Blob([n],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return t=e(o),setTimeout(()=>URL.revokeObjectURL(o)),t}},Wi=`(()=>{var e={455(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=a(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:c}})=>{const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const c=new Map,u=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(c);return c.set(o,()=>{n(),t.close(),c.delete(o)}),{result:o}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=u(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},h=(e,t,r)=>{const n=e.length,o=[];let s=!1;for(let a=0;a<n;a+=1)e[a]>t?s=!0:s&&(s=!1,o.push(a-1),a+=r/4-1);return s&&o.push(n-1),o},d=(e,t,r)=>{const n=(e=>{let t=0;const r=e.length;for(let n=0;n<r;n+=1)e[n]>t&&(t=e[n]);return t})(e),o=.3*n;let s=[],a=n-.05*n;if(n>.25)for(;s.length<30&&a>=o;)s=h(e,a,t),a-=.05*n;const i=(e=>{const t=[];return e.forEach((r,n)=>{const o=Math.min(e.length-n,10);for(let s=1;s<o;s+=1){const o=e[n+s]-r;t.some(e=>e.interval===o&&(e.peaks.push(r),!0))||t.push({interval:o,peaks:[r]})}}),t})(s),c=((e,t,r={})=>{var n,o;const s=Math.max(0,null!==(n=r.maxTempo)&&void 0!==n?n:180),a=Math.max(0,null!==(o=r.minTempo)&&void 0!==o?o:90),i=[];return e.forEach(e=>{let r=60/(e.interval/t);for(;r<a;)r*=2;for(;r>s;)r/=2;if(r<a)return;let n=!1,o=e.peaks.length;i.forEach(t=>{if(t.tempo===r&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],n=!0),t.tempo>r-.5&&t.tempo<r+.5){const n=2*Math.abs(t.tempo-r);o+=(1-n)*t.peaks.length,t.score+=(1-n)*e.peaks.length}}),n||i.push({peaks:e.peaks,score:o,tempo:r})}),i})(i,t,r);return c.sort((e,t)=>t.score-e.score),c},p=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo},f=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:o,tempo:s}=n[0],a=Math.round(s),i=60/a;o.sort((e,t)=>e-t);let c=o[0]/t;for(;c>i;)c-=i;return{bpm:a,offset:c,tempo:s}};l(self,{analyze:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:p(e,t,r)}),guess:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:f(e,t,r)})})})()})();`,Bi=Li(ki,Wi),Vi=(...e)=>Bi().guess(...e),Ot=new Set,Ft=new Set;let tt=null;function Tt(e){return new Promise((n,t)=>{const r=new(window.AudioContext||window.webkitAudioContext),o=new FileReader;o.onload=()=>{const s=o.result;if(!(s instanceof ArrayBuffer)){t(new Error("Failed to read file"));return}r.decodeAudioData(s).then(l=>{r.close(),n(l)}).catch(l=>{r.close(),t(l)})},o.onerror=()=>t(o.error),o.readAsArrayBuffer(e)})}function qi(e){e.bpm!=null||Ot.has(e.id)||(Ot.add(e.id),Tt(e.file).then(n=>Vi(n,{minTempo:60,maxTempo:200})).then(({bpm:n})=>{Number.isFinite(n)&&n>=1&&ke(e.id,{bpm:Math.round(n)})}).catch(()=>{}).finally(()=>Ot.delete(e.id)))}function Bn(e){return new Promise((n,t)=>{if(document.querySelector(`script[src="${e}"]`)){n();return}const r=document.createElement("script");r.src=e,r.onload=()=>n(),r.onerror=()=>t(new Error(`Failed to load ${e}`)),document.head.appendChild(r)})}async function mn(){if(tt)return tt;const e="https://cdn.jsdelivr.net/npm/essentia.js@0.1.3/dist";await Bn(`${e}/essentia-wasm.web.js`),await Bn(`${e}/essentia.js-core.js`);const n=await window.EssentiaWASM();return tt=new window.Essentia(n),tt}function Ui(e){e.key!=null&&e.key!==""||Ft.has(e.id)||(Ft.add(e.id),mn().then(n=>Tt(e.file).then(t=>({essentia:n,buf:t}))).then(({essentia:n,buf:t})=>{const r=n.audioBufferToMonoSignal(t),o=n.arrayToVector(r),s=n.KeyExtractor(o,!0,4096,4096,12,3500,60,25,.2,"bgate",t.sampleRate),l=[s.key,s.scale].filter(Boolean).join(" ")||null;l&&ke(e.id,{key:l})}).catch(()=>{ke(e.id,{key:""})}).finally(()=>Ft.delete(e.id)))}const nt=4096,Br=2048;function xi(e,n,t){const r=[];for(let o=0;o+nt<=n.length;o+=Br){const s=n.slice(o,o+nt),l=e.arrayToVector(s),a=e.Windowing(l,!1,nt,"hann",0,!0).frame,c=e.Spectrum(a,nt).spectrum,i=e.SpectralPeaks(c,0,4500,60,80,"frequency",t),u=e.HPCP(i.frequencies,i.magnitudes,!0,500,0,4500,!1,80,!1,"unitMax",440,t,12,"squaredCosine",1).hpcp;r.push(e.vectorToArray(u))}return r}function ji(e,n,t){const r=e.sampleRate,o=Math.max(0,Math.floor(n*r)),s=Math.min(e.length,Math.ceil(t*r));if(s-o<r*1)return Promise.resolve(null);const a=e.getChannelData(0).slice(o,s);if(e.numberOfChannels===2){const c=e.getChannelData(1);for(let i=0;i<a.length;i++)a[i]=(a[i]+c[o+i])/2}return mn().then(c=>{const i=c.arrayToVector(a),u=c.KeyExtractor(i,!0,4096,4096,12,3500,60,25,.2,"bgate",r);return[u.key,u.scale].filter(Boolean).join(" ")||null}).catch(()=>null)}function Zi(e,n,t){const r=e.sampleRate,o=Math.max(0,Math.floor(n*r)),s=Math.min(e.length,Math.ceil(t*r));if(s-o<r*1.5)return Promise.resolve(null);const a=e.getChannelData(0).slice(o,s);if(e.numberOfChannels===2){const c=e.getChannelData(1);for(let i=0;i<a.length;i++)a[i]=(a[i]+c[o+i])/2}return mn().then(c=>{const i=xi(c,a,r);if(i.length===0)return null;let u=i;if(c.module&&typeof c.module.VectorVectorFloat<"u")try{const f=new c.module.VectorVectorFloat;for(let g=0;g<i.length;g++)f.push_back(c.arrayToVector(i[g]));u=f}catch{}const h=c.ChordsDetection(u,Br,r,2).chords;if(!h)return null;let p=null;if(Array.isArray(h)&&h.length>0)p=h[h.length-1];else if(typeof h.size=="function"&&h.size()>0)try{const f=c.vectorToArray?c.vectorToArray(h):null;p=f&&f.length?f[f.length-1]:h.get?h.get(h.size()-1):null}catch{p=h.get?h.get(h.size()-1):null}return p!=null&&String(p).trim()!==""?String(p).trim():null}).catch(()=>null)}let Pe=null,Zt=()=>{},Vr=()=>{},qr=()=>{},Ur=()=>{};const rt=new Set;function zi(e){if(e.duration!=null||rt.has(e.id))return;rt.add(e.id);const n=URL.createObjectURL(e.file),t=new Audio;t.addEventListener("loadedmetadata",()=>{const r=t.duration;Number.isFinite(r)&&ke(e.id,{duration:r}),URL.revokeObjectURL(n),rt.delete(e.id)}),t.addEventListener("error",()=>{URL.revokeObjectURL(n),rt.delete(e.id)}),t.src=n}function Xi(e,n={}){Pe=e,n.onPlayRequest&&(Zt=n.onPlayRequest),n.onPauseRequest&&(Vr=n.onPauseRequest),n.onStopRequest&&(qr=n.onStopRequest),n.onSeekRequest&&(Ur=n.onSeekRequest),Yr(()=>{Vn()}),Hr(Gi),Vn()}function Gi(){if(!Pe)return;const e=Pe.querySelector(".audio-list tbody tr.playing");if(!e)return;const n=e.querySelector(".position-time"),t=e.querySelector(".progress-bar-fill");if(!n||!t)return;const r=we(),o=pe();if(o===null||o>=r.length)return;const l=r[o].duration;if(l==null||l<=0)return;const a=Math.min(zn(),l);n.textContent=`${he(a)} / ${he(l)}`,t.style.width=`${a/l*100}%`}function Vn(){if(!Pe)return;const e=we(),n=pe(),t=zn(),r=Xn();if(Pe.innerHTML="",e.length===0)return;const o=document.createElement("table");o.className="audio-list",o.innerHTML=`
    <thead>
      <tr>
        <th class="col-grip"></th>
        <th class="col-name">ファイル名</th>
        <th class="col-duration">素材の長さ</th>
        <th class="col-bpm">BPM</th>
        <th class="col-key">Key</th>
        <th class="col-loop">ループ</th>
        <th class="col-max">最大再生時間</th>
        <th class="col-controls">再生</th>
        <th class="col-position">再生位置</th>
        <th class="col-playing"></th>
      </tr>
    </thead>
    <tbody></tbody>
  `;const s=o.querySelector("tbody");e.forEach((l,a)=>{l.duration===null&&zi(l),l.bpm===null&&qi(l),l.key===null&&Ui(l);const c=document.createElement("tr");c.dataset.index=String(a),c.draggable=!0,n===a&&c.classList.add("playing");const i=document.createElement("td");i.className="col-grip",i.innerHTML='<span class="grip" aria-label="並び替え">⋮⋮</span>',i.addEventListener("mousedown",m=>m.stopPropagation());const u=document.createElement("td");u.className="col-name",u.textContent=l.name;const d=document.createElement("td");d.className="col-duration",d.textContent=l.duration!=null?he(l.duration):"…";const h=document.createElement("td");h.className="col-bpm",h.textContent=l.bpm!=null?String(l.bpm):"…";const p=document.createElement("td");p.className="col-key",p.textContent=l.key!=null&&l.key!==""?l.key:"—";const f=document.createElement("td");f.className="col-loop";const g=document.createElement("button");g.type="button",g.className="loop-btn",g.setAttribute("aria-label","ループ"),g.innerHTML=l.loop?'<span class="loop-icon loop-on" title="ループON">↻</span>':'<span class="loop-icon loop-off" title="ループOFF">↻</span>',g.addEventListener("click",m=>{m.stopPropagation(),ke(l.id,{loop:!l.loop})}),f.appendChild(g);const v=document.createElement("td");if(v.className="col-max",l.loop){const m=document.createElement("input");m.type="text",m.placeholder="0:00",m.value=l.maxLoopSeconds!=null?he(l.maxLoopSeconds):"",m.className="max-time-input",m.setAttribute("inputmode","numeric"),m.addEventListener("click",I=>I.stopPropagation()),m.addEventListener("change",()=>{const I=Yn(m.value.trim());ke(l.id,{maxLoopSeconds:I})}),v.appendChild(m)}const w=document.createElement("td");w.className="col-controls";const M=n===a,b=document.createElement("button");b.type="button",b.className="control-btn control-play"+(M&&r?" is-active":""),b.setAttribute("aria-label","再生"),b.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>',b.addEventListener("click",m=>{m.stopPropagation(),Zt(a)});const E=document.createElement("button");E.type="button",E.className="control-btn control-pause"+(M&&!r?" is-active":""),E.setAttribute("aria-label","ポーズ"),E.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/></svg>',E.addEventListener("click",m=>{m.stopPropagation(),Vr()});const y=document.createElement("button");y.type="button",y.className="control-btn control-stop",y.setAttribute("aria-label","停止"),y.innerHTML='<svg class="control-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M6 6h12v12H6z"/></svg>',y.addEventListener("click",m=>{m.stopPropagation(),qr()}),w.append(b,E,y);const N=document.createElement("td");if(N.className="col-position",n===a&&l.duration!=null&&l.duration>0){const m=l.duration,I=Math.min(t,m),T=I/m*100,S=document.createElement("span");S.className="position-time",S.textContent=`${he(I)} / ${he(m)}`;const _=document.createElement("div");_.className="progress-bar",_.setAttribute("role","slider"),_.setAttribute("aria-label","再生位置をクリックでシーク"),_.setAttribute("aria-valuenow",String(I)),_.setAttribute("aria-valuemin","0"),_.setAttribute("aria-valuemax",String(m));const A=document.createElement("div");A.className="progress-bar-fill",A.style.width=`${T}%`,_.appendChild(A),_.addEventListener("click",R=>{R.stopPropagation();const P=_.getBoundingClientRect(),F=R.clientX-P.left,V=Math.max(0,Math.min(1,F/P.width))*m;Ur(V)}),N.append(S,_)}else N.textContent="—";const C=document.createElement("td");C.className="col-playing",n===a&&(C.innerHTML='<span class="playing-mark">▶</span>'),c.append(i,u,d,h,p,f,v,w,N,C),c.addEventListener("click",m=>{(m.target.closest("button")||m.target.closest("input")||m.target.closest(".col-position"))===null&&Zt(a)}),c.addEventListener("dragstart",m=>{m.dataTransfer.setData("text/plain",String(a)),m.dataTransfer.effectAllowed="move",c.classList.add("dragging")}),c.addEventListener("dragend",()=>c.classList.remove("dragging")),c.addEventListener("dragover",m=>{m.preventDefault(),m.dataTransfer.dropEffect="move";const I=parseInt(m.dataTransfer.getData("text/plain"),10);Number.isNaN(I)||I===a||(s.querySelectorAll("tr").forEach(T=>T.classList.remove("drop-target")),c.classList.add("drop-target"))}),c.addEventListener("dragleave",()=>c.classList.remove("drop-target")),c.addEventListener("drop",m=>{m.preventDefault(),c.classList.remove("drop-target");const I=parseInt(m.dataTransfer.getData("text/plain"),10);Number.isNaN(I)||I===a||ro(I,a)}),s.appendChild(c)}),Pe.appendChild(o)}const Ne=new Audio;let je=null,xr=()=>{};function $i(e){xr=e}function zt(e){if(je===e){Ne.currentTime=0,Ne.play().catch(()=>{});return}Yi(),je=e,Ne.src=e,Ne.currentTime=0,Ne.play().catch(()=>{})}function jr(){Ne.pause()}function It(){return Ne}function Yi(){je&&(URL.revokeObjectURL(je),je=null)}Ne.addEventListener("ended",()=>{xr()});let be=null,pt=null,Te=null;const Hi=256;function Ki(e){if(!pt)try{const n=new(window.AudioContext||window.webkitAudioContext),t=n.createMediaElementSource(e),r=n.createAnalyser();r.fftSize=Hi,r.smoothingTimeConstant=.7,r.minDecibels=-60,r.maxDecibels=0,t.connect(r),r.connect(n.destination),be=n,pt=r,Te=new Float32Array(r.frequencyBinCount)}catch{}}const st=-60;function Dt(e,n,t){let r=st;for(let o=n;o<t;o++){const s=e[o];Number.isFinite(s)&&s>r&&(r=s)}return r}function Qi(){var r;if(!pt||!Te)return{low:st,mid:st,hi:st};(be==null?void 0:be.state)==="suspended"&&((r=be.resume)==null||r.call(be)),pt.getFloatFrequencyData(Te);const e=Te.length,n=Math.min(3,e),t=Math.min(Math.floor(e*.4),e);return{low:Dt(Te,0,n),mid:Dt(Te,n,t),hi:Dt(Te,t,e)}}const Ie=100,Ji=10,qn=new Array(Ie).fill(0),Un=new Array(Ie).fill(0),xn=new Array(Ie).fill(0);let Fe=0,ce=null;const el="#2e7d32",tl="#1565c0",nl="#c62828",mt=200,Xt=60,gt=34,Ze=-60,Gt=0,rl=[{db:0,label:"0 dB"},{db:-6,label:"-6 dB"},{db:-12,label:"-12 dB"},{db:-18,label:"-18 dB"},{db:-24,label:"-24 dB"},{db:-48,label:"-48 dB"},{db:-60,label:"-60 dB"}];function Zr(e){const n=Number(e);return!Number.isFinite(n)||n<=Ze?0:n>=Gt?1:(n-Ze)/(Gt-Ze)}function ol(e,n){e.save(),e.strokeStyle="rgba(255,255,255,0.25)",e.fillStyle="rgba(255,255,255,0.7)",e.font="10px system-ui, sans-serif",e.textAlign="right",e.textBaseline="middle";for(const{db:t,label:r}of rl){const s=(1-Zr(t))*n;e.fillText(r,gt-4,s),e.beginPath(),e.moveTo(gt,s),e.lineTo(mt,s),e.stroke()}e.restore()}function Pt(e,n,t,r,o,s){const l=r/(Ie-1);e.strokeStyle=t,e.lineWidth=1.5,e.lineJoin="round",e.lineCap="round",e.beginPath();for(let a=0;a<Ie;a++){const c=(Fe+1+a)%Ie,i=Zr(n[c]),u=s+a*l,d=(1-i)*o;a===0?e.moveTo(u,d):e.lineTo(u,d)}e.stroke()}function kt(e){const n=Number(e);return Number.isFinite(n)?Math.max(Ze,Math.min(Gt,n)):Ze}function sl(e){const n=e();if(qn[Fe]=kt(n.low),Un[Fe]=kt(n.mid),xn[Fe]=kt(n.hi),Fe=(Fe+1)%Ie,!ce)return;const t=ce.getContext("2d");if(!t)return;const r=mt,o=Xt,s=r-gt,l=gt;t.clearRect(0,0,r,o),ol(t,o),Pt(t,qn,el,s,o,l),Pt(t,Un,tl,s,o,l),Pt(t,xn,nl,s,o,l)}function al(e,n){if(!e)return;e.innerHTML="";const t=document.createElement("div");t.className="level-strip-wrap",t.setAttribute("aria-label","レベルメーター（Low / Mid / Hi 過去1秒・共通縦軸）");const r=document.createElement("div");r.className="level-strip-labels",r.innerHTML='<span class="level-legend low">Low</span><span class="level-legend mid">Mid</span><span class="level-legend hi">Hi</span>',ce=document.createElement("canvas"),ce.className="level-strip-canvas";const o=window.devicePixelRatio||1;ce.width=mt*o,ce.height=Xt*o,ce.style.width=`${mt}px`,ce.style.height=`${Xt}px`;const s=ce.getContext("2d");s&&s.scale(o,o),t.appendChild(r),t.appendChild(ce),e.appendChild(t);let l=0;function a(c){c-l>=Ji&&(l=c,sl(n)),requestAnimationFrame(a)}requestAnimationFrame(a)}let Y=null,ie=null,ee=null;function $t(e){const n=we();if(e<0||e>=n.length)return;const t=n[e];Y&&URL.revokeObjectURL(Y),Y=URL.createObjectURL(t.file),ie=null,ee!=null&&(clearInterval(ee),ee=null),Ki(It()),zt(Y),ct(e),at(!1),Tt(t.file).then(r=>{pe()===e&&(ie=r,Xr())}).catch(()=>{})}function cl(){const e=no();if(e.action==="loop"){at(!1),zt(Y);return}if(e.action==="next"){ct(e.index),at(!1);const t=we()[e.index];Y&&URL.revokeObjectURL(Y),Y=URL.createObjectURL(t.file),ie=null,ee!=null&&(clearInterval(ee),ee=null),zt(Y),Tt(t.file).then(r=>{pe()===e.index&&(ie=r,Xr())}).catch(()=>{});return}e.action==="stop"&&(ct(null),ie=null,ee!=null&&(clearInterval(ee),ee=null),Y&&(URL.revokeObjectURL(Y),Y=null))}function il(){jr(),at(!0)}function zr(){jr(),ct(null),ie=null,ee!=null&&(clearInterval(ee),ee=null),Y&&(URL.revokeObjectURL(Y),Y=null)}function Xr(){ee==null&&(ee=setInterval(()=>{const e=pe();if(e===null||!ie||Xn())return;const t=we()[e],r=(t==null?void 0:t.duration)??ie.duration,s=It().currentTime,l=Math.max(0,s-2),a=Math.min(r,s+1);Promise.all([ji(ie,l,a),Zi(ie,l,a)]).then(([c,i])=>{pe()===e&&eo(c,i)})},1500))}function ll(e){const n=It();if(pe()===null)return;const r=Math.max(0,e);n.currentTime=r,Gn(r)}function ul(){const e=we(),n=pe();if(e.length===0)return;if(n===null){$t(0);return}const t=n+1;if(t>=e.length){zr();return}$t(t)}function dl(){const e=we();if(!e.length)return;const n=so(e.map(s=>({name:s.name,loop:s.loop,maxLoopSeconds:s.maxLoopSeconds}))),t=new Blob([n],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download="audio-list.txt",o.click(),URL.revokeObjectURL(r)}function hl(){const e=document.getElementById("input-load-list");e&&(e.value="",e.onchange=()=>{var r;const n=(r=e.files)==null?void 0:r[0];if(!n)return;const t=new FileReader;t.onload=()=>{const o=typeof t.result=="string"?t.result:"",s=Hn(o);s.length&&$n(s)},t.readAsText(n,"UTF-8")},e.click())}function fl(){io(document.getElementById("dropzone"));const e=document.getElementById("btn-save-list"),n=document.getElementById("btn-load-list");e&&e.addEventListener("click",dl),n&&n.addEventListener("click",hl),Xi(document.getElementById("list-container"),{onPlayRequest(d){$t(d)},onPauseRequest:il,onStopRequest:zr,onSeekRequest:ll}),$i(cl);const t=document.getElementById("elapsed-display"),r=document.getElementById("elapsed-progress-fill"),o=document.querySelector(".elapsed-progress-bar"),s=document.getElementById("btn-next"),l=document.getElementById("level-meters"),a=It();s&&s.addEventListener("click",ul),l&&al(l,()=>Qi());const c=document.getElementById("realtime-key"),i=document.getElementById("realtime-chord");function u(){c&&(c.textContent=Qr()??"—"),i&&(i.textContent=Jr()??"—")}Kr(u),u(),setInterval(()=>{const d=we(),h=pe(),p=d.reduce((v,w)=>v+(w.duration??0),0);let f=0;if(h!==null&&h>=0){for(let v=0;v<h;v++)f+=d[v].duration??0;f+=a.currentTime}t&&(t.textContent=`再生経過: ${he(f)} / ${he(p)}`);const g=p>0?Math.min(100,f/p*100):0;if(r&&(r.style.width=`${g}%`),o&&o.setAttribute("aria-valuenow",String(Math.round(g))),h!==null){const v=a.currentTime;Gn(v)}},500)}fl();
